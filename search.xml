<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>2022.7.5è€ƒè¯•æ€»ç»“</title>
    <url>/2022/07/12/2022-7-5%E8%80%83%E8%AF%95%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h2 id="T1"><a href="#T1" class="headerlink" title="T1"></a>T1</h2><p>æƒ³åˆ°äº†åˆ†å—ï¼Œæš´åŠ›æ²¡æ“è¿‡å»ã€‚</p>
<p>è€ƒè™‘æš´åŠ›è®¡ç®—å‡ºå‰ $\sqrt P$ ä¸ªæ•°çš„å€¼ï¼ŒæœŸæœ›å¾—åˆ°çš„æœ€å¤§å€¼ä¸º $P-\sqrt P$ï¼Œå‰©ä¸‹æ¥çš„æ•°ä¸€å®šä¸å¤šï¼Œæˆ‘çš„æƒ³æ³•æ˜¯åˆ†å—æ¢æµ‹ä¸€ä¸‹ä¸‹ä¸€ä¸ªå—ä¸­æ˜¯å¦å­˜åœ¨æ¯”å½“å‰æœ€å¤§å€¼æ›´å¤§çš„æ•°ï¼Œæ¢æµ‹æ–¹å¼æ˜¯ç”¨ä¸ª $hash _table$ è®°å½•ä¸‹æ¯å—çš„æ¯ä¸ªæ•°çš„æ–¹å¹‚ï¼Œç„¶åæŠŠç­‰å¼å·¦è¾¹ä¹˜ä¸Šé€†å…ƒåå†æŸ¥æ‰¾ï¼Œä½†æ˜¯è¿™ä¸ªåšæ³•åªæœ‰ $60pts$ï¼Œè™½ç„¶æˆ‘æœ¬æœºèƒ½è·‘è¿‡ã€‚</p>
<p>å‘ç°æˆ‘ä»¬å¯¹åŒä¸€ä¸ªæ•°çš„æ¢æµ‹æ¬¡æ•°æœ‰ç‚¹å¤šï¼Œè€ƒè™‘èƒ½ä¸èƒ½å¯¹ä¸€ä¸ªæ•°åªæ¢æµ‹ä¸€æ¬¡ã€‚æœ¬è´¨ä¸Šæ˜¯éœ€è¦æ±‚ $P-1,P-2,\cdots P - \sqrt P$ è¿™äº›æ•°åœ¨æ•°åˆ—ä¸­å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚æˆ‘ä»¬çš„æ¢æµ‹å®é™…ä¸Šæ˜¯åˆ¤æ–­äº†ä¸€ä¸ªå¹‚å‡½æ•°çš„è§£æ˜¯å¦å­˜åœ¨äºä¸€ä¸ªåŒºé—´ã€‚æ‰€ä»¥ç›´æ¥è€ƒè™‘æ±‚è§£è¿™ä¸ªå¹‚å‡½æ•°æ–¹ç¨‹ $x^r &#x3D; a$ã€‚</p>
<p>è€ƒè™‘ $BSGS$ï¼Œä½†æ˜¯éœ€è¦è§£ $T\times \sqrt{P}$ æ¬¡ï¼Œæ¯æ¬¡çš„å¤æ‚åº¦ä¸º $O(\sqrt P)$ï¼Œä¸å¦‚æš´åŠ›ã€‚</p>
<p>è€ƒè™‘å¹³è¡¡å¤æ‚åº¦ï¼Œè®¾æš´åŠ›å¤„ç†çš„é•¿åº¦ä¸º $S$ï¼Œ$BSGS$ é¢„å¤„ç†é•¿åº¦ä¸º $B$ï¼Œé‚£ä¹ˆå¤æ‚åº¦ä¸º $T\times (S+\frac{P^2}{S\times B} + B) $</p>
<p>åé¢é‚£ä¸€å¨æœ€ä¼˜åº”è¯¥æ˜¯ $3e6$ ï¼Œå‹åŠ›å±±å¤§ã€‚</p>
<p>å‘ç°è´¨æ•°æ˜¯åŒä¸€ä¸ªè´¨æ•°ï¼Œæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•å¯ä»¥ä¼˜åŒ–ä¸€ä¸‹ã€‚</p>
<p>ç­”æ¡ˆæ˜¯ï¼Œå¤„ç†ç¦»æ•£å¯¹æ•°ã€‚</p>
<p>ç¦»æ•£å¯¹æ•°æœ‰ç€å’Œæ­£å¸¸å¯¹æ•°ä¸€æ ·ä¼˜ç¾çš„æ¢åº•å…¬å¼ï¼Œå¦‚æœæˆ‘ä»¬å¯¹ $x,P-1,P-2\cdots P-\sqrt P$ã€‚å‘ $P$  çš„åŸæ ¹ $g$ï¼Œå–å¯¹æ•°ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨æ¢åº•å…¬å¼å¾ˆæ–¹ä¾¿çš„æ±‚è§£ $x^r &#x3D; a$ï¼Œå–å¯¹æ•°çš„è¿‡ç¨‹å°±æ˜¯ $BSGS$ï¼Œæ³¨æ„åˆ°æ¢åº•å…¬å¼çš„é™¤æ³•å˜æˆäº†æ¨¡ $P-1$ æ„ä¹‰ä¸‹çš„é™¤æ³•ï¼Œå› ä¸º $g^{P-1} &#x3D; 1$ã€‚</p>
<p>æ‰€ä»¥ $BSGS$ çš„æ€»æ¬¡æ•°å˜ä¸ºäº† $O(\frac{P}{S})$ æ¬¡ï¼Œé¢„å¤„ç†åªéœ€è¦ä¸€æ¬¡ã€‚è¿™é‡Œå¯ä»¥æ”¾å¼€ç©ã€‚</p>
<p>æ€»å¤æ‚åº¦å˜ä¸ºäº† $O(T*(S+\frac{P}{S})+ B  + \frac{P}{S}\times\frac{P}{B})$</p>
<p>å– $B &#x3D; P^{\frac{3}{4}}$ï¼Œ$S&#x3D;\sqrt P$ å¯ä»¥å–åˆ°æœ€ä¼˜ã€‚</p>
<p>æˆ‘å®ç°çš„æ—¶å€™å†™çš„æ¯”è¾ƒä¸‘ï¼Œç®—äº†æ¯ä¸ªä¸œè¥¿çš„ä½ç½®ä¹‹åï¼Œè¿˜éœ€è¦æ’ä¸ªåºï¼Œå®é™…ä¸Šä»å¤§åˆ°å°å€’ç€åšå°±å¯ä»¥äº†ã€‚</p>
<p>çœ‹çœ‹ä½³è€å¸ˆçš„ä»£ç ï¼Œé•¿è¿›ä¸å°‘ã€‚</p>
<h3 id="T2"><a href="#T2" class="headerlink" title="T2"></a>T2</h3><p>å®šä¹‰å­—ç¬¦ä¸²çš„ border ä¸ºä¸€ä¸ªå®ƒçš„å‰ç¼€ï¼Œè¿™ä¸ªå‰ç¼€ä¹Ÿæ˜¯å®ƒçš„åç¼€ã€‚</p>
<p>åœºä¸Šæ˜¯åªä¼š $O(n^2)$ çš„ï¼Œè¿˜ TM æš´åŠ›æ‰“æŒ‚äº†åªæœ‰ 40ã€‚</p>
<p>åé¢äº†è§£åˆ°å¯ä»¥ç”¨ FFT å¤„ç†å¸¦é€šé…ç¬¦çš„å­—ç¬¦ä¸²åŒ¹é…é—®é¢˜ã€‚</p>
<p>å…·ä½“çš„ï¼Œå®šä¹‰è·ç¦»å‡½æ•° $d_i&#x3D;\sum\limits_{j&#x3D;1}^{m} s_{i+j-1}t_i(s_{i+j-1}-t_j)^2$</p>
<p>æ˜¾ç„¶ï¼Œå¦‚æœè·ç¦» $d_i$ ä¸º $0$ï¼Œé‚£ä¹ˆ $i$ å¼€å¤´çš„å­—ç¬¦ä¸²å°±èƒ½åŒ¹é…ä¸Šã€‚</p>
<p>ä¸‹æ ‡æœ‰ç‚¹é—®é¢˜ï¼Œæ‰€ä»¥æŠŠ $t$ åè½¬ä¸€ä¸‹ï¼ŒæŠŠå¼å­æ‹†äº†ï¼Œå°±æ˜¯ä¸‰é FFT æ±‚å‡ºæ¥æ¯ä¸€ä¸ª $d_i$ã€‚</p>
<p>æˆ‘ä»¬å°±çŸ¥é“äº†å“ªäº›ç»“æŸä½ç½®å¯èƒ½å¯ä»¥åŒ¹é…ä¸Šã€‚</p>
<p>ä¸æ˜¯æ‰€æœ‰èƒ½åŒ¹é…ä¸Šçš„ä½ç½®ä¸€å®šå¯ä»¥å¯¹ç­”æ¡ˆè´¡çŒ®ï¼Œå› ä¸ºå¦‚æœå‰é¢çš„åŒ¹é…ä¸Šäº†ï¼Œé€šé…ç¬¦å°±æ²¡äº†ï¼Œæ‰€ä»¥åé¢è¦åŒ¹é…ä¸Šï¼Œå°±è¦æ±‚é‡å çš„éƒ¨åˆ†å¿…é¡»æ˜¯ä¸€ä¸ª borderã€‚</p>
<p>å…¶å® border åœ¨å­—ç¬¦ä¸²éšæœºçš„æƒ…å†µä¸‹æ˜¯å¾ˆå°‘çš„ã€‚æˆ‘ä»¬å¯ä»¥è€ƒè™‘è®°å½•ä¸‹æ‰€æœ‰çš„ borderï¼Œç„¶å dpï¼Œè®¾ dp[i] è¡¨ç¤ºå¼ºåˆ¶ i ç»“å°¾åŒ¹é…ä¸Šäº†ï¼Œæœ€å¤šèƒ½åŒ¹é…çš„ä¸ªæ•°ï¼Œå¦‚æœ $j\leq i-m$ï¼Œå°±æ˜¯ä¸ªå‰ç¼€ maxï¼Œå¦‚æœ $j&gt; i-m$ï¼Œå°±åªæœ‰ border èƒ½è½¬ç§»ã€‚</p>
<p>border æœ‰ä¸ªæ€§è´¨ï¼Œå°±æ˜¯å®ƒä»¬çš„é•¿åº¦æ„æˆ $\log n$ ä¸ªç­‰å·®æ•°åˆ—ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å¯¹æ¯ä¸ªç­‰å·®æ•°åˆ—åšè½¬ç§»ã€‚</p>
<p>æ›´å…·ä½“çš„ï¼Œå¦‚æœ $next[n]&gt;\frac{n}{2}$ï¼Œé‚£ä¹ˆæ¨¡æ¿ä¸²ä¸€å®šæ˜¯ä¸€ä¸ªå¾ªç¯ï¼Œå¹¶ä¸”æœ€å°å¾ªç¯é•¿åº¦ä¸º $n-next[n]$ï¼Œå®ƒçš„é•¿åº¦å¤§äºç­‰äº $r&#x3D;n%(n-next[n])$ çš„ border ä¸€å®šæ„æˆä¸€ä¸ªå…¬å·®ä¸º $d&#x3D;n-next[n]$ çš„ç­‰å·®æ•°åˆ—ã€‚è¿™æ ·çš„è¯ï¼Œ$n$ æ¯æ¬¡è‡³å°‘å‡åŠï¼Œæ‰€ä»¥è‡³å¤šæœ‰ $\log n$ ä¸ªç­‰å·®æ•°åˆ—ã€‚</p>
<p>è€ƒè™‘è¯æ˜ã€‚å¦‚æœå­˜åœ¨ä¸€ä¸ªé•¿åº¦å¤§äº $r$ çš„ border  $x$ é•¿åº¦ä¸èƒ½å†™æˆ $kd+r$ï¼Œæ„Ÿæ€§ç†è§£ä¸‹ï¼ŒæŠŠåŸä¸²åˆ’åˆ†ä¸ºé•¿åº¦ä¸º $d$ çš„å°ä¸²ï¼ŒæŠŠ $x$ åœ¨æœ«å°¾çš„éƒ¨åˆ†å¹³ç§»åˆ°å¼€å¤´ï¼Œæ˜¾ç„¶å®ƒè¿˜æœ‰ä¸€ä¸ªæ›´å°çš„å¾ªç¯ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¯¹äºä¸€ä¸ªç‚¹ï¼Œå« border çš„è½¬ç§»å°±å¯ä»¥åˆ†ä¸º $\log n$ ç±»ï¼Œå¯¹æ¯ä¸€ç±»è®°ä¸€ä¸ªå‰ç¼€ $\max$ å³å¯è½¬ç§»ï¼Œæ³¨æ„æ¯ä¸€ç±»éœ€è¦æŒ‰ç…§æ¨¡å…¬å·®åˆ†ç±»ã€‚</p>
<p>æ³¨æ„è½¬ç§»ç»†èŠ‚ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y1 y3647</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1000000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(_type &amp;x)</span></span>&#123;</span><br><span class="line">	x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="number">45</span>&amp;&amp;(ch&gt;<span class="string">&#x27;9&#x27;</span>||ch&lt;<span class="string">&#x27;0&#x27;</span>))ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(ch==<span class="number">45</span>)&#123;f=<span class="number">-1</span>,ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmin</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&gt;b)a=b;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmax</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&lt;b)a=b;&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi=<span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">comple</span>&#123;</span><br><span class="line">	<span class="type">double</span> x,y;</span><br><span class="line">	comple <span class="keyword">operator</span> +(<span class="type">const</span> comple &amp;a)&#123;<span class="keyword">return</span> comple&#123;x+a.x,y+a.y&#125;;&#125;</span><br><span class="line">	comple <span class="keyword">operator</span> -(<span class="type">const</span> comple &amp;a)&#123;<span class="keyword">return</span> comple&#123;x-a.x,y-a.y&#125;;&#125;</span><br><span class="line">	comple <span class="keyword">operator</span> *(<span class="type">const</span> comple &amp;a)&#123;<span class="keyword">return</span> comple&#123;x*a.x-y*a.y,x*a.y+y*a.x&#125;;&#125;</span><br><span class="line">	<span class="type">void</span> <span class="keyword">operator</span> +=(<span class="type">const</span> comple &amp;a)&#123;x+=a.x,y+=a.y;&#125;</span><br><span class="line">	<span class="type">void</span> <span class="keyword">operator</span> -=(<span class="type">const</span> comple &amp;a)&#123;x-=a.x,y-=a.y;&#125;</span><br><span class="line">	<span class="type">void</span> <span class="keyword">operator</span> *=(<span class="type">const</span> comple &amp;a)&#123;<span class="type">double</span> tp=x;x=x*a.x-y*a.y,y=tp*a.y+y*a.x;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">int</span> i,j,k,n,s,t,m,lim,ans;</span><br><span class="line"><span class="type">int</span> res[N],vala[N],valb[N],sum[N],nxt[N];</span><br><span class="line"><span class="type">int</span> dp[N],border[N][<span class="number">2</span>],pre[<span class="number">32</span>][N][<span class="number">2</span>],from[N];</span><br><span class="line"><span class="type">char</span> ch[N],str[N];</span><br><span class="line"><span class="type">double</span> d[N];</span><br><span class="line">comple a[N],b[N],c[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FFT</span><span class="params">(comple val[],<span class="type">int</span> type=<span class="number">1</span>)</span></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;lim;i++)<span class="keyword">if</span>(res[i]&gt;i)<span class="built_in">swap</span>(val[res[i]],val[i]);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=lim;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">1</span>&lt;&lt;lim;j+=<span class="number">1</span>&lt;&lt;i)&#123;</span><br><span class="line">			comple w=&#123;<span class="number">1</span>,<span class="number">0</span>&#125;,wn=&#123;<span class="built_in">cos</span>(<span class="number">2</span>*Pi/(<span class="number">1</span>&lt;&lt;i)),type*<span class="built_in">sin</span>(<span class="number">2</span>*Pi/(<span class="number">1</span>&lt;&lt;i))&#125;;</span><br><span class="line">			<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>;k++,w*=wn)&#123;</span><br><span class="line">				comple y=val[k+j+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)]*w;</span><br><span class="line">				val[k+j+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)]=val[k+j]-y,val[k+j]+=y;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(type==<span class="number">-1</span>)<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;lim;i++)c[i].x/=(<span class="number">1</span>&lt;&lt;lim);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_border</span><span class="params">(<span class="type">int</span> x)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(x==<span class="number">0</span>)<span class="keyword">return</span> ;</span><br><span class="line">	border[++s][<span class="number">0</span>]=nxt[x],border[s][<span class="number">1</span>]=x-nxt[x];</span><br><span class="line">	<span class="keyword">if</span>(nxt[x]*<span class="number">2</span>&gt;x)<span class="built_in">get_border</span>(x%(x-nxt[x]));</span><br><span class="line">	<span class="keyword">else</span> <span class="built_in">get_border</span>(nxt[x]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">print</span><span class="params">(<span class="type">int</span> pos,<span class="type">int</span> lst)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(dp[pos]==<span class="number">0</span>)<span class="keyword">return</span> ;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>,j=pos-m+<span class="number">1</span>;i&lt;=m&amp;&amp;j&lt;lst;i++,j++)&#123;</span><br><span class="line">		<span class="keyword">if</span>(ch[j]!=<span class="string">&#x27;?&#x27;</span>&amp;&amp;ch[j]!=str[i])&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;Error&quot;</span>);</span><br><span class="line">			<span class="keyword">return</span> ;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(j&lt;<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">		ch[j]=str[i];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">print</span>(from[pos],pos-m+<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> 	<span class="built_in">freopen</span>(<span class="string">&quot;match.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;match.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	<span class="comment">//freopen(&quot;.in&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s%s&quot;</span>,ch+<span class="number">1</span>,str+<span class="number">1</span>);</span><br><span class="line">	n=<span class="built_in">strlen</span>(ch+<span class="number">1</span>),m=<span class="built_in">strlen</span>(str+<span class="number">1</span>);</span><br><span class="line">	nxt[<span class="number">0</span>]=j=<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">		<span class="keyword">while</span>(j!=<span class="number">-1</span>&amp;&amp;str[j+<span class="number">1</span>]!=str[i])j=nxt[j];</span><br><span class="line">		nxt[i]=++j;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">get_border</span>(m);border[s][<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>&lt;&lt;lim&lt;=n+m)lim++;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;<span class="number">1</span>&lt;&lt;lim;i++)res[i]=res[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>|(i&amp;<span class="number">1</span>)&lt;&lt;lim<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)vala[i]=ch[i]==<span class="string">&#x27;?&#x27;</span>?<span class="number">0</span>:ch[i]-<span class="string">&#x27;a&#x27;</span>+<span class="number">1</span>,sum[i]=sum[i<span class="number">-1</span>]+vala[i]*vala[i]*vala[i];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)valb[i]=str[i]-<span class="string">&#x27;a&#x27;</span>+<span class="number">1</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)a[i]=&#123;<span class="built_in">pow</span>(vala[i],<span class="number">2</span>)&#125;;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)b[i]=&#123;<span class="number">-2</span>*valb[m-i+<span class="number">1</span>]&#125;;</span><br><span class="line">	<span class="built_in">FFT</span>(a),<span class="built_in">FFT</span>(b);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;lim;i++)c[i]+=a[i]*b[i];</span><br><span class="line">	<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="built_in">sizeof</span>(a)),<span class="built_in">memset</span>(b,<span class="number">0</span>,<span class="built_in">sizeof</span>(b));</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)a[i]=&#123;vala[i]&#125;;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=m;i++)b[i]=&#123;<span class="built_in">pow</span>(valb[m-i+<span class="number">1</span>],<span class="number">2</span>)&#125;;</span><br><span class="line">	<span class="built_in">FFT</span>(a),<span class="built_in">FFT</span>(b);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;lim;i++)c[i]+=a[i]*b[i];</span><br><span class="line">	<span class="built_in">FFT</span>(c,<span class="number">-1</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=m;i&lt;=n;i++)</span><br><span class="line">	d[i]=sum[i]-sum[i-m]+c[i+<span class="number">1</span>].x;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(i=m;i&lt;=n;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=s;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(pre[j][i-m+border[j][<span class="number">0</span>]][<span class="number">0</span>]+<span class="number">1</span>&gt;dp[i])&#123;</span><br><span class="line">				dp[i]=pre[j][i-m+border[j][<span class="number">0</span>]][<span class="number">0</span>]+<span class="number">1</span>;</span><br><span class="line">				from[i]=pre[j][i-m+border[j][<span class="number">0</span>]][<span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(<span class="built_in">abs</span>(d[i])&gt;<span class="number">0.1</span>)dp[i]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=s;j++)&#123;</span><br><span class="line">			pre[j][i][<span class="number">0</span>]=dp[i],pre[j][i][<span class="number">1</span>]=i;</span><br><span class="line">			<span class="keyword">if</span>(pre[j][i-border[j][<span class="number">1</span>]][<span class="number">0</span>]&gt;pre[j][i][<span class="number">0</span>])&#123;</span><br><span class="line"></span><br><span class="line">				pre[j][i][<span class="number">0</span>]=pre[j][i-border[j][<span class="number">1</span>]][<span class="number">0</span>];</span><br><span class="line">				pre[j][i][<span class="number">1</span>]=pre[j][i-border[j][<span class="number">1</span>]][<span class="number">1</span>];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(dp[i]&gt;dp[ans])ans=i;</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;dp[ans]&lt;&lt;endl;</span><br><span class="line">	<span class="built_in">print</span>(ans,ans+<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="keyword">if</span>(ch[i]==<span class="string">&#x27;?&#x27;</span>)ch[i]=<span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">	cout&lt;&lt;ch+<span class="number">1</span>&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>è€ƒè¯•é¢˜è§£</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
        <tag>è€ƒè¯•æ€»ç»“</tag>
        <tag>å­—ç¬¦ä¸²</tag>
        <tag>å¤šé¡¹å¼</tag>
      </tags>
  </entry>
  <entry>
    <title>AIç›¸å…³å­¦ä¹ èµ„æ–™æ±‡æ€»</title>
    <url>/2022/07/12/AI%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0%E8%B5%84%E6%96%99%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<h2 id="ä¸€äº›-AI-ç›¸å…³çš„èµ„æ–™"><a href="#ä¸€äº›-AI-ç›¸å…³çš„èµ„æ–™" class="headerlink" title="ä¸€äº› AI ç›¸å…³çš„èµ„æ–™"></a>ä¸€äº› AI ç›¸å…³çš„èµ„æ–™</h2><h3 id="GPU-ç¼–ç¨‹"><a href="#GPU-ç¼–ç¨‹" class="headerlink" title="GPU ç¼–ç¨‹"></a>GPU ç¼–ç¨‹</h3><ul>
<li><a href="https://blog.csdn.net/shuzfan/article/details/76650947">GPU ç¼–ç¨‹</a> </li>
<li><a href="https://www.jianshu.com/p/8c461c1e5e01">CPU,GPU å†…å­˜ç¼“å­˜åŸç†ä»¥åŠç›¸å…³å†…å®¹åœ¨ CUDA ä¸Šçš„åº”ç”¨</a></li>
</ul>
]]></content>
      <tags>
        <tag>AI</tag>
        <tag>èµ„æ–™</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2022/07/12/hello-world/</url>
    <content><![CDATA[<p>åœ¨æ— æ•°ä¹…çš„ ğŸ¦å’•å’•å’• åä¸€ä¸ªåšå®¢å®ƒå»ºæˆäº†ï¼</p>
<p>åšå®¢ä¸»è¦ä¼šæ”¶å½•è¿™äº›ä¸œè¥¿ï¼š</p>
<ul>
<li><p>è‡ªå·±åœ¨ OI å†…å¤–è¸©çš„å‘ã€‚</p>
</li>
<li><p>å¯¹ä¸€äº›ç®—æ³•çš„æƒ³æ³•å’Œç†è§£ã€‚</p>
</li>
<li><p>ä¸€äº›ç®—æ³•ï¼ŒæŠ€æœ¯æŠ€å·§ã€‚</p>
</li>
<li><p>éƒ¨åˆ†å­¦ä¹ ä¸­çš„ç¬”è®°ã€‚</p>
</li>
<li><p>æ›¾ç»ä¸ä¼šæˆ–è€…é™Œç”Ÿçš„ç®—æ³•ï¼Œæ•°å­¦ï¼Œè‡ªç„¶ç§‘å­¦å†…å®¹ã€‚</p>
</li>
<li><p>å¯¹å­¦ä¹ å†…å®¹çš„æ„Ÿæ‚Ÿä¸ç†è§£ã€‚</p>
</li>
<li><p>é—²çš„æ²¡äº‹å†™çš„ç§‘æ™®æˆ–è€…æŠ€å·§ã€‚</p>
</li>
<li><p>ç”Ÿæ´»ä¸­çš„ä¸€äº›äº‹ã€‚</p>
</li>
<li><p>å…¶å®ƒ</p>
</li>
</ul>
<p>å…³äºæˆ‘è‡ªå·±ï¼š</p>
<p>å¸¸ç”¨ IDï¼ˆä¸€èˆ¬ä¸å¼ºè°ƒå¤§å°å†™ï¼‰ï¼šå¹»å½±å½­ï¼Œç´é£å¹»å½±ï¼Œhuan_ypï¼ŒPhantom_Pengã€‚</p>
<p>QQï¼š3051561876</p>
<p>ä¸€ä¸ªçƒ­çˆ±è‡ªç„¶ç§‘å­¦çš„ï¼Œæœ‰äº›ä¸­äºŒçš„ç”·ç”Ÿã€‚</p>
]]></content>
      <categories>
        <category>System Test</category>
        <category>Basic Function Test</category>
      </categories>
      <tags>
        <tag>System Test</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo-NexT å®‰è£…è¸©å‘è®°å½•</title>
    <url>/2022/07/12/Hexo-NexT-%E5%AE%89%E8%A3%85%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h2 id="Hexo-NexT-å®‰è£…è¸©å‘è®°å½•"><a href="#Hexo-NexT-å®‰è£…è¸©å‘è®°å½•" class="headerlink" title="Hexo-NexT å®‰è£…è¸©å‘è®°å½•"></a>Hexo-NexT å®‰è£…è¸©å‘è®°å½•</h2><h3 id="èƒŒæ™¯å›¾ç‰‡è®¾ç½®"><a href="#èƒŒæ™¯å›¾ç‰‡è®¾ç½®" class="headerlink" title="èƒŒæ™¯å›¾ç‰‡è®¾ç½®"></a>èƒŒæ™¯å›¾ç‰‡è®¾ç½®</h3><p>åœ¨ <code>.\themes\next\_config.yml</code> è®¾ç½®å¥½ <code>custom_file_path</code> çš„ <code>style</code> å±æ€§åï¼Œé‚£ä¸ªè·¯å¾„é‡Œé¢çš„ <code>/source/_data/styles.styl</code> è¦å»ºåœ¨æ ¹ç›®å½•çš„ <code>source</code> ä¸‹è€Œä¸æ˜¯ <code>.\themes\next</code> ç›®å½•ä¸‹çš„</p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
        <category>è¸©å‘è®°å½•</category>
      </categories>
      <tags>
        <tag>è¸©å‘è®°å½•</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›æœ‰ç‚¹å®¹æ˜“å¿˜çš„åŸºç¡€ç®—æ³•</title>
    <url>/2022/07/12/%E4%B8%80%E4%BA%9B%E6%9C%89%E7%82%B9%E5%AE%B9%E6%98%93%E5%BF%98%E7%9A%84%E5%9F%BA%E7%A1%80%E7%AE%97%E6%B3%95/</url>
    <content><![CDATA[<h2 id="æ ‘é“¾å‰–åˆ†"><a href="#æ ‘é“¾å‰–åˆ†" class="headerlink" title="æ ‘é“¾å‰–åˆ†"></a>æ ‘é“¾å‰–åˆ†</h2><p>å¸¸ç”¨çš„æ ‘é“¾å‰–åˆ†æœ‰é‡é“¾å‰–åˆ†ï¼Œå®é“¾å‰–åˆ†å’Œé•¿é“¾å‰–åˆ†ã€‚</p>
<p>é•¿é“¾å‰–åˆ†ä¸»è¦ç”¨äºéƒ¨åˆ†å’Œæ·±åº¦æœ‰å…³çš„æ ‘å½¢ $dp$ çš„ä¼˜åŒ–ï¼Œä¸€èˆ¬é‡‡ç”¨æŒ‡é’ˆæ•°ç»„å®ç°ã€‚</p>
<p>æˆ‘ä»¬è¯´çš„æ ‘é“¾å‰–åˆ†ä¸€èˆ¬æŒ‡é‡é“¾å‰–åˆ†ï¼Œå³é€‰æ‹©æ¯ä¸ªç‚¹å­æ ‘æœ€å¤§çš„å„¿å­ã€‚</p>
<p>ä¸éš¾è¯æ˜ä»ä»»ä½•ä¸€ä¸ªç‚¹åˆ°æ ¹éƒ½åªä¼šç»è¿‡ $log_n$ æ¡é‡é“¾ï¼Œè¿™ä¹Ÿæ˜¯å…¶å¤æ‚åº¦çš„ä¿è¯ã€‚</p>
<p>å¯ä»¥å°†æ¯æ¡é‡é“¾ç”¨ä¸€ä¸ªæ•°æ®ç»“æ„ç»´æŠ¤èµ·æ¥ï¼Œå°±èƒ½åšæ ‘ä¸Šæ“ä½œäº†ã€‚</p>
<h2 id="åŠ¨æ€æ ‘"><a href="#åŠ¨æ€æ ‘" class="headerlink" title="åŠ¨æ€æ ‘"></a>åŠ¨æ€æ ‘</h2><p>åŠ¨æ€æ ‘æ˜¯åŸºäºå®é“¾å‰–åˆ†çš„æ•°æ®ç»“æ„ï¼Œéå¸¸å¼ºå¤§ï¼Œä½†ç¼–ç å¤æ‚åº¦ç›¸å¯¹è¾ƒé«˜ã€‚</p>
<p>æˆ‘ä½¿ç”¨çš„æ˜¯åŸºäº $splay$ çš„åŠ¨æ€æ ‘ã€‚</p>
<p>åŠ¨æ€æ ‘ç»´æŠ¤çš„æ˜¯è‹¥å¹²å®é“¾ï¼Œæ¯ä¸ªå®é“¾ç”¨ä¸€é¢—å¹³è¡¡æ ‘ç»´æŠ¤ã€‚</p>
<p>åŠ¨æ€æ ‘çš„æ ¸å¿ƒæ“ä½œæ˜¯ <code>access</code>ï¼Œæ„å‘³å°†ç›®æ ‡ç‚¹ $x$ åˆ°æ ¹çš„è·¯å¾„å…¨éƒ¨æ‰“é€šï¼Œå¹¶ä¸”åªåŒ…å«è¿™æ¡è·¯å¾„ã€‚</p>
<p>å…¶å®ƒæ“ä½œç®€è¦ä»‹ç»ä¸€ä¸‹å®ç°ï¼š</p>
<p><code>make_root</code> :å…ˆ <code>access</code>ï¼Œç„¶åæŠŠ $x$  <code>splay</code> åˆ°æ ¹ï¼Œç„¶åç¿»è½¬æ•´é¢— $splay$ ï¼Œå› ä¸º $splay$ å¤–çš„å½¢æ€æ²¡æœ‰æ”¹å˜ï¼Œæ‰€ä»¥åªè¦ $splay$ å†…éƒ¨çš„å½¢æ€æ­£ç¡®ï¼Œé‚£ä¹ˆæ•´æ£µæ ‘çš„å½¢æ€å°±æ­£ç¡®ï¼Œå¦‚æœå¯¹äºä¸€ä¸ª $splay$ æ‰€æœ‰çš„èŠ‚ç‚¹äº¤æ¢äº†å·¦å³å„¿å­ï¼Œé‚£ä¹ˆå°±æ˜¯å€’åºäº†è¿™é¢— $splay$ ï¼Œ$x$ åˆæ˜¯æ·±åº¦æœ€å¤§çš„ç‚¹ï¼Œæ‰€ä»¥è¿™æ ·æ˜¯æ­£ç¡®çš„ã€‚</p>
<p><code>link</code> :å¾ˆç®€å•ï¼Œç›´æ¥å°†ç›®æ ‡ç‚¹ $x$ <code>splay</code> åˆ°å½“å‰æ ¹ï¼Œå½“ç„¶ï¼Œæ³¨æ„åˆ°åŸæ ‘ä¹‹é—´çš„å…³ç³»æ˜¯ $splay$ æ ¹èŠ‚ç‚¹çš„å…³ç³»ï¼Œ$splay$ æ ¹èŠ‚ç‚¹çš„çˆ¶äº²å…¶å®æ˜¯ $splay$ ä¸­æ·±åº¦æœ€å°çš„ç‚¹çš„çˆ¶äº²ï¼Œç„¶åæ”¹çˆ¶äº²æ”¹æˆ $y$ å°±è¡Œã€‚</p>
<p><code>cut</code> :å‡è®¾æœ‰ä¸€ä¸ªè™šæ ¹ $0$ï¼ŒæŠŠ $x$ <code>make_root</code> ï¼ŒæŠŠ $y$ <code>access</code> ç„¶å <code>splay</code> $y$,ç›´æ¥åŒå‘æ–­å¼€ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_up</span><span class="params">(<span class="type">int</span> rt)</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">//è¯¥æ›´æ–°çš„è¦æ›´æ–°</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">push_down</span><span class="params">(<span class="type">int</span> rt)</span></span>&#123;&#125;</span><br><span class="line"><span class="comment">//æ—‹è½¬æ ‡è®°å’Œå…¶å®ƒæ ‡è®°çš„ push_down</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isroot</span><span class="params">(<span class="type">int</span> rt)</span></span>&#123;<span class="keyword">return</span> T[T[rt].fa].son[<span class="number">0</span>]!=rt&amp;&amp;T[T[rt].fa].son[<span class="number">1</span>]!=rt;&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rotate</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> y=T[x].fa,z=T[y].fa,o=T[y].son[<span class="number">1</span>]==x,b=T[x].son[o^<span class="number">1</span>];</span><br><span class="line">	<span class="keyword">if</span>(!<span class="built_in">isroot</span>(y))T[z].son[T[z].son[<span class="number">1</span>]==y]=x;</span><br><span class="line">	T[y].fa=x;T[x].son[o^<span class="number">1</span>]=y;T[x].fa=z,T[y].son[o]=b,T[b].fa=y;</span><br><span class="line">	<span class="built_in">push_up</span>(y),<span class="built_in">push_up</span>(x);</span><br><span class="line">    <span class="comment">//å·²ç»å¾ˆç†Ÿçš„ rotate æ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">splay</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> u=x;st[++top]=u;</span><br><span class="line">	<span class="keyword">while</span>(!<span class="built_in">isroot</span>(u))u=T[u].fa,st[++top]=u;</span><br><span class="line">	<span class="keyword">while</span>(top)<span class="built_in">push_down</span>(st[top--]);</span><br><span class="line">    <span class="comment">//è®°å¾—å…ˆ push_down</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> y=T[x].fa;!<span class="built_in">isroot</span>(x);y=T[x].fa)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(!<span class="built_in">isroot</span>(y))<span class="built_in">rotate</span>((T[T[y].fa].son[<span class="number">1</span>]==y)==(T[y].son[<span class="number">1</span>]==x)?y:x);</span><br><span class="line">        <span class="comment">//åŒæ—‹ï¼Œå…¶å®ä¸€èˆ¬å•æ—‹ä¹Ÿä¸ä¼šå¡ã€‚</span></span><br><span class="line">		<span class="built_in">rotate</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="comment">//äº²åˆ‡çš„ splay æ“ä½œ</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">access</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y=<span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="comment">//è®°å¾—æ–­å¼€å’Œå„¿å­çš„è¿æ¥</span></span><br><span class="line">    <span class="comment">//splay ä¹‹é—´æ˜¯åŸæ ‘çš„å…³ç³»è¿æ¥ï¼Œä½† splay å†…éƒ¨ç»´æŠ¤çš„åªæ˜¯ä¸€æ¡é“¾ï¼Œä¸­åºéå† splay æ‰èƒ½å¾—åˆ°åŸæ ‘</span></span><br><span class="line">	<span class="keyword">for</span>(;x;y=x,x=T[x].fa)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">splay</span>(x);T[x].son[<span class="number">1</span>]=y;</span><br><span class="line">		<span class="built_in">push_up</span>(x);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="è™šæ ‘ï¼š"><a href="#è™šæ ‘ï¼š" class="headerlink" title="è™šæ ‘ï¼š"></a>è™šæ ‘ï¼š</h2><p>ä¸€èˆ¬ç”¨æ¥å¤„ç†è¯¢é—®å¾ˆå¤šä½†è§„æ¨¡ä¸å¤§çš„æ ‘ä¸Šé—®é¢˜ã€‚</p>
<h2 id="ç‚¹åˆ†æ²»"><a href="#ç‚¹åˆ†æ²»" class="headerlink" title="ç‚¹åˆ†æ²»"></a>ç‚¹åˆ†æ²»</h2><p>ç”¨æ¥å¤„ç†æ ‘ä¸Šè·¯å¾„çš„è®¡æ•°é—®é¢˜</p>
<h2 id="åç¼€æ’åº"><a href="#åç¼€æ’åº" class="headerlink" title="åç¼€æ’åº"></a>åç¼€æ’åº</h2><p>å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰åç¼€æ’åºï¼Œçº¦å®š $sa[i]$ è¡¨ç¤ºæ’åä¸º $i$ çš„åç¼€çš„èµ·å§‹ä½ç½®ï¼Œçº¦å®š $rk[i]$ è¡¨ç¤ºèµ·å§‹ä½ç½®ä¸º $i$ çš„åç¼€çš„æ’åã€‚$height[i]$ ä¸ºæ’åä¸º $i,i-1$ çš„åç¼€çš„ $lcp$ ã€‚</p>
<p>å…ˆæŒ‰ç¬¬ä¸€ä¸ªå­—æ¯åŸºæ•°æ’åºä¸€éï¼Œç„¶åå€å¢æ³•ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)sum[rk[i]=ch[i]]++;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=<span class="number">128</span>;i++)sum[i]+=sum[i<span class="number">-1</span>];</span><br><span class="line"><span class="comment">//ç»Ÿè®¡ sum,sum[i] è¡¨ç¤ºå…³é”®å­—æ¯” i å°çš„æ€»ä¸ªæ•°ï¼Œç„¶åéå†çš„æ—¶å€™ï¼Œç”¨æ¯ä¸ªåç¼€å½“å‰æ’åè®¿é—® sumï¼Œ</span></span><br><span class="line"><span class="comment">//å¾—åˆ° sum[rk[i]] ä¸ºä»¥ i ä¸ºèµ·å§‹ä½ç½®çš„åç¼€çš„æ’åã€‚</span></span><br><span class="line"><span class="comment">//è®¿é—®å sum éœ€è¦è‡ªå‡ã€‚</span></span><br><span class="line"><span class="comment">//ä½†å¹¶ä¸è®°å½•è¿™ä¸ªæ’åï¼Œå› ä¸ºå®ƒä¸å‡†ç¡®ï¼Œç›¸åŒçš„ä¼šè®¤ä¸ºæ˜¯ä¸åŒï¼Œè®°å½•æ’åä¸º sum[rk[i]] çš„åç¼€çš„èµ·å§‹ä½ç½®ã€‚</span></span><br><span class="line"><span class="keyword">for</span>(i=n;i&gt;=<span class="number">1</span>;i--)sa[sum[rk[i]]--]=i;</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)tp[i]=rk[i];</span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)rk[sa[i]]=(tp[sa[i]]==tp[sa[i<span class="number">-1</span>]])?m:++m;</span><br><span class="line"><span class="comment">//è¿™é‡Œé‡æ–°è®¡ç®—æ¯ä¸ªåç¼€çš„æ’åï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”± sa æ•°ç»„å¾—åˆ°ã€‚</span></span><br><span class="line"><span class="keyword">for</span>(k=<span class="number">1</span>;;k&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">&#123;</span><br><span class="line">    m=s=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=n-k+<span class="number">1</span>;i&lt;=n;i++)tp[++s]=i;</span><br><span class="line">    <span class="comment">//è¿™äº›ç¬¬äºŒå…³é”®å­—ä¸º 0 ï¼Œæ‰€ä»¥ä»åœ¨æœ€å‰é¢</span></span><br><span class="line">    <span class="comment">//tp[i] åœ¨è¿™é‡Œè¡¨ç¤ºç¬¬äºŒå…³é”®å­—æ’åä¸º i çš„åç¼€çš„èµ·å§‹ä½ç½®</span></span><br><span class="line">    <span class="comment">//è¿™é‡Œåœ¨æŒ‰ç¬¬äºŒå…³é”®å­—å®‰æ’é¡ºåºï¼Œç¬¬ä¸€éåœ¨å¤–é¢æ’åºçš„æ—¶å€™ä¸å…³å¿ƒç¬¬äºŒå…³é”®å­—</span></span><br><span class="line">    <span class="comment">//åœ¨å€å¢é‡Œæ’åºå…³å¿ƒç¬¬äºŒå…³é”®å­—ï¼Œæˆ‘ä»¬åªéœ€è¦æŒ‰ç¬¬äºŒå…³é”®å­—çš„é¡ºåºè®¿é—® sumï¼Œå°±èƒ½å¾—åˆ°æ­£ç¡®é¡ºåºã€‚</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;sum[i++]=<span class="number">0</span>)<span class="keyword">if</span>(sa[i]&gt;k)tp[++s]=sa[i]-k;</span><br><span class="line">    <span class="comment">//åŒæ ·æ˜¯å¤„ç†ç¬¬äºŒå…³é”®å­—ï¼ŒæŒ‰ç…§ä¸Šä¸€è½®æ’åé¡ºåºéå†å³å¯ã€‚</span></span><br><span class="line">    <span class="comment">//ä½ç½®å‡å» k,å¾—åˆ°ç¬¬äºŒå…³é”®å­—çš„èµ·å§‹ä½ç½®ã€‚</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)sum[rk[i]]++;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)sum[i]+=sum[i<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(i=n;i&gt;=<span class="number">1</span>;i--)sa[sum[rk[tp[i]]]--]=tp[i];</span><br><span class="line">    <span class="comment">//åŒæ ·çš„é“ç†ï¼Œåªä¸è¿‡æ˜¯æŒ‰ç¬¬äºŒå…³é”®å­—å¤§å°é¡ºåºéå†</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)tp[i]=rk[i];</span><br><span class="line">    <span class="comment">//è¿™é‡Œçš„ tp ç”¨æ¥æ‹·è´ rk,å› ä¸º rk åœ¨è®¡ç®—æ—¶ä¼šæ”¹å˜</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)rk[sa[i]]=(tp[sa[i]]==tp[sa[i<span class="number">-1</span>]]&amp;&amp;tp[sa[i]+k]==tp[sa[i<span class="number">-1</span>]+k])?m:++m;</span><br><span class="line">    <span class="comment">//è®¡ç®—æ¯ä¸ªåç¼€å½“å‰æ’å</span></span><br><span class="line">    <span class="keyword">if</span>(m==n)<span class="keyword">break</span>;</span><br><span class="line">    <span class="comment">//åç¼€æ’åºç»“æŸåé€€å‡ºã€‚</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//è®¡ç®— height æ•°ç»„</span></span><br><span class="line"><span class="comment">//height æ•°ç»„æ»¡è¶³ height[sa[i]] &gt;= height[sa[i]-1] - 1</span></span><br><span class="line"><span class="comment">//å¦‚æœ sa[i] = 1ï¼Œé‚£ä¹ˆ height æ²¡å®šä¹‰ï¼Œä¸ç®¡ã€‚</span></span><br><span class="line"><span class="comment">//åŸå› å¾ˆç®€å•ï¼Œä»¥  æ’ååœ¨ä»¥ sa[i]-1 ä¸ºèµ·å§‹ç‚¹çš„åç¼€ x å‰ä¸€ä¸ªçš„åç¼€ yã€‚</span></span><br><span class="line"><span class="comment">//ç”±å®šä¹‰ lcp(x,y) = height[sa[i]-1]</span></span><br><span class="line"><span class="comment">//å°† x åˆ æ‰æœ€å‰ä¸€ä¸ªå­—ç¬¦å¾—åˆ°ä»¥ sa[i] ä¸ºèµ·å§‹ç‚¹çš„åç¼€ aï¼Œ y åˆ æ‰æœ€å‰ä¸€ä¸ªå­—ç¬¦å¾—åˆ° b</span></span><br><span class="line"><span class="comment">//é‚£ä¹ˆ lcp(a,b) = lcp(x,y)</span></span><br><span class="line"><span class="comment">//æ˜¾ç„¶ b æ’åœ¨ a å‰é¢</span></span><br><span class="line"><span class="comment">//æ˜¾ç„¶æ’ååœ¨ a å‰ä¸€ä½çš„é‚£ä¸ªåç¼€ä¸ a çš„ lcp ä¸å¯èƒ½å°‘äº height[sa[i]-1]</span></span><br><span class="line"><span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    height[rk[i]]=<span class="built_in">max</span>(<span class="number">0</span>,height[rk[i<span class="number">-1</span>]]<span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">if</span>(rk[i]==<span class="number">1</span>)<span class="keyword">continue</span>;</span><br><span class="line">    <span class="keyword">while</span>(ch[i+height[rk[i]]+<span class="number">1</span>]==ch[sa[rk[i]<span class="number">-1</span>]+height[rk[i]]+<span class="number">1</span>])height[rk[i]]++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="è«é˜Ÿ"><a href="#è«é˜Ÿ" class="headerlink" title="è«é˜Ÿ"></a>è«é˜Ÿ</h2><p>è«é˜Ÿæ˜¯æš´åŠ›æ•°æ®ç»“æ„ï¼Œå°†è¯¢é—®ç¦»çº¿åï¼Œä»¥è¾ƒä½çš„å¤æ‚åº¦ç§»åŠ¨å·¦å³ç«¯ç‚¹ï¼Œç„¶åå¤„ç†è¯¢é—®ã€‚</p>
<p>è®¾ç§»åŠ¨ç«¯ç‚¹çš„å¤æ‚åº¦ä¸º $O(x)$ ï¼Œé‚£ä¹ˆè«é˜Ÿå¤æ‚åº¦ä¸º $O(n \sqrt n\times x)$ï¼Œæ— æ³•å°† $x$ æ”¾åœ¨ $\sqrt n$ ä¸‹é¢ã€‚</p>
<p>å¸¸è§çš„å¡å¸¸æŠ€å·§æœ‰å¥‡å¶æ€§æ’åºç­‰ã€‚</p>
<p>å¦‚æœåªèƒ½æ”¯æŒæ’å…¥å’Œåˆ é™¤ä¸­çš„ä¸€ç§æ“ä½œï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨å›æ»šè«é˜Ÿï¼Œæ‹¿ä¸€ä¸ªæ ˆè®°å½•æ“ä½œï¼ŒåŸºäºæ“ä½œçš„æ’¤é”€å®ç°æ’å…¥æˆ–åˆ é™¤ã€‚</p>
<p>æ ‘ä¸Šè«é˜Ÿå’Œæ™®é€šè«é˜ŸåŒºåˆ«ä¸å¤§ã€‚</p>
<p>(å·®ä¸€ä¸ªäºŒæ¬¡ç¦»çº¿è¦è¡¥) </p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
      </categories>
      <tags>
        <tag>åŸºç¡€ç®—æ³•</tag>
        <tag>æ±‡æ€»</tag>
      </tags>
  </entry>
  <entry>
    <title>python è¸©å‘è®°å½•</title>
    <url>/2022/07/12/python-%E8%B8%A9%E5%9D%91%E8%AE%B0%E5%BD%95/</url>
    <content><![CDATA[<h3 id="pip-å’ŒåŒ…"><a href="#pip-å’ŒåŒ…" class="headerlink" title="pip å’ŒåŒ…"></a>pip å’ŒåŒ…</h3><ul>
<li>ç”¨ pip å®‰è£…åŒ…æ—¶ï¼Œwindows ä¼šå‡ºå„ç§å„æ ·çš„é—®é¢˜ï¼Œè¯·å…³é—­ä»£ç†å¹¶ä½¿ç”¨å›½å†…æºå®‰è£…</li>
<li>å°†æ‰€æœ‰åŒ…æ”¾åœ¨ç³»ç»Ÿ python ä¸­æ˜¯ä¸€ä¸ªåä¹ æƒ¯ï¼Œpython å„ç§åŒ…çš„æœ‰å¤æ‚çš„ç‰ˆæœ¬ä¾èµ–å…³ç³»ï¼Œè¯·ä½¿ç”¨ anaconda æˆ–è€… virtualenv ç­‰åŒ…ç®¡ç†å™¨ã€‚</li>
</ul>
<h3 id="airtest"><a href="#airtest" class="headerlink" title="airtest"></a>airtest</h3>]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
        <category>è¸©å‘è®°å½•</category>
      </categories>
      <tags>
        <tag>è¸©å‘è®°å½•</tag>
        <tag>python</tag>
      </tags>
  </entry>
  <entry>
    <title>ä»ä¸€é“é¢˜çœ‹CPUåº•å±‚ä¼˜åŒ–</title>
    <url>/2022/07/12/%E4%BB%8E%E4%B8%80%E9%81%93%E9%A2%98%E7%9C%8BCPU%E5%BA%95%E5%B1%82%E4%BC%98%E5%8C%96/</url>
    <content><![CDATA[<h2 id="å…³äºæŸé“é¢˜çš„ä¼˜åŒ–"><a href="#å…³äºæŸé“é¢˜çš„ä¼˜åŒ–" class="headerlink" title="å…³äºæŸé“é¢˜çš„ä¼˜åŒ–"></a>å…³äºæŸé“é¢˜çš„ä¼˜åŒ–</h2><h3 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h3><p>ç»™å®šä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„åºåˆ— $a_i$ï¼Œæ±‚æœ‰å¤šå°‘ä¸ªåŒºé—´æ»¡è¶³æ¯ä¸ªæ•°å‡ºç°æ¬¡æ•°å‡ä¸ºå¶æ•°ã€‚</p>
<p>$n\leq 3\times 10^4,a_i\leq 10^6$</p>
<h3 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h3><p>åŒæŒ‡é’ˆæ‰«ææ¯ä¸ªåŒºé—´ï¼Œæ‹¿ä¸ªæ¡¶ï¼Œ$O(1)$ æ›´æ–°çŠ¶æ€ï¼Œç„¶å $O(n^2)$ï¼Œå¯ä»¥å¾—åˆ° $40$ çš„å¥½æˆç»©ã€‚</p>
<h3 id="ä»£ç ä¸€"><a href="#ä»£ç ä¸€" class="headerlink" title="ä»£ç ä¸€"></a>ä»£ç ä¸€</h3><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y1 y3647</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1000000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(_type &amp;x)</span></span>&#123;</span><br><span class="line">	x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="number">45</span>&amp;&amp;(ch&gt;<span class="string">&#x27;9&#x27;</span>||ch&lt;<span class="string">&#x27;0&#x27;</span>))ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(ch==<span class="number">45</span>)&#123;f=<span class="number">-1</span>,ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmin</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&gt;b)a=b;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmax</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&lt;b)a=b;&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">30005</span>;</span><br><span class="line"><span class="type">int</span> i,j,k,n,s,t,m,ans;</span><br><span class="line"><span class="type">int</span> a[N],b[N];</span><br><span class="line"><span class="type">unsigned</span> cnt[<span class="number">1024</span>*<span class="number">1024</span>];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> 	<span class="built_in">freopen</span>(<span class="string">&quot;gf.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;gf.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	<span class="comment">//freopen(&quot;.in&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">	<span class="built_in">read</span>(n);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">read</span>(a[i]),b[i]=a[i];</span><br><span class="line">	<span class="type">int</span> now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">		now=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j=i;j&lt;=n;j++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt[a[j]])now+=(cnt[a[j]]&amp;<span class="number">1</span>)?<span class="number">1</span>:<span class="number">-1</span>;</span><br><span class="line">			cnt[a[j]]+=<span class="number">1</span>;</span><br><span class="line">			ans+=now==<span class="number">0</span>;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>





<h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><h4 id="1-é«˜é€Ÿç¼“å­˜åŸç†"><a href="#1-é«˜é€Ÿç¼“å­˜åŸç†" class="headerlink" title="1.é«˜é€Ÿç¼“å­˜åŸç†"></a>1.é«˜é€Ÿç¼“å­˜åŸç†</h4><p>è®¡ç®—æœºæœ‰ä¸ªä¸œè¥¿å«é«˜é€Ÿç¼“å­˜ï¼Œå¯ä»¥ä¼˜åŒ–å†…å­˜è®¿é—®å»¶è¿Ÿã€‚</p>
<p>ä¸€æ¬¡ç‹¬ç«‹çš„å†…å­˜æ“ä½œä¼šè¯»å–ä¸€ä¸ª $64Byte$ çš„ $cacheline$ï¼Œä»æŒ‡ä»¤å‘å‡ºåˆ°ä»å†…å­˜æ”¶åˆ°æ•°æ®éœ€è¦çº¦ $200$ ä¸ª $CPU$ å‘¨æœŸï¼Œè€Œ $CPU$ ä¼šå°†ä¸€äº›å¸¸ç”¨çš„æ•°æ®å¡è¿› $cache$ï¼Œä¹Ÿå°±æ˜¯é«˜é€Ÿç¼“å­˜ä¸­ï¼ŒåŠ é€Ÿè¯»å–ï¼Œå¯„å­˜å™¨çš„è®¿é—®é€Ÿåº¦æ˜¯æœ€å¿«çš„ï¼Œåªéœ€è¦ä¸åˆ° $1$ ä¸ªæ—¶é—´å‘¨æœŸï¼Œ$L1$ ç¼“å­˜éœ€è¦çº¦ $3$ ä¸ªæ—¶é—´å‘¨æœŸï¼Œ$L2$ ä¸º $10$ ä¸ªå·¦å³ï¼Œ$L3$ ä¸º $20$ ä¸ªå‘¨æœŸã€‚</p>
<p>å…·ä½“æ—¶é—´è§†è®¡ç®—æœºæœ¬èº«æœ‰å·®åˆ«ï¼Œä½†åŸºæœ¬çš„æ¯”ä¾‹æ˜¯è¿™ä¸ªã€‚</p>
<p>ä»£ç ä¸€ä¸­ï¼Œæˆ‘ä»¬åªå…³æ³¨ç“¶é¢ˆã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">now+=<span class="number">-1</span>+((cnt[a[j]]&amp;<span class="number">1</span>)&lt;&lt;<span class="number">1</span>);</span><br><span class="line">now+=!cnt[a[j]];</span><br><span class="line">cnt[a[j]]+=<span class="number">1</span>;</span><br><span class="line">ans+=now==<span class="number">0</span>;</span><br></pre></td></tr></table></figure>



<p>å…¶ä¸­ï¼Œå¯¹äº <code>cnt</code> çš„è®¿é—®å’Œå¯¹äº <code>a</code> çš„è®¿é—®ï¼Œç”±äºé«˜é€Ÿç¼“å­˜å¹¶ä¸å¤§ï¼Œæ‰€ä»¥å¡ä¸ä¸‹ <code>cnt</code>ï¼Œå› æ­¤æˆ‘ä»¬æ¯ä¸ªå¾ªç¯éƒ½éœ€è¦ç­‰ä¸€ä¸ª <code>200</code> æ—¶é—´å‘¨æœŸçš„å»¶è¿Ÿï¼Œè¿™æ˜¯ç›¸å½“è‡´å‘½çš„ï¼Œå®é™…ä¸Šç­‰å¾…çš„å»¶è¿Ÿå¹¶æ²¡æœ‰ <code>200</code> æ—¶é—´å‘¨æœŸï¼Œå› ä¸º $CPU$ å°†éƒ¨åˆ†æ•°æ®è¿˜æ˜¯æ”¾è¿›æ¥ <code>cache</code>ï¼Œä½†å…·ä½“æ”¾å“ªäº›æ˜¯ç”± <code>CPU</code> å†³å®šçš„ã€‚</p>
<p>å¯¹äºè¿™ä¸ªè‡´å‘½çš„å»¶è¿Ÿï¼Œæˆ‘ä»¬å¯ä»¥å°†æ•°æ®ç¦»æ•£åŒ–ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª <code>75pts</code> çš„ä»£ç ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y1 y3647</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1000000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(_type &amp;x)</span></span>&#123;</span><br><span class="line">	x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="number">45</span>&amp;&amp;(ch&gt;<span class="string">&#x27;9&#x27;</span>||ch&lt;<span class="string">&#x27;0&#x27;</span>))ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(ch==<span class="number">45</span>)&#123;f=<span class="number">-1</span>,ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmin</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&gt;b)a=b;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmax</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&lt;b)a=b;&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">30005</span>;</span><br><span class="line"><span class="type">int</span> i,j,k,n,s,t,m,ans;</span><br><span class="line"><span class="type">int</span> a[N],b[N];</span><br><span class="line"><span class="type">unsigned</span> cnt[<span class="number">1024</span>*<span class="number">30</span>];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> 	<span class="built_in">freopen</span>(<span class="string">&quot;gf.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;gf.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	<span class="comment">//freopen(&quot;.in&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">	<span class="built_in">read</span>(n);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">read</span>(a[i]),b[i]=a[i];</span><br><span class="line">	<span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);m=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+m+<span class="number">1</span>,a[i])-b;</span><br><span class="line">	<span class="type">int</span> now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">		now=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j=i;j&lt;=n;j++)&#123;</span><br><span class="line">			<span class="keyword">if</span>(cnt[a[j]])now+=cnt[a[j]]&amp;<span class="number">1</span>?<span class="number">1</span>:<span class="number">-1</span>;</span><br><span class="line">			cnt[a[j]]+=<span class="number">1</span>;</span><br><span class="line">			ans+=now==<span class="number">0</span>;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2-æµæ°´çº¿æ¨¡å¼å’Œå»¶è¿Ÿéšè—"><a href="#2-æµæ°´çº¿æ¨¡å¼å’Œå»¶è¿Ÿéšè—" class="headerlink" title="2.æµæ°´çº¿æ¨¡å¼å’Œå»¶è¿Ÿéšè—"></a>2.æµæ°´çº¿æ¨¡å¼å’Œå»¶è¿Ÿéšè—</h4><p>ç°ä»£è®¡ç®—æœºå„ç±»ç¡¬ä»¶çš„è®¾è®¡éƒ½é‡‡ç”¨äº†æµæ°´çº¿æ¨¡å¼ï¼Œå°†æ¯æ¡æ±‡ç¼–æŒ‡ä»¤çš„æ‰§è¡Œéƒ½åˆ’åˆ†ä¸ºäº†ä¸åŒçš„æµæ°´çº¿ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ <strong>CPU å¯ä»¥ä¸é—´æ–­çš„å‘å†…å­˜å‘å‡ºè®¿é—®æŒ‡ä»¤ï¼Œè¿™äº›æŒ‡ä»¤ç»è¿‡ä¸€å®šå»¶è¿Ÿåï¼Œå†…å­˜ä¼šä¸é—´æ–­çš„å‘CPUä¼ æ•°æ®ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å°±åªç­‰å¾…äº†ä¸€ä¸ªå†…å­˜å»¶è¿Ÿã€‚</strong>æ‰“ä¸ªæ¯”æ–¹ï¼Œè¿™ç©æ„å°±åƒçƒ§æ°´ï¼Œæ°´å£¶å¾ˆå¤šï¼ŒçŒæ°´å’Œå€’æ°´çš„æ—¶é—´éƒ½å¾ˆçŸ­ï¼Œæ‰€ä»¥æ­£ç¡®çš„æ–¹å¼æ˜¯å…¨éƒ¨çƒ§ä¸Šç­‰ï¼Œè€Œä¸æ˜¯çƒ§ä¸€ä¸ªç­‰ä¸€ä¸ªã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å¤Ÿè¿ç»­çš„å‘å‡ºå†…å­˜è®¿é—®æŒ‡ä»¤ï¼Œé‚£ä¹ˆå†…å­˜å»¶è¿Ÿå¯ä»¥è¢«æœ‰æ•ˆéšè—ï¼Œä½†æ³¨æ„åˆ°ä»£ç ä¸­ï¼Œè®¿é—®äº†å†…å­˜åæ‰§è¡Œäº†ä¸€äº›è®¡ç®—ï¼Œè€Œå†…å­˜è®¿é—®æ˜¯ä¾èµ–äºè¿™äº›è®¡ç®—çš„ï¼Œè¿™äº§ç”Ÿäº†ä¸€ä¸ªä¾èµ–ï¼Œæˆ‘ä»¬å¿…é¡»ç­‰å¾…è®¡ç®—å®Œæˆä¹‹åæ‰èƒ½è¿›è¡Œè®¿é—®ï¼Œæ‰€ä»¥æ— æ³•æœ‰æ•ˆçš„éšè—å»¶è¿Ÿã€‚</p>
<p><strong>å‘å†…å­˜å†™å…¥æ•°æ®ä¹Ÿæ˜¯éœ€è¦ç­‰å¾…å»¶è¿Ÿçš„ã€‚</strong></p>
<h4 id="3-æµæ°´çº¿å’Œä¾èµ–åˆ†æ"><a href="#3-æµæ°´çº¿å’Œä¾èµ–åˆ†æ" class="headerlink" title="3.æµæ°´çº¿å’Œä¾èµ–åˆ†æ"></a>3.æµæ°´çº¿å’Œä¾èµ–åˆ†æ</h4><p>ä¸Šä¸€éƒ¨åˆ†ç®€å•ä»‹ç»äº†æµæ°´çº¿æ¨¡å¼ï¼Œåœ¨æˆ‘ä»¬çš„ $CPU$ ä¸­ï¼Œä¹Ÿé‡‡ç”¨æµæ°´çº¿çš„è®¾è®¡ã€‚</p>
<p>ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤çš„æ‰§è¡Œåœ¨ $CPU$ ä¸Šå¤§è‡´åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼Œåˆ†åˆ«æ˜¯ï¼šå–æŒ‡ï¼Œè®¿(å¯„)å­˜ï¼Œè®¡ç®—ï¼Œå†…å­˜æ“ä½œï¼Œå†™å›ã€‚</p>
<p>$CPU$ åœ¨è¿™äº”ä¸ªéƒ¨åˆ†çš„è®¾è®¡ä¸Šä¹Ÿé‡‡ç”¨äº†æµæ°´çº¿ï¼Œä¸€æ¡æŒ‡ä»¤å¼€å§‹è®¿å­˜æ—¶ï¼Œå¦ä¸€æ¡æŒ‡ä»¤çš„å–æŒ‡å°±å¼€å§‹äº†ã€‚</p>
<p>è€Œå¦‚æœä¸‹ä¸€æ¡æŒ‡ä»¤å¯¹å‰ä¸€æ¡æŒ‡ä»¤æœ‰<strong>æ•°æ®ä¾èµ–</strong>ï¼Œé‚£ä¹ˆ $CPU$ ä¼šé€šè¿‡è½¬å‘æ“ä½œæ¶ˆé™¤è¿™ç§ä¾èµ–ï¼Œä½†å¦‚æœä¸‹ä¸€æ¡æŒ‡ä»¤çš„å†…å®¹å¯¹ä¸Šä¸€æ¡æŒ‡ä»¤æœ‰ä¾èµ–ï¼ˆæ¯”å¦‚è¯´ ifï¼‰ï¼Œé‚£ä¹ˆ $CPU$ å°±ä¸å¾—ä¸åœæ­¢æµæ°´çº¿ï¼Œå‘æµæ°´çº¿ä¸­æ’å…¥æ°”æ³¡ä»¥ç­‰å¾…ã€‚</p>
<p>è¿™ä¼šæå¤§é™ä½ $CPU$ çš„åˆ©ç”¨ç‡ï¼Œå› æ­¤ï¼Œå†…å¾ªç¯ä¸­çš„ $if$ æ˜¯ç›¸å½“ä¸åº”è¯¥çš„ã€‚</p>
<h4 id="4-æµæ°´çº¿å’Œåˆ†æ”¯é¢„æµ‹"><a href="#4-æµæ°´çº¿å’Œåˆ†æ”¯é¢„æµ‹" class="headerlink" title="4.æµæ°´çº¿å’Œåˆ†æ”¯é¢„æµ‹"></a>4.æµæ°´çº¿å’Œåˆ†æ”¯é¢„æµ‹</h4><p>äº‹å®ä¸Šï¼Œç¡¬ä»¶çš„è®¾è®¡è€…æ³¨æ„åˆ°äº†è¿™ç§ä¾èµ–ï¼Œè€Œ $CPU$ ä¼šå¯¹è¿™ç§ä¾èµ–åšå‡ºé¢„æµ‹ï¼Œé¢„æµ‹åŸºäºç¨‹åºè®¡æ•°å™¨çš„çš„åŸç†å’Œä¸€äº›å…¶å®ƒç»Ÿè®¡æ•°æ®ï¼Œæ­£ç¡®ç‡çº¦åœ¨ $65%$ å·¦å³ï¼Œå¦‚æœåˆ†æ”¯é¢„æµ‹å‡ºç°é”™è¯¯ï¼Œé‚£ä¹ˆä¼šèŠ±è´¹ä¸¤ä¸ªæ—¶é—´å‘¨æœŸå»æ¶ˆé™¤è¿™ä¸ªé”™è¯¯ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦é€šè¿‡ç®—æœ¯æ–¹å¼é¿å…åˆ†æ”¯ã€‚</p>
<p>æ–¹å¼å¦‚ä¸‹ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> y1 y3647</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1000000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(_type &amp;x)</span></span>&#123;</span><br><span class="line">	x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="number">45</span>&amp;&amp;(ch&gt;<span class="string">&#x27;9&#x27;</span>||ch&lt;<span class="string">&#x27;0&#x27;</span>))ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(ch==<span class="number">45</span>)&#123;f=<span class="number">-1</span>,ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmin</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&gt;b)a=b;&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type1,<span class="keyword">typename</span> _type2&gt;<span class="function"><span class="type">void</span> <span class="title">cmax</span><span class="params">(_type1 &amp;a,<span class="type">const</span> _type2 b)</span></span>&#123;<span class="keyword">if</span>(a&lt;b)a=b;&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">30005</span>;</span><br><span class="line"><span class="type">int</span> i,j,k,n,s,t,m,ans;</span><br><span class="line"><span class="type">int</span> a[N],b[N];</span><br><span class="line"><span class="type">unsigned</span> <span class="type">short</span> cnt[<span class="number">1024</span>*<span class="number">30</span>];</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> 	<span class="built_in">freopen</span>(<span class="string">&quot;gf.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;gf.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">	<span class="comment">//freopen(&quot;.in&quot;,&quot;w&quot;,stdout);</span></span><br><span class="line">	<span class="built_in">read</span>(n);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">read</span>(a[i]),b[i]=a[i];</span><br><span class="line">	<span class="built_in">sort</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>);m=<span class="built_in">unique</span>(b+<span class="number">1</span>,b+n+<span class="number">1</span>)-b<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)a[i]=<span class="built_in">lower_bound</span>(b+<span class="number">1</span>,b+m+<span class="number">1</span>,a[i])-b;</span><br><span class="line">	<span class="type">int</span> now=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)&#123;</span><br><span class="line">		</span><br><span class="line">		<span class="built_in">memset</span>(cnt,<span class="number">0</span>,<span class="built_in">sizeof</span>(cnt));</span><br><span class="line">		now=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(j=i;j&lt;=n;j++)&#123;</span><br><span class="line">			now+=<span class="number">-1</span>+((cnt[a[j]]&amp;<span class="number">1</span>)&lt;&lt;<span class="number">1</span>);</span><br><span class="line">			now+=!cnt[a[j]];</span><br><span class="line">			cnt[a[j]]+=<span class="number">1</span>;</span><br><span class="line">			ans+=now==<span class="number">0</span>;</span><br><span class="line">		&#125;	</span><br><span class="line">	&#125;</span><br><span class="line">	cout&lt;&lt;ans&lt;&lt;endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>ç›®å‰æ˜¯æœ€å¿«ä»£ç ã€‚</p>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
        <category>ç¡¬ä»¶</category>
      </categories>
      <tags>
        <tag>åº•å±‚ä¼˜åŒ–</tag>
        <tag>ç¡¬ä»¶åŸç†</tag>
        <tag>æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›æœ‰ç”¨çš„å‘½ä»¤</title>
    <url>/2022/07/12/%E4%B8%80%E4%BA%9B%E6%9C%89%E7%94%A8%E7%9A%84%E5%91%BD%E4%BB%A4/</url>
    <content><![CDATA[<h4 id="è®¾ç½®-pip-é»˜è®¤ä¸‹è½½æº"><a href="#è®¾ç½®-pip-é»˜è®¤ä¸‹è½½æº" class="headerlink" title="è®¾ç½® pip é»˜è®¤ä¸‹è½½æº"></a>è®¾ç½® pip é»˜è®¤ä¸‹è½½æº</h4><p><code>pip config set global.index-url https://pypi.tuna.tsinghua.edu.cn/simple</code></p>
]]></content>
      <categories>
        <category>æŠ€æœ¯</category>
        <category>æ‚é¡¹</category>
      </categories>
      <tags>
        <tag>æ±‡æ€»</tag>
      </tags>
  </entry>
  <entry>
    <title>ä¸€äº›ç§‘æŠ€çš„æ€»ç»“</title>
    <url>/2022/07/12/%E4%B8%80%E4%BA%9B%E7%A7%91%E6%8A%80%E7%9A%84%E6%80%BB%E7%BB%93/</url>
    <content><![CDATA[<h2 id="æ€»ç»“ä¸€äº›ç§‘æŠ€"><a href="#æ€»ç»“ä¸€äº›ç§‘æŠ€" class="headerlink" title="æ€»ç»“ä¸€äº›ç§‘æŠ€"></a>æ€»ç»“ä¸€äº›ç§‘æŠ€</h2><p>ä¸»è¦æ”¶å½•æ¯”è¾ƒç¥ä»™çš„ï¼Œå®ç”¨çš„ç®—æ³•æŠ€å·§ã€‚</p>
<h3 id="å¿«é€Ÿå–æ¨¡"><a href="#å¿«é€Ÿå–æ¨¡" class="headerlink" title="å¿«é€Ÿå–æ¨¡"></a>å¿«é€Ÿå–æ¨¡</h3><h4 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h4><p>æ‰¾åˆ°ä¸€ä¸ªè¿‘ä¼¼ $m^{-1}$ çš„å½¢å¦‚ $mâ€™&gt;&gt;k$ çš„æ•°ã€‚</p>
<p>ä¸å¦¨å°±å– $k&#x3D;64,mâ€™&#x3D;\lceil\frac{2^{64}}{m}\rceil$</p>
<p>ç„¶å $a%b &#x3D; a-a\times\lfloor\frac{a}{b}\rfloor &#x3D; a-(a\times mâ€™&gt;&gt;64)$</p>
<p>çº¯çº¯çš„æ•´æ•°è¿ç®—ï¼Œç»è¿‡è¯¯å·®åˆ†æï¼Œå¯ä»¥çŸ¥é“åå¼ç»“æœæœ€å¤šå¤šå‡å»ä¸€ä¸ª $m$ï¼Œåˆ¤æ–­æ‰å°±è¡Œã€‚</p>
<p>å› ä¸º $a$ å¸¸å¸¸æ˜¯ $\text{long long}$ çº§åˆ«çš„æ•°ï¼Œæ‰€ä»¥å¼€ <code>__int128</code></p>
<p>ä¼˜åŒ–æ®è¯´æœ‰ $5-6$ å€ï¼Œå¦‚æœæ¨¡æ•°æ˜¯ <code>const</code>ï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨å¸®å¿™ç”¨è¿™ä¸ªä¼˜åŒ–ã€‚</p>
<h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">barrett</span>&#123;</span><br><span class="line">	ULL im;<span class="type">int</span> m;</span><br><span class="line">	<span class="built_in">barrett</span>(<span class="type">unsigned</span> m) :<span class="built_in">m</span>(m), <span class="built_in">im</span>(~<span class="number">0ull</span>/m+<span class="number">1</span>) &#123;&#125;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">operator</span> <span class="params">()</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">		ULL z=(ULL)a*b;</span><br><span class="line">		<span class="type">int</span> v=z-((__int128)z*im&gt;&gt;<span class="number">64</span>)*m;</span><br><span class="line">		<span class="keyword">return</span> v&lt;<span class="number">0</span>?v+m:v;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;<span class="built_in">bt</span>(<span class="number">1</span>);</span><br><span class="line">  bt=<span class="built_in">barrett</span>(p);</span><br><span class="line">  c=<span class="built_in">bt</span>(a,b);</span><br><span class="line"><span class="comment">//c=a*b%p</span></span><br></pre></td></tr></table></figure>

<h4 id="æ³¨æ„äº‹é¡¹"><a href="#æ³¨æ„äº‹é¡¹" class="headerlink" title="æ³¨æ„äº‹é¡¹"></a>æ³¨æ„äº‹é¡¹</h4><ul>
<li>ä¸ºå•¥ <code>im,m</code> ç”¨ <code>ull,uint</code>ï¼Œå› ä¸º <code>m=2</code> æ—¶ï¼Œä¼šçˆ† <code>long long</code>ã€‚</li>
<li>å¯ä»¥é‡è½½æ‹¬å·ã€‚</li>
</ul>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
        <category>æŠ€å·§</category>
      </categories>
      <tags>
        <tag>æ±‡æ€»</tag>
        <tag>æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>å†™æ³•ä¼˜ç¾çš„å¸¸ç”¨å‡½æ•°</title>
    <url>/2022/07/12/%E5%86%99%E6%B3%95%E4%BC%98%E7%BE%8E%E7%9A%84%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0/</url>
    <content><![CDATA[<h2 id="å†™æ³•ä¼˜ç¾çš„å¸¸ç”¨å‡½æ•°"><a href="#å†™æ³•ä¼˜ç¾çš„å¸¸ç”¨å‡½æ•°" class="headerlink" title="å†™æ³•ä¼˜ç¾çš„å¸¸ç”¨å‡½æ•°"></a>å†™æ³•ä¼˜ç¾çš„å¸¸ç”¨å‡½æ•°</h2><p>æ”¶å½•ä¸€äº›ä¼˜ç¾çš„å¸¸ç”¨å‡½æ•°å†™æ³•ã€‚</p>
<h3 id="åˆ†è§£è´¨å› æ•°"><a href="#åˆ†è§£è´¨å› æ•°" class="headerlink" title="åˆ†è§£è´¨å› æ•°"></a>åˆ†è§£è´¨å› æ•°</h3><p>æœ‰äººæ ¹æœ¬ä¸ä¼šç”¨ <code>do while</code> å’Œ <code>vector</code>ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i*i&lt;=n;i++)<span class="keyword">if</span>(n%i==<span class="number">0</span>)&#123;</span><br><span class="line">    v.<span class="built_in">push_back</span>(i);</span><br><span class="line">    <span class="keyword">do</span> n/=i; <span class="keyword">while</span>(n%i==<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>ç®—æ³•</category>
        <category>æŠ€å·§</category>
      </categories>
      <tags>
        <tag>æ±‡æ€»</tag>
        <tag>æŠ€å·§</tag>
      </tags>
  </entry>
  <entry>
    <title>å¸¸ç”¨æ•°å­¦ç»“è®ºè¯æ˜æ±‡æ€»</title>
    <url>/2022/07/12/%E5%B8%B8%E7%94%A8%E6%95%B0%E5%AD%A6%E7%BB%93%E8%AE%BA%E8%AF%81%E6%98%8E%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<h3 id="ç®€å•äº‹å®"><a href="#ç®€å•äº‹å®" class="headerlink" title="ç®€å•äº‹å®"></a>ç®€å•äº‹å®</h3><ol>
<li>$\gcd(a,x_1)&#x3D;1,\gcd(a,x_2)&#x3D;1 \leftrightarrow \gcd(a,x_1x_2)$</li>
<li>è‹¥ $n\ |\ m$ åˆ™ $\phi(n)\ |\ \phi(m)$</li>
<li>è‹¥ $\gcd(a,p)&#x3D;1$,åˆ™ $ax,x \in [1,p]$ æ¨¡ $p$ æ„ä¹‰ä¸‹äº’ä¸ç›¸åŒï¼Œåä¹‹äº¦ç„¶ã€‚</li>
</ol>
<h3 id="æ¨¡è¿ç®—å’Œæ»¡è¶³çš„è¿ç®—ç‡"><a href="#æ¨¡è¿ç®—å’Œæ»¡è¶³çš„è¿ç®—ç‡" class="headerlink" title="æ¨¡è¿ç®—å’Œæ»¡è¶³çš„è¿ç®—ç‡"></a>æ¨¡è¿ç®—å’Œæ»¡è¶³çš„è¿ç®—ç‡</h3><p>æ³¨ï¼šç¬¦å·å‡ä¸ºæ¨¡ $p$ æ„ä¹‰ä¸‹ã€‚</p>
<ul>
<li>åŠ æ³•äº¤æ¢å¾‹</li>
<li>åŠ æ³•ç»“åˆå¾‹</li>
<li>ä¹˜æ³•äº¤æ¢å¾‹</li>
<li>ä¹˜æ³•ç»“åˆç‡</li>
<li>å¦‚æœ $p$ ä¸ºè´¨æ•° ï¼Œ$g$ ä¸º $p$ çš„ä¸€ä¸ªåŸæ ¹ï¼Œåˆ™ $\log_x(y) &#x3D; \frac{\log_g(y)}{\log_g(x)} \pmod {p-1}$</li>
</ul>
<h3 id="å¤æ•°è¿ç®—æ»¡è¶³çš„è¿ç®—æ€§è´¨"><a href="#å¤æ•°è¿ç®—æ»¡è¶³çš„è¿ç®—æ€§è´¨" class="headerlink" title="å¤æ•°è¿ç®—æ»¡è¶³çš„è¿ç®—æ€§è´¨"></a>å¤æ•°è¿ç®—æ»¡è¶³çš„è¿ç®—æ€§è´¨</h3><ul>
<li>åŠ æ³•äº¤æ¢å¾‹</li>
<li>åŠ æ³•ç»“åˆå¾‹</li>
</ul>
<h3 id="ä¸€äº›æŠ½è±¡ä»£æ•°å†…å®¹"><a href="#ä¸€äº›æŠ½è±¡ä»£æ•°å†…å®¹" class="headerlink" title="ä¸€äº›æŠ½è±¡ä»£æ•°å†…å®¹"></a>ä¸€äº›æŠ½è±¡ä»£æ•°å†…å®¹</h3><h4 id="äº‹å®1"><a href="#äº‹å®1" class="headerlink" title="äº‹å®1"></a>äº‹å®1</h4><p>ä»¤ $g$ ä¸º $p$ çš„ä¸€ä¸ªåŸæ ¹ï¼Œè®° $\log_g(x) &#x3D; y$ï¼Œæ¨¡ $p$ æ„ä¹‰ä¸‹ $x$ çš„é˜¶æ•°ä¸º<br>$$<br>\Large ord &#x3D; \frac{\phi(p)}{\gcd(\phi(p),\log_g(x))}<br>$$</p>
<h4 id="è¯æ˜1"><a href="#è¯æ˜1" class="headerlink" title="è¯æ˜1"></a>è¯æ˜1</h4><p> æ˜¾ç„¶ $g$ çš„é˜¶æ•°ä¸º $\phi(p)$ï¼Œåˆå› ä¸º $g^y &#x3D; x$ã€‚æ‰€ä»¥ $x^{ord} &#x3D; 1$ã€‚</p>
<p>ç„¶åè¯æ˜ $x^i,i \in [1,ord]$ äº’ä¸ç›¸åŒã€‚</p>
<p>åè¯ï¼Œå¦‚æœç›¸åŒï¼Œè®¾ä¸º $i,j(i\ge j)$ï¼Œé‚£ä¹ˆ $g^{yi} &#x3D; g^{yj}$ å¾—åˆ° $\phi(x) |\ y(i-j)$ ä¸¤è¾¹åŒæ—¶é™¤ä»¥ $\gcd(\phi(p),y)$ï¼Œå¾—åˆ° $ord |\ yâ€™(i-j)$ï¼Œå…¶ä¸­ $\gcd(yâ€™,ord) &#x3D; 1$ ï¼Œå¾—å‡º $i-j \ge ord$ çŸ›ç›¾ã€‚</p>
<p>æ‰€ä»¥ $x$ çš„é˜¶æ•°ä¸º $ord$</p>
<h3 id="è£´èœ€å®šç†"><a href="#è£´èœ€å®šç†" class="headerlink" title="è£´èœ€å®šç†"></a>è£´èœ€å®šç†</h3><h4 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h4><p>$\exist\  x,y \in \Z$ ä½¿å¾— $ax+by&#x3D;\gcd(x,y)$</p>
<h4 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>å½’çº³æ„é€ ã€‚</p>
<p>å…ˆè¯æ˜ $\exist\ xâ€™,yâ€™\in \Z$ ä½¿å¾— $bxâ€™+(a%b)yâ€™ &#x3D; \gcd(a,b)$</p>
<p>å³ $ayâ€™ + b(xâ€™-\big\lfloor\dfrac{a}{b}\big\rfloor yâ€™) &#x3D; \gcd(a,b)$</p>
<p>æ„é€  $x &#x3D; yâ€™,y&#x3D;xâ€™- \big\lfloor\dfrac{a}{b}\big\rfloor yâ€™$ å³å¯æ»¡è¶³æ¡ä»¶ã€‚</p>
<p>é€’å½’è¯æ˜æ„é€ å¼å­ï¼Œå¾—åˆ°è¾¹ç•Œè¯æ˜ $\exist \ x,y$ ä½¿å¾— $\gcd(a,b)x + 0 \times y &#x3D;\gcd(a,b)$</p>
<p>ä»¤ $x&#x3D;1,y&#x3D;0$</p>
<h3 id="æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°"><a href="#æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°" class="headerlink" title="æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°"></a>æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°</h3><p> å³è¯æ˜è‹¥ $\gcd(n,m) &#x3D;1,$ åˆ™  $\phi(n*m) &#x3D; \phi(n) *\phi(m)$</p>
<p>è€ƒè™‘è‹¥å¹²ä¸ªåŒä½™æ–¹ç¨‹ç»„<br>$$<br>x â‰¡ r_1 \pmod n\<br>x â‰¡ r_2 \pmod m\<br>$$<br>åˆ—å‡º $n,m,nm$ æ„ä¹‰ä¸‹çš„æœ€å°ç¼©ç³» $S_n,S_m,T$</p>
<p>å®¹æ˜“è¯æ˜ $\forall\ r_1\in S_n, r_2 \in S_m$ï¼Œå­˜åœ¨å”¯ä¸€ $x \in [1,nm]$ æ˜¯ä¸ŠåŒä½™æ–¹ç¨‹ç»„çš„è§£ï¼Œä¸” $x \in T$ã€‚</p>
<p>å­˜åœ¨å”¯ä¸€å°±æ˜¯ $EXCRT$ï¼Œ $x\in T$ ç”±äº‹å® 1 æ˜¾ç„¶ã€‚</p>
<p>æ•… $\phi(n*m) \ge \phi(n) *\phi(m)$</p>
<p>å†è¯æ˜ $\forall\ x$ï¼Œå¯ä»¥å¯¹åº”ä»¥ä¸Šä¸€ä¸ªåŒä½™æ–¹ç¨‹ç»„çš„è§£ï¼Œå‡è®¾ä¸æ˜¯ï¼Œé‚£ä¹ˆå®ƒä¸€å®šä¸ $n,m$ ä¸­çš„ä¸€ä¸ªäº’è´¨ï¼Œç”±äº‹å® 1 æ¨å‡ºçŸ›ç›¾ã€‚</p>
<p>æ•… $\phi(n*m) \le \phi(n) *\phi(m)$</p>
<p>è¯æ¯•ã€‚</p>
<h3 id="æ¬§æ‹‰å®šç†"><a href="#æ¬§æ‹‰å®šç†" class="headerlink" title="æ¬§æ‹‰å®šç†"></a>æ¬§æ‹‰å®šç†</h3><h4 id="å†…å®¹-1"><a href="#å†…å®¹-1" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h4><p>$$<br>\Large è‹¥ \ \gcd(a,m)&#x3D; 1 ,\ åˆ™\  a^{\phi(m)}â‰¡1\mod m<br>$$</p>
<h4 id="è¯æ˜-1"><a href="#è¯æ˜-1" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>è€ƒè™‘æ¨¡ $m$ æ„ä¹‰ä¸‹çš„æœ€å°ç¼©ç³»ï¼Œå³æœ€å°å®Œå…¨å‰©ä½™ç³»åˆ å»ä¸ $m$ ä¸äº’è´¨çš„å…ƒç´ åçš„å‰©ä½™ç³»ï¼Œè®°ä¸º $S$ã€‚</p>
<p>æ„é€  $T &#x3D; {ax,x \in S}$</p>
<p>å¯ä»¥è¯æ˜ $T&#x3D;S$ï¼Œ è‹¥ $\exist\ x_1,x_2$ ä½¿å¾— $x_1\neq x_2$ ä¸” $ax_1 â‰¡ ax_2 \pmod m$ ï¼Œå› ä¸º $\gcd(a,m)&#x3D;1$</p>
<p>æ‰€ä»¥ $m\ |\ x_1 - x_2$ï¼Œå¹¶æ¨å‡º $x_1 \neq x_2$ï¼Œæ•… $T$ ä¸­å…ƒç´ ä¸¤ä¸¤ä¸åŒä¸”å‡ä¸ $m$ äº’è´¨ï¼Œå³ä¸º $S$ã€‚</p>
<p>è€ƒè™‘ $T,S$ ä¸­æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ï¼Œå¾—åˆ° $\prod\limits_{i&#x3D;1}^{\phi(n)} ax_i â‰¡ \prod\limits_{i&#x3D;1}^{\phi(n)} x_i \pmod n$ï¼Œåˆå› ä¸º $\prod\limits_{i&#x3D;1}^{\phi(n)} x_i$ ä¸ $m$ äº’è´¨ï¼Œæ‰€ä»¥ $a^{\phi(n)} â‰¡ 1\pmod n$</p>
<h3 id="æ‰©å±•æ¬§æ‹‰å®šç†"><a href="#æ‰©å±•æ¬§æ‹‰å®šç†" class="headerlink" title="æ‰©å±•æ¬§æ‹‰å®šç†"></a>æ‰©å±•æ¬§æ‹‰å®šç†</h3><h4 id="å†…å®¹-2"><a href="#å†…å®¹-2" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h4><p>$$<br>\Large è‹¥ \ bâ‰¥Ï†(m) ,\ åˆ™\  a^bâ‰¡a^{b \mod Ï†(m) +Ï†(m)}\mod m<br>$$</p>
<h4 id="è¯æ˜-2"><a href="#è¯æ˜-2" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>å¯¹ $m$ è€ƒè™‘å”¯ä¸€åˆ†è§£å®šç†ã€‚</p>
<p>å¯¹äºä»»æ„å› å­ $p_i^{k_i}$ï¼Œè‹¥ä¸ $a$ äº’è´¨ï¼Œé‚£å°±æœ‰ $a^bâ‰¡a^{b \mod Ï†(m) +Ï†(m)}\mod p^{k_i}_i$ã€‚</p>
<p>å¦‚æœå’Œ $a$ ä¸äº’è´¨ï¼Œå› ä¸º  $b\ge \phi(m)$ï¼Œé‚£ä¹ˆå› ä¸ºæœ‰ $b\ge \phi(m)\ge k_i$ï¼Œæ‰€ä»¥ $a^b,a^{(b \mod Ï†(m)) +Ï†(m)}$ éƒ½æ˜¯ $p^{k_i}_i$ çš„å€æ•°ã€‚</p>
<p>å¾—åˆ° $a^b - a^{(b \mod Ï†(m)) +Ï†(m)}$ æ˜¯ $p_i^{k_i}$ çš„å€æ•°ï¼Œæ•…åŒä½™ã€‚</p>
<h3 id="åŸæ ¹å­˜åœ¨å®šç†"><a href="#åŸæ ¹å­˜åœ¨å®šç†" class="headerlink" title="åŸæ ¹å­˜åœ¨å®šç†"></a>åŸæ ¹å­˜åœ¨å®šç†</h3><h4 id="åŸæ ¹ï¼š"><a href="#åŸæ ¹ï¼š" class="headerlink" title="åŸæ ¹ï¼š"></a>åŸæ ¹ï¼š</h4><h5 id="å®šä¹‰ï¼š"><a href="#å®šä¹‰ï¼š" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h5><p>å¦‚æœ $x^1,x^2,x^3 \cdots x^{\phi(n)-1}$ æ¨¡ $n$ æ„ä¹‰ä¸‹äº’ä¸ç›¸åŒï¼Œä¸” $\gcd(x,n)&#x3D;1$ï¼Œåˆ™ç§° $x$ ä¸º $n$ çš„åŸæ ¹ã€‚</p>
<h5 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨:"></a>æ€§è´¨:</h5><p>è´¨æ•° $p$ çš„åŸæ ¹çš„æ–¹å¹‚èƒ½å–é $[1,p-1]$</p>
<h4 id="å†…å®¹ï¼š"><a href="#å†…å®¹ï¼š" class="headerlink" title="å†…å®¹ï¼š"></a>å†…å®¹ï¼š</h4><p>ä¸€ä¸ªæ•° $x$ æœ‰åŸæ ¹å½“ä¸”ä»…å½“ $x&#x3D; 2,4,p^n,2\times p^n$ï¼Œå…¶ä¸­ $p$ ä¸ºå¥‡ç´ æ•°ã€‚</p>
<h4 id="è¯æ˜ï¼š"><a href="#è¯æ˜ï¼š" class="headerlink" title="è¯æ˜ï¼š"></a>è¯æ˜ï¼š</h4><p>æˆ‘ä¸ä¼šã€‚</p>
]]></content>
      <categories>
        <category>æ•°å­¦</category>
        <category>ä¿¡æ¯ç«èµ›ä¸­çš„æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ±‡æ€»</tag>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>åšé¢˜3</title>
    <url>/2022/07/12/%E5%81%9A%E9%A2%983/</url>
    <content><![CDATA[<h3 id="CF1698F"><a href="#CF1698F" class="headerlink" title="CF1698F"></a>CF1698F</h3><h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>å˜è¿‡æ¥å˜è¿‡å»ï¼Œè¿˜ TM ç¦»è°±çš„æ“ä½œå½“ç„¶è¦æ‰¾ä¸å˜é‡ï¼Œç®—æ˜¯åŠä¸ªå¥—è·¯ã€‚</p>
<p><code>reverse</code> ä¸¤ç«¯ç›¸ç­‰çš„åŒºé—´ï¼Œå¯ä»¥å‘ç°æ¯ä¸¤ä¸ªç›¸é‚»å…ƒç´ æ„æˆçš„æ— åºå¯¹ä¸å˜ï¼Œç„¶åç¬¬ä¸€ä¸ªå…ƒç´ å’Œæœ€åä¸€ä¸ªå…ƒç´ ä¸æ”¹å˜ã€‚</p>
<p>æ¢å¥è¯è¯´ï¼Œ${(a_i,a_{i+1},i \in [1,n)}$ è¿™ä¸ªé›†åˆä¸éš $a$ ä¸­æ“ä½œæ”¹å˜ã€‚æˆ–è€…è¯´ï¼Œå¦‚æœä» $a_i$ åˆ° $a_{i+1}$ è¿è¾¹ï¼Œè¿™å¼ æ— å‘å›¾æ˜¯ä¸å˜çš„ï¼ŒåŒæ—¶ $a_1,a_n$ ä¸æ”¹å˜ã€‚è¿™ä¸ªæ¡ä»¶å’Œä¸Šä¸ªæ¡ä»¶ä¹‹é—´çš„è½¬æ¢æ˜¯è§£é¢˜çš„å…³é”®ç‚¹ä¹‹ä¸€ã€‚</p>
<p>å¥—è·¯åˆæ¥äº†ï¼Œçœ‹çœ‹æ ·ä¾‹ï¼Œé›†åˆç›¸åŒå¹¶ä¸”é¦–å°¾ç›¸åŒè¿™ä¸ªæ¡ä»¶è²Œä¼¼æŒºå……åˆ†çš„ï¼Œæ‰€ä»¥è€ƒè™‘è¯æ˜ã€‚</p>
<p><strong>å¯¹äºæ„é€ é—®é¢˜ï¼Œå¸¸ç”¨çš„è¯æ˜æ–¹å¼æ˜¯æ•°å­¦å½’çº³æ³•ã€‚</strong></p>
<p>äº‹å®ä¸Šï¼Œå¦‚æœæˆ‘ä»¬èƒ½è¯æ˜å¦‚æœç¬¬äºŒä¸ªæ•°å¯ä»¥æˆåŠŸè°ƒæ•´ä¸ºç›¸åŒï¼Œé‚£ä¹ˆæ•´ä¸ªæ•°ç»„ä¹Ÿå¯ä»¥ï¼Œå› ä¸ºæ»¡è¶³æ¡ä»¶çš„ $a,b$ å¦‚æœåŒæ—¶åˆ æ‰ç¬¬ä¸€ä¸ªæ•°ï¼Œä»æ»¡è¶³æ¡ä»¶ã€‚</p>
<p>è€ƒè™‘æ„é€ æ–¹æ¡ˆï¼Œç”±ç»“è®ºå¯ä»¥çŸ¥é“ï¼Œå¦‚æœ $a$ ä¸­å¿…å®šå­˜åœ¨ $(b_1,b_2)$ æ— åºå¯¹ï¼Œå› ä¸º $a_2\neq b_2$ï¼Œä¸å¦¨è®©è¿™å¯¹æ— åºå¯¹æ˜¯ $(a_x,a_{x+1}),x\in[2,n)$ï¼Œå¦‚æœ $a_x&#x3D;b_2$ï¼Œè€ƒè™‘ç›´æ¥å°†è¿™ä¸€å¯¹ä¸­çš„ $a_{x+1}$ å’Œ $a_1$ å­æ•°ç»„ <code>reverse</code> ï¼Œå®Œäº‹ã€‚å¦‚æœ $a_{x+1}&#x3D;b_2$ï¼Œäº‹æƒ…æœ‰ç‚¹éº»çƒ¦ã€‚</p>
<p><code>if only i could find a pair which...</code></p>
<p>è¡¥ä¸Šé‚£å¥è¯ï¼Œå¦‚æœèƒ½æ‰¾åˆ°ä¸€å¯¹å¯ä»¥è¢«ç¿»è½¬çš„ï¼Œå·¦ç«¯ç‚¹åœ¨ $[1,x]$ ï¼Œå³ç«¯ç‚¹åœ¨ $(x,n]$ çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ç¿»è½¬ï¼Œæ”¹å˜äº† $a_x,a_{x+1}$ çš„é¡ºåºã€‚</p>
<p>å°è¯•è¯æ˜ä¸€å®šèƒ½æ‰¾åˆ°ï¼Œå³ ${a_i ,i\in [1,x]} \bigcap {a_i.i\in(x,n]} \neq \emptyset$</p>
<p>åè¯æ³•ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œé‚£ä¹ˆå¯çŸ¥ $a_i,i\in[1,x] $ ä¸ $a_j,j\in (x,n]$ é™¤å¼€ $(a_i,a_i+1)$ è¿™ä¸€æ¬¡ç›¸é‚»å¤–å‡ä¸ç›¸é‚»ï¼Œè€ƒè™‘ $b_2$ å³ $a_{x+1}$ çš„æƒ…å†µï¼Œå®ƒä¸ $b_3$ ç›¸é‚»ï¼Œå¯çŸ¥ $b_3 \in {a_i.i\in(x,n]}$ï¼ŒåŒç†æœ‰  $\forall j\ge 2,b_j\in{a_i.i\in(x,n]}$</p>
<p>è€ƒè™‘ $a_2$ï¼Œå®ƒæ˜¾ç„¶ä¸å­˜åœ¨äº $b$ï¼Œæ•…çŸ›ç›¾ã€‚</p>
<h4 id="å›é¡¾"><a href="#å›é¡¾" class="headerlink" title="å›é¡¾"></a>å›é¡¾</h4><p>è¿™é¢˜æ¯”è¾ƒéš¾çš„æœ‰ä¸¤ä¸ªç‚¹ï¼Œä¸€æ˜¯æ³¨æ„åˆ°è¿™ä¸ªä¸å˜é‡æå¤§å¯èƒ½æ˜¯å……åˆ†æ¡ä»¶ï¼ŒäºŒæ˜¯å‘ç° $a_{x+1}&#x3D;b_2$ çš„ case ä¸­ä¸€å®šå­˜åœ¨å¯äº¤æ¢é¡¹ï¼Œæå®šäº†è¿™ä¸¤ä¸ªï¼Œé—®é¢˜å°±è¿åˆƒè€Œè§£ã€‚å…³é”®ç‚¹åœ¨äºç¬¬äºŒä¸ªï¼Œæ‰¾åˆ° $a_{[1,x]},a_{[x+1,n]}$ äº¤é›†çš„å…³ç³»ï¼Œå¹¶å°è¯•ç”¨åè¯æ³•è¯æ˜äº¤é›†ä¸ä¸ºç©ºæ˜¯æ¯”è¾ƒå›°éš¾çš„ã€‚</p>
<h3 id="ABC259G"><a href="#ABC259G" class="headerlink" title="ABC259G"></a>ABC259G</h3><p>å¾ˆæœ‰æ„æ€çš„ç½‘ç»œæµé¢˜ã€‚</p>
<p>æœ€å¼€å§‹æƒ³åˆ°äºŒåˆ†å›¾ç›¸å…³ï¼Œå› ä¸º $A_{i,j} &lt;0$ çš„é™åˆ¶æŒ‡å‘æ€§æ¯”è¾ƒæ˜ç¡®ï¼Œç„¶åå‘ç°å¦‚æœäºŒåˆ†å›¾çš„å†³ç­–æ­£æ•°è¯ä¼šå‡ºç°ä¸åŒå—ä¹‹é—´ç›¸äº’å½±å“ï¼Œæ‰€ä»¥è€ƒè™‘å†³ç­–è´Ÿæ•°ï¼Œå†³ç­–è´Ÿæ•°ä¸åŒè”é€šå—äº’ä¸å½±å“ï¼Œä½†æ˜¯æ— æ³•è®¡ç®—ç­”æ¡ˆï¼Œå› ä¸ºæœ€ç»ˆè¿˜æ˜¯éœ€è¦ç¡®å®šåˆ°åº•å“ªäº›æ­£æ•°è¢«é€‰äº†ã€‚</p>
<h4 id="è§£æ³•ä¸€"><a href="#è§£æ³•ä¸€" class="headerlink" title="è§£æ³•ä¸€"></a>è§£æ³•ä¸€</h4><p>é¢˜è§£ç»™å‡ºäº†ä¸€ä¸ªæ–°æ€è·¯ï¼Œè€ƒè™‘å…ˆåªæŠŠæ‰€æœ‰æ­£æ•°é€‰äº†ï¼Œç„¶åå†æ¥çœ‹æ»¡è¶³æ¡ä»¶çš„ä»£ä»·ã€‚</p>
<p>ä»£ä»·è¢«åˆ†ä¸ºäº†ä¸‰ç±»ï¼Œç¬¬ä¸€ç±»æ˜¯é¡ºå¸¦é€‰æ‹©çš„è´Ÿæ•°çš„ä»£ä»·ï¼Œå¦‚æœé€‰äº†ä¸€è¡Œæˆ–è€…ä¸€åˆ—ï¼Œå°±ä¼šæœ‰è¿™ä¸€è¡Œæˆ–åˆ—æ‰€æœ‰è´Ÿæ•°ç»å¯¹å€¼ä¹‹å’Œçš„ä»£ä»·ã€‚</p>
<p>ç¬¬äºŒç±»æ˜¯æ— æ³•é€‰æ‹©æ­£æ•°çš„ä»£ä»·ï¼Œå¦‚æœæ­£æ•°æ‰€åœ¨çš„è¡Œå’Œåˆ—éƒ½æ²¡è¢«é€‰æ‹©ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰è¿™ä¸ªæ­£æ•°çš„ä»£ä»·ã€‚</p>
<p>ç¬¬ä¸‰ç±»æ˜¯é‡å¤é€‰æ‹©è´Ÿæ•°çš„ä»£ä»·ï¼Œå¦‚æœä¸€ä¸ªè´Ÿæ•°è¢«è¡Œå’Œåˆ—åŒæ—¶é€‰æ‹©ï¼ˆä¸ºäº†ä»˜å‡ºæ›´å°‘çš„ç¬¬äºŒç±»å’Œå…¶å®ƒç¬¬ä¸€ç±»ä»£ä»·ï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªä»£ä»·æ˜¯æ— ç©·å¤§ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦æœ€å°åŒ–ä»£ä»·ã€‚</p>
<p>0&#x2F;1 å†³ç­–é—®é¢˜ï¼Œè€ƒè™‘å¥—æœ€å°å‰²ä¸Šå»ï¼Œæ¯ä¸€è¡Œæ¯ä¸€åˆ—è§†ä¸ºä¸€ä¸ªç‚¹ã€‚</p>
<p>ä»¤ä¸ $s$ åŒé›†åˆçš„ä¸ºé€‰æ‹©ï¼Œä¸ $t$ åŒé›†åˆçš„ä¸ºä¸é€‰ï¼Œé€‰ä¸€è¡Œæˆ–ä¸€åˆ—çš„ä»£ä»·ä¸ºè¯¥è¡Œæˆ–åˆ—è´Ÿæ•°ç»å¯¹å€¼ä¹‹å’Œï¼Œä»ä¸ªç‚¹åˆ° $t$ è¿è¾¹å°±è¡Œï¼Œè¡Œåˆ—åŒæ—¶é€‰æ‹©è´Ÿæ•°ï¼Œä»£ä»·ä¸º infï¼Œwocï¼Œæ€ä¹ˆè¿å‘¢ï¼Ÿä»è¡Œè¿å‘åˆ—ï¼Œæ„ä¹‰ä¸ºé€‰äº†è¡Œä¸é€‰åˆ—çš„ä»£ä»·ï¼Œä»åˆ—å‘è¡Œè¿ï¼Œæ„ä¹‰ä¸ºé€‰äº†åˆ—ä¸é€‰è¡Œçš„ä»£ä»·ã€‚æ‰€ä»¥æˆ‘ä»¬å‰é¢çš„å®‰æ’æœ‰äº›é—®é¢˜ï¼Œéœ€è¦åšå‡ºè°ƒæ•´ã€‚</p>
<p><strong>å¯¹äºè¡Œå’Œåˆ—ï¼Œæˆ‘ä»¬è®©å±äº s,t æ‰€åœ¨é›†åˆå¯¹å®ƒä»¬æœ‰ä¸åŒæ„ä¹‰ï¼Œä¸‹é¢è®©å±äº s çš„è¡Œä¸ºä¸é€‰æ‹©ï¼Œå±äº t çš„åˆ—ä¸ºä¸é€‰æ‹©</strong>ï¼Œæˆ‘ä»¬è®© $s$ å‘è¡Œè¿è¾¹ï¼Œ<strong>è¿™æ¡è¾¹</strong>è¡¨ç¤ºé€‰è¯¥è¡Œçš„ä»£ä»·ï¼Œè®©åˆ—å‘ $t$ è¿è¾¹ï¼Œè¡¨ç¤ºé€‰è¯¥åˆ—çš„ä»£ä»·ã€‚äºæ˜¯ï¼Œå¯¹äºä¸€ä¸ªç‚¹ï¼Œè¡Œåˆ—éƒ½é€‰çš„ä»£ä»·å½“ä¸”ä»…å½“ $A_{i,j}&lt;0$ æ—¶ä¸º infï¼Œæ­¤æ—¶ä»åˆ—å‘è¡Œè¿è¾¹ï¼Œè¡¨ç¤ºéƒ½é€‰çš„ä»£ä»·ï¼Œè¡Œåˆ—éƒ½ä¸é€‰çš„ä»£ä»·å½“ä¸”ä»…å½“ $A_{i,j}\ge0$ æ—¶ä¸º $A_{i,j}$ï¼Œæ­¤æ—¶ä»è¡Œå‘åˆ—è¿è¾¹ã€‚</p>
<p>æ³¨æ„ï¼Œæˆ‘ä»¬çš„å‰²ä¸­å¦‚æœå‡ºç°äº†è¡Œåˆ—éƒ½ä¸é€‰ï¼Œé‚£ä¹ˆå¯¹åº”çš„è¡Œå’Œåˆ—ä¸ $s,t$ çš„è¾¹ä¸€å®šæ²¡æœ‰æ–­å¼€ï¼Œæ‰€ä»¥å¿…é¡»æ–­å¼€è¡Œåˆ°åˆ—çš„è¾¹ã€‚å¦‚æœå‡ºç°äº†è¡Œå’Œåˆ—éƒ½é€‰çš„ä¸åˆæ³•æƒ…å†µï¼Œæˆ‘ä»¬å‘ç°ï¼Œæ–­æ‰çš„è¡Œèƒ½åˆ° $t$ï¼Œä» $s$ ä¸€å®šèƒ½åˆ°æ–­æ‰çš„åˆ—ã€‚å¦‚æœä¸æ»¡è¶³ï¼Œé‚£ä¹ˆè¿™ä¸ªå‰²å°±ä¸æ˜¯æœ€å°å‰²ï¼Œä¸ä¼šè¢«æˆ‘ä»¬è€ƒè™‘ã€‚æ‰€ä»¥æˆ‘ä»¬éœ€è¦ä»åˆ—åˆ°è¡Œè¿è¾¹ï¼Œä¿è¯ä¸ä¼šç»™è´Ÿæ•°æ‰“ä¸Šä¸¤ä¸ªæ ‡è®°ã€‚</p>
<p>è¿™ç§æ€è·¯å’ŒæŸç±» dp çš„æ€è·¯å¾ˆç±»ä¼¼ï¼Œç›¸å½“å€¼å¾—å­¦ä¹ ï¼Œå…¶å®åœ¨åŸé—®é¢˜çš„æ±‚è§£ä¸­ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ¡ä»¶æ¥ä¿è¯ä¸ä¼šç»™ä¸€ä¸ªè´Ÿæ•°æ‰“ä¸Šä¸¤ä¸ªæ ‡è®°ï¼Œä½†æ˜¯æˆ‘ä»¬åœ¨é€šè¿‡æœ€å°å‰²æ±‚è§£æ—¶ï¼Œé™å®šäº†å†³ç­–çš„èŒƒå›´å’Œæœ€ä¼˜æ€§ï¼Œè·å¾—äº†é¢å¤–çš„ä¿¡æ¯ï¼Œä¹Ÿå°±èƒ½å¸®åŠ©æˆ‘ä»¬æ’é™¤æ‰éš¾å¤„ç†ä½†æ˜¯ä¸å¯èƒ½çš„æƒ…å†µï¼Œæœ¬è´¨ä¸Šï¼Œè¿™ç§æ’é™¤è¿˜å’Œæˆ‘ä»¬å…ˆå‡å®šæ‰€æœ‰æ­£æ•°éƒ½é€‰ä¸Šçš„å‰ææœ‰å…³ç³»ï¼Œè¿™ç§è§£æ³•ç›¸å½“ç²¾å¦™ã€‚</p>
<h4 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h4><p>ä»ç›´è§‰ä¸Šæ¥çœ‹ï¼Œåº”è¯¥ä¸ä¼šé€‰æ‹©å’Œä¸ºè´Ÿæ•°çš„è¡Œæˆ–è€…åˆ—ã€‚è€ƒè™‘ä¸€ä¸ªæœ€ç»ˆæ–¹æ¡ˆï¼Œå®ƒçš„ç­”æ¡ˆä¼šæ˜¯ $\sum é€‰æ‹©çš„è¡Œ+\sum é€‰æ‹©çš„åˆ— -\sum è¡Œåˆ—äº¤å‰å¤„çš„æ­£æ•°$ã€‚è€ƒè™‘ä»è¿™é‡Œé¢å‰”é™¤å’Œä¸ºè´Ÿæ•°çš„åˆ—æˆ–è¡Œï¼Œå‘ç°æœ€ç»ˆå€¼ä¸€å®šå˜å¤§ã€‚</p>
<p>æ‰€ä»¥åˆ æ‰å’Œä¸ºè´Ÿæ•°çš„è¡Œå’Œåˆ—ã€‚</p>
<p>è€ƒè™‘å…ˆæŠŠå‰©ä¸‹çš„è¡Œå’Œåˆ—å…¨é€‰äº†ï¼Œç„¶åè§£å†³å†²çªã€‚</p>
<p>è§£å†³å†²çªçš„æ–¹å¼æœ‰ä¸‰ç§ï¼Œä¸€ç§æ—¶ä¸é€‰è¡Œï¼Œä¸€ç§æ˜¯ä¸é€‰åˆ—ï¼Œå¦ä¸€ç§æ˜¯ç¡¬åƒåŒæ—¶é€‰çš„ä»£ä»·ã€‚</p>
<p>è¿™æ ·çš„å»ºå›¾å°±å¾ˆç®€æ´äº†ï¼Œä» $s$ å‘è¡Œï¼Œåˆ—å‘ $t$ è¿è¾¹ï¼Œå¯¹äºäº¤ç‚¹ï¼Œæ­£æ•°è¿å…¶å€¼çš„è¾¹ï¼Œè´Ÿæ•°è¿ inf è¾¹ã€‚å¾ˆå®¹æ˜“å‘ç°ä¸€ä¸ªåˆæ³•è§£å’Œä¸€ä¸ªå‰²ä¸€ä¸€å¯¹åº”ï¼Œoverã€‚</p>
<h4 id="Sum-up"><a href="#Sum-up" class="headerlink" title="Sum up"></a>Sum up</h4><p><strong>æœ€å°å‰²è§£å†³å®é™…é—®é¢˜çš„æ ¸å¿ƒï¼Œåœ¨äºç”¨ä¸€ä¸ªå‰²ï¼Œæˆ–è€…å¯èƒ½æˆä¸ºæœ€å°å‰²çš„å‰²ï¼Œæ¥ä»£è¡¨ä¸€ä¸ªå®é™…çš„å†³ç­–æ–¹æ¡ˆï¼Œæœ€å°å‰²çš„å®¹é‡ï¼Œä»£è¡¨ä»£ä»·ï¼Œæ¯ä¸ªç‚¹åœ¨å“ªä¸ªå‰²é›†åˆ†åˆ«ä»£è¡¨ä»€ä¹ˆå«ä¹‰å¹¶ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯å‰²æ‰æ¯æ¡è¾¹çš„æ„ä¹‰ï¼Œå’Œå†³ç­–æ–¹æ¡ˆä¸æœ€å°å‰²çš„å¯¹åº”å…³ç³»ã€‚</strong></p>
<p>å…¶å®è¿™é“é¢˜è¿˜ç»™æˆ‘ä»¬ä¸€ä¸ªå¯å‘ï¼Œå°±æ˜¯åœ¨è€ƒè™‘0&#x2F;1å†³ç­–é—®é¢˜æ—¶ï¼Œå¯ä»¥å…ˆè€ƒè™‘é’¦å®šä¸€ä¸ªå†³ç­–ï¼Œå†æ¥è°ƒæ•´ä½¿å¾—å®ƒåˆç†æˆ–è€…å˜ä¼˜ï¼Œè¿™å¯èƒ½ä¼šä½¿å¾—é—®é¢˜å˜å¾—ç®€å•ï¼Œä¹Ÿè®¸ç®—æ˜¯ä¸€ä¸ªå¥—è·¯ã€‚</p>
<p><strong>æœ¬è´¨ä¸Šï¼Œæœ€å°å‰²è¡¨è¾¾äº†ä¸€ç§æœ€ä¼˜çš„è§£å†³å†³ç­–å†²çªçš„æ–¹æ¡ˆï¼Œæˆ‘ä»¬åœ¨ 0&#x2F;1 å†³ç­–é—®é¢˜é’¦å®šå†³ç­–çš„è¿‡ç¨‹ä¸­ï¼Œåˆ¶é€ äº†ä¸€äº›å†²çªï¼Œç”¨ä¸€ä¸ªå›¾çš„å‰²æ¥è¡¨è¾¾è§£å†³ç€äº›å†²çªçš„æ–¹æ¡ˆã€‚</strong></p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>è®­ç»ƒé¢˜ç›®</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
      </tags>
  </entry>
  <entry>
    <title>å¹»å½±ä¸å½©è™¹çš„æ•…äº‹</title>
    <url>/2022/07/13/%E5%B9%BB%E5%BD%B1%E4%B8%8E%E5%BD%A9%E8%99%B9%E7%9A%84%E6%95%85%E4%BA%8B/</url>
    <content><![CDATA[<p> å¦‚æœç•™å¿ƒè¿‡æˆ‘çš„ QQ,Luogu ä¹‹ç±»çš„ç¤¾äº¤è´¦å·çš„è¯ï¼ŒåŒ…æ‹¬æˆ‘è¿™ä¸ªåšå®¢ï¼Œéƒ½å¯ä»¥å‘ç°ä¸€äº›å…³é”®çš„åœ°æ–¹ï¼Œå°‘ä¸äº†å½©è™¹çš„èº«å½±ï¼Œå½©è™¹ï¼Œå’Œå¹»å½±å½­ï¼Œåˆæœ‰ä»€ä¹ˆè”ç³»ï¼Ÿ</p>
<p>å¥½å¥‡å¯¹å§ï¼ˆï¼ˆ</p>
<p>æˆ‘æœ€å¼€å§‹çš„ ID å«ä¼é¹…æ˜ è•¾ï¼Œæ²¡é”™ï¼Œå°±æ˜¯ä¸€ä¸ªå¥³ç”Ÿçš„ IDï¼Œè€Œä¸”çœ‹ä¸Šå»å°±åƒé‚£ç§éšæœºçš„ IDã€‚å¥½å§ï¼Œå…¶å®å¹»å½±å½­è¿™ä¸ª ID ä¹Ÿæ˜¯éšæœºéšå‡ºæ¥çš„ã€‚éšå‡ºè¿™ä¿© ID çš„æ¸¸æˆå« 4399æªé­‚ï¼Œä¸çŸ¥é“ç°åœ¨æ˜¯å¦è¿˜æ´»ç€ï¼Œæ— è®ºå¦‚ä½•ï¼Œè¿™ä¸ªä¸çŸ¥åçš„å°æ¸¸æˆæ˜¯æˆ‘ç½‘ç»œäº¤å‹çš„å¼€å§‹ï¼Œæˆ‘å½“æ—¶å››å¹´çº§ã€‚</p>
<p>è¿™ä¸ªæ¸¸æˆä¸å¤§ï¼Œä½†æ˜¯æœåŠ¡å™¨å€’æ˜¯å¾ˆå¤šï¼Œæˆ‘é€‰ä¸ªä¸€ä¸ªå¥³æ€§è§’è‰²ï¼Œå°±éšäº†ä¸€ä¸ª ä¼é¹…æ˜ è•¾ çš„  IDï¼Œæˆ‘æ‰“æ¸¸æˆçš„æ—¶å€™è®¤è¯†äº†ä¸€ä¸ª ID å« ç´«ç™¾åˆ çš„è€å“¥ï¼Œç„¶åè¿˜åŠ å…¥äº†ä¸€ä¸ªå†›å›¢ï¼Œå…·ä½“å•¥åçš„å¿˜äº†ã€‚å†›å›¢äººä¸å¤šï¼Œä½†é™¤äº†å†›å›¢é•¿ï¼ŒID æˆ‘éƒ½å¿˜äº†ï¼Œå†›å›¢é•¿ ID å« è èæ˜ æŸ”ï¼Œæ˜¯ä¸æ˜¯å’Œ ä¼é¹…æ˜ è•¾å¾ˆé…ï¼Ÿèƒ½ç©è¿™ç§æœ‰äº›çš„ï¼Œå¹´é¾„éƒ½ä¸å¤§ï¼Œæˆ‘å½“æ—¶è§‰å¾—æˆ‘å’Œè¿™ä¸ªå†›å›¢é•¿å°±å¾ˆæœ‰ç¼˜å•Šï¼Œç„¶åæˆ‘å»ºç«‹ä¸ªå†›å›¢ QQ ç¾¤ï¼Œå½“æ—¶è¿˜ä¸çŸ¥é“æœ‰ç¾¤å¤‡æ³¨è¿™ä¸ªä¸œè¥¿ï¼Œå°±ç›´æ¥æŠŠè‡ªå·± QQ ID ä»ä¸€ä¸²æ•°å­—æ”¹æˆäº†ä¼é¹…æ˜ è•¾ã€‚æˆ‘å¾ˆå¥½å¥‡å…¶ä»–äººçœ‹åˆ°æˆ‘ IDï¼Œç„¶åå†çœ‹æ€§åˆ«ä¸Šå¤§å¤§çš„ç”·å­—ï¼Œæ˜¯ä»€ä¹ˆæ„Ÿå—ã€‚</p>
<p>ç„¶åè¿™ä¸ªå†›å›¢ç¾¤å°±å»ºå¥½äº†ã€‚</p>
]]></content>
      <categories>
        <category>ç”Ÿæ´»</category>
      </categories>
      <tags>
        <tag>ç”Ÿæ´»</tag>
      </tags>
  </entry>
  <entry>
    <title>å¹»å½±ä¸è¯ºé£</title>
    <url>/2022/07/13/%E5%B9%BB%E5%BD%B1%E4%B8%8E%E8%AF%BA%E9%A3%8E/</url>
    <content><![CDATA[]]></content>
  </entry>
  <entry>
    <title>æ‰©å±•åº“ï¼Œè¯­æ³•å’Œè¯­æ³•ç³–</title>
    <url>/2022/07/12/%E6%89%A9%E5%B1%95%E5%BA%93%EF%BC%8C%E8%AF%AD%E6%B3%95%E5%92%8C%E8%AF%AD%E6%B3%95%E7%B3%96/</url>
    <content><![CDATA[<h2 id="è¯­æ³•å’Œè¯­æ³•ç³–"><a href="#è¯­æ³•å’Œè¯­æ³•ç³–" class="headerlink" title="è¯­æ³•å’Œè¯­æ³•ç³–"></a>è¯­æ³•å’Œè¯­æ³•ç³–</h2><p>ä»‹ç»ä¸€äº›æœ‰ç”¨å¸¸ç”¨ä½†é²œä¸ºäººçŸ¥çš„ <code>C++</code> è¯­æ³•ï¼Œåº“ï¼Œè¯­æ³•ç³–ã€‚</p>
<h3 id="å¹³æ¿ç”µè§†"><a href="#å¹³æ¿ç”µè§†" class="headerlink" title="å¹³æ¿ç”µè§†"></a>å¹³æ¿ç”µè§†</h3><p>ä¸€ä¸ª <code>C++</code> æ‹“å±•åº“ï¼Œ<code>STL</code> å‡çº§ç‰ˆï¼Œ<code>C++11</code> ç‰¹æ€§ã€‚</p>
<h4 id="gp-hash-table"><a href="#gp-hash-table" class="headerlink" title="gp_hash_table"></a>gp_hash_table</h4><p>å¦‚åç§°ï¼Œå“ˆå¸Œè¡¨ï¼Œæ¯” <code>unordered_map</code> å¿« <code>3~4</code> å€ï¼Œç”¨æ³•å®Œå…¨ä¸€æ ·ï¼Œä½ å€¼å¾—æ‹¥æœ‰ã€‚</p>
<p>åœ¨ <code>ext/pb_ds/assoc_container.hpp</code> ä¸­ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ext/pb_ds/assoc_container.hpp&gt;</span></span></span><br><span class="line">__gnu_pbds:: gp_hash_table &lt;<span class="type">int</span>,<span class="type">int</span>&gt; mp;</span><br><span class="line">mp.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1</span>,<span class="number">2</span>));</span><br><span class="line">mp[<span class="number">2</span>]=<span class="number">3</span>;</span><br><span class="line"><span class="keyword">if</span>(mp.<span class="built_in">find</span>(<span class="number">2</span>) != mp.<span class="built_in">end</span>())&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,mp.<span class="built_in">find</span>(<span class="number">2</span>)-&gt;second);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h3><p>ä¸€èˆ¬æ¥è¯´ <code>class</code> å’Œ <code>struct</code> ç«èµ›ä¸Šå·®åˆ«ä¸å¤§ï¼Œ<code>struct</code> æ˜¯é»˜è®¤ <code>public</code> çš„ <code>class</code>ã€‚</p>
<h4 id="é‡è½½æ‹¬å·"><a href="#é‡è½½æ‹¬å·" class="headerlink" title="é‡è½½æ‹¬å·"></a>é‡è½½æ‹¬å·</h4><p>é‡è½½æ‹¬å·è¿ç®—ç¬¦å¯ä»¥è®©ä½ æŠŠç»“æ„ä½“å½“å‡½æ•°ç”¨ï¼Œå…¶å®æœ¬è´¨ä¸Šå°‘å†™äº†ä¸€ä¸ª <code>.&#123;function name&#125;</code>ã€‚</p>
<p>å®ƒå’Œæ„é€ å‡½æ•°ä¸å†²çªã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">barrett1</span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> m,im;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">operator</span> <span class="params">()</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">		ULL z=(ULL)a*b;</span><br><span class="line">		<span class="type">int</span> v=z-((__int128)z*im&gt;&gt;<span class="number">64</span>)*m;</span><br><span class="line">		<span class="keyword">return</span> v&lt;<span class="number">0</span>?v+m:v;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;bt1;</span><br><span class="line"><span class="type">int</span> a=<span class="number">1</span>,b=<span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> c=<span class="built_in">bt1</span>(a,b);</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">barrett2</span>&#123;</span><br><span class="line">	<span class="type">long</span> <span class="type">long</span> m,im;</span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">foo</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span>&#123;</span><br><span class="line">		ULL z=(ULL)a*b;</span><br><span class="line">		<span class="type">int</span> v=z-((__int128)z*im&gt;&gt;<span class="number">64</span>)*m;</span><br><span class="line">		<span class="keyword">return</span> v&lt;<span class="number">0</span>?v+m:v;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;bt2;</span><br><span class="line">c=bt2.<span class="built_in">foo</span>(a,b);</span><br></pre></td></tr></table></figure>

<p>ä¸¤è€…æ²¡æœ‰æœ¬è´¨åŒºåˆ«ã€‚</p>
<h4 id="æ„é€ "><a href="#æ„é€ " class="headerlink" title="æ„é€ "></a>æ„é€ </h4><p>ç»“æ„ä½“çš„æ„é€ å‡½æ•°å¯ä»¥è¿”å›ä¸€ä¸ªç»“æ„ä½“å®ä¾‹ï¼Œä¹Ÿå¯ä»¥å…è®¸åœ¨å£°æ˜ç»“æ„ä½“çš„æ—¶å€™åŒæ—¶æ„é€ ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;string str;</span><br><span class="line">    <span class="built_in">st</span>(<span class="type">int</span> aa,<span class="type">int</span> bb)&#123;</span><br><span class="line">        a=aa;</span><br><span class="line">        b=bb;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">st t1=<span class="built_in">st</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"><span class="function">st <span class="title">t2</span><span class="params">(<span class="number">2</span>,<span class="number">3</span>)</span></span>;</span><br><span class="line"><span class="comment">// st t3; è¿™å¥ä¼š CE</span></span><br></pre></td></tr></table></figure>

<p>è¿™ä¸¤ç§å†™æ³•éƒ½è¡Œï¼Œ<strong>æ³¨æ„ä¸èƒ½å˜é‡é‡å</strong>ï¼Œä¸ä¼š <code>CE</code>ï¼Œä½†æ˜¯å‡½æ•°å‚æ•°é‡Œä¼šé‚£ä¸ªåå­—ä¼šè¦†ç›–æ‰å…¨å±€çš„ã€‚</p>
<p>æ³¨æ„å†™äº†æ„é€ å‡½æ•°ï¼Œæ‰€æœ‰çš„æ„é€ éƒ½å¿…é¡»å¸¦å‚æ•°ã€‚</p>
<p>å®šä¹‰ç»“æ„ä½“çš„æ—¶å€™è¿˜å¯ä»¥ç»™å˜é‡èµ‹åˆå€¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b=<span class="number">1</span>;string str=<span class="string">&quot;str&quot;</span>;</span><br><span class="line">    <span class="built_in">st</span>(<span class="type">int</span> aa,<span class="type">int</span> bb)&#123;</span><br><span class="line">        a=aa;</span><br><span class="line">        b=bb;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">st t1=<span class="built_in">st</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"><span class="function">st <span class="title">t2</span><span class="params">(<span class="number">2</span>,<span class="number">3</span>)</span></span>;</span><br><span class="line"><span class="comment">// t1.str=&quot;str&quot;,t1.b=3</span></span><br><span class="line"><span class="comment">// t2.str=&quot;str&quot;,t2.b=3</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœæ„é€ å‡½æ•°é‡Œå†™äº†ï¼Œå°±ä¼šè¢«è¦†ç›–ã€‚å£°æ˜çš„å±€éƒ¨å˜é‡å†™äº†çš„åˆå€¼ä¼šå›ºå®šï¼Œæ²¡å†™çš„åˆå€¼å°±éšæœºã€‚</p>
<p>å¦‚æœæ²¡å†™æ„é€ å‡½æ•°ï¼Œé‚£ä¹ˆä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„åˆ—è¡¨æ„é€ å‡½æ•°ï¼ŒæŒ‰ç…§ç»“æ„ä½“å†…å£°æ˜å˜é‡çš„é¡ºåºå°†åˆ—è¡¨ä¸­çš„æ¯ä¸€ä¸ªå€¼ä¾æ¬¡èµ‹ç»™å¯¹åº”å˜é‡ã€‚</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b=<span class="number">1</span>;string str=<span class="string">&quot;str&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line">st t1=st&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="string">&#x27;huan_yp&#x27;</span>&#125;;</span><br><span class="line">st t2&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="string">&quot;huan_yp&quot;</span>&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>å…¶å®æ„é€ å‡½æ•°è¿˜æœ‰å¦ä¸€ç§å†™æ³•</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;string str;</span><br><span class="line">    <span class="built_in">st</span>(<span class="type">int</span> aa,<span class="type">int</span> bb): <span class="built_in">a</span>(aa), <span class="built_in">b</span>(bb) &#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line">st t1=<span class="built_in">st</span>(<span class="number">2</span>,<span class="number">3</span>);</span><br><span class="line"><span class="function">st <span class="title">t2</span><span class="params">(<span class="number">2</span>,<span class="number">3</span>)</span></span>;</span><br></pre></td></tr></table></figure>

<p>å’Œæœ€å¼€å§‹çš„å†™æ³•æ˜¯ç­‰æ•ˆçš„ã€‚</p>
<p><strong>æ³¨æ„ï¼Œå¦‚æœå†™äº†æ„é€ å‡½æ•°ï¼Œé»˜è®¤çš„åˆ—è¡¨æ„é€ å‡½æ•°ä¼šè°ƒç”¨å®ƒï¼Œæ‰€ä»¥å¦‚æœä½ æƒ³ä¸åŒå‚æ•°ä¸ªæ•°æ„é€ ï¼Œéœ€è¦å¡«é»˜è®¤å‚æ•°</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b;string str;</span><br><span class="line">    <span class="built_in">st</span>() :<span class="built_in">a</span>(), <span class="built_in">b</span>(), <span class="built_in">str</span>()&#123;&#125;</span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰è¿™ä¸€è¡Œï¼Œä¸‹é¢çš„ç¬¬ä¸€ä¸ªæ„é€ ä¼š CE</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">	<span class="built_in">st</span>(<span class="type">int</span> aa, <span class="type">int</span> bb,string cc) :<span class="built_in">a</span>(aa), <span class="built_in">b</span>(bb), <span class="built_in">str</span>(cc)&#123;&#125;</span><br><span class="line"><span class="comment">//    st() :a(), b(), str() &#123;&#125;</span></span><br><span class="line"><span class="comment">//    st(int aa,int bb): a(aa), b(bb) &#123;&#125;</span></span><br><span class="line">&#125;;</span><br><span class="line">st t1;</span><br><span class="line">t1=&#123;<span class="number">2</span>,<span class="number">3</span>,<span class="string">&quot;str&quot;</span>&#125;;</span><br><span class="line">t1=&#123;<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line"><span class="comment">//æœ€åä¸€è¡Œä¼š CE</span></span><br></pre></td></tr></table></figure>

<p>åˆ—è¡¨æ„é€ å¼è¿˜å¯ä»¥è‡ªæ¨å¯¼ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">st</span>&#123;</span><br><span class="line">    <span class="type">int</span> a,b=<span class="number">1</span>;string str=<span class="string">&quot;str&quot;</span>;</span><br><span class="line">    <span class="built_in">st</span>(<span class="type">int</span> aa,<span class="type">int</span> bb)&#123;</span><br><span class="line">        a=aa;</span><br><span class="line">        b=bb;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">st t1=&#123;<span class="number">2</span>,<span class="number">3</span>&#125;;</span><br><span class="line">t1=&#123;<span class="number">3</span>,<span class="number">4</span>&#125;;</span><br><span class="line"><span class="comment">//t1(2,3)</span></span><br><span class="line"><span class="comment">//æ‹¬å·å¼å¼ä¸èƒ½è‡ªæ¨å¯¼çš„ï¼Œè¿™ä¸ªçš„å«ä¹‰å‚è€ƒç¬¬ä¸€æ¡ã€‚</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>è¯­æ³•</category>
        <category>C++</category>
      </categories>
      <tags>
        <tag>æ±‡æ€»</tag>
        <tag>æŠ€å·§</tag>
        <tag>è¯­æ³•</tag>
      </tags>
  </entry>
  <entry>
    <title>æ•°å­¦ç®—æ³•æ±‡æ€»</title>
    <url>/2022/07/12/%E6%95%B0%E5%AD%A6%E7%AE%97%E6%B3%95%E6%B1%87%E6%80%BB/</url>
    <content><![CDATA[<h2 id="æ•°å­¦ç®—æ³•ä»‹ç»"><a href="#æ•°å­¦ç®—æ³•ä»‹ç»" class="headerlink" title="æ•°å­¦ç®—æ³•ä»‹ç»"></a>æ•°å­¦ç®—æ³•ä»‹ç»</h2><p>ä¸»è¦ä»‹ç»ä¸€äº›æ•°å­¦ç›¸å…³çš„ç®—æ³•ã€‚</p>
<h3 id="å¤šé¡¹å¼"><a href="#å¤šé¡¹å¼" class="headerlink" title="å¤šé¡¹å¼"></a>å¤šé¡¹å¼</h3><h4 id="FFT-å¤šé¡¹å¼ä¹˜æ³•"><a href="#FFT-å¤šé¡¹å¼ä¹˜æ³•" class="headerlink" title="FFT å¤šé¡¹å¼ä¹˜æ³•"></a>FFT å¤šé¡¹å¼ä¹˜æ³•</h4><p><del>æœ€å¼€å§‹å­¦è¿™ç©æ„çš„æ—¶å€™æ„Ÿè§‰éå¸¸è¿·ï¼Œåé¢æ•°å­¦æ°´å¹³ä¸Šå»äº†å…¶å®ä¹Ÿä¸éš¾ã€‚</del></p>
<p>å¤šé¡¹å¼æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œä¸€ç§æ˜¯ç³»æ•°æ³•ï¼Œå¦ä¸€ç§æ˜¯ç‚¹å€¼æ³•ï¼Œæ€»æ‰€å‘¨çŸ¥ $n$ ä¸ªä¸åŒç‚¹å”¯ä¸€ç¡®å®šä¸€ä¸ª $n-1$ æ¬¡å¤šé¡¹å¼ã€‚</p>
<p>åŸç†ï¼šå¤šé¡¹å¼çš„ä¸¤ä¸ªç³»æ•°è¡¨è¾¾å¼ç›¸ä¹˜æ˜¯ $O(n^2)$ çš„ï¼Œä½†æ˜¯å…¶ç‚¹å€¼è¡¨è¾¾å¼ç›¸ä¹˜å´æ˜¯  $O(n)$ çš„ï¼Œæ‰€ä»¥è€ƒè™‘å°†ç³»æ•°è¡¨è¾¾å¼è½¬æˆç‚¹å€¼è¡¨è¾¾å¼ç„¶åç›¸ä¹˜ã€‚</p>
<p>äº‹å®ä¸Šï¼Œç‚¹å€¼è¡¨è¾¾å¼å’Œç³»æ•°è¡¨è¾¾å¼çš„äº’ç›¸è½¬åŒ–ï¼Œå¦‚æœç‚¹å€¼å–ç‰¹æ®Šç‚¹ï¼Œå¯ä»¥åšåˆ° $O(n\log n)$ï¼Œå³ä½¿æ˜¯ä»»æ„ç‚¹ï¼Œå³å¤šé¡¹å¼å¤šç‚¹æ±‚å€¼å’Œå¤šé¡¹å¼å¤šç‚¹æ’å€¼ä¹Ÿå¯ä»¥åšåˆ° $O(n \log^2n)$</p>
<p>è®¾æœ€ç»ˆå¤šé¡¹å¼æ¬¡æ•°ä¸º $n-1$ï¼Œæˆ‘ä»¬è¿›è¡Œå¤šé¡¹å¼ä¹˜æ³•æ—¶é€‰æ‹©çš„ç‚¹å€¼å«å•ä½æ ¹ï¼Œå³ $x^n&#x3D;1$ åœ¨å¤æ•°åŸŸä¸Šçš„æ‰€æœ‰æ ¹ã€‚</p>
<p>è¿™ç©æ„æœ‰ä¸€äº›æ€§è´¨ï¼Œä¸è¿‡æˆ‘ä»¬å¾—å…ˆæŠŠæ¬¡æ•°å˜ä¸º $n&#x3D;2^k$ å½¢å¼ã€‚</p>
<p>æ— æ³•æƒ³è±¡å‘æ˜è¿™ä¸ªä¸œè¥¿çš„äººæ˜¯æ€ä¹ˆæƒ³åˆ°çš„ï¼Œå¯èƒ½è¿™å°±æ˜¯è¢«è®°åœ¨å†å²ä¹¦ä¸Šçš„äººçš„æ°´å¹³ã€‚</p>
<p><em>ä»¥ä¸‹å†…å®¹å¦‚æœå°†åæ ‡ç³»è§†ä¸ºæåæ ‡ç³»ä¼šæ›´å¥½ç†è§£</em><br>$$<br>W_n^i &#x3D; -W_n^{i+\frac{n}{2}}\<br>W_{\frac{n}{2}}^{i} &#x3D; W_{n}^{2i}\<br>$$<br>è€ƒè™‘è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹äºä¸€ä¸ªå¤šé¡¹å¼ $a_0+a_1x+a_2x^2 \cdots a_{n-1}x^{n-1}$ ï¼Œæˆ‘ä»¬éœ€è¦åŒæ—¶æ±‚å‡ºå®ƒåœ¨ $W_n^{0},W_n^{1}\cdots W_n^{n-1}$ å¤„çš„å–å€¼ã€‚å‘ç°ç”±äºç¬¬ä¸€ä¸ªæ€§è´¨ï¼Œè²Œä¼¼å¯ä»¥å·ä¸ªæ‡’ï¼Œå› ä¸ºå $\frac{n}{2}$ ä¸ªæ•°å°±æ˜¯å‰ $\frac{n}{2}$ ä¸ªæ•°çš„ç›¸åæ•°ã€‚</p>
<p>ç›¸åæ•°çš„æ€§è´¨ï¼Œå¥‡å˜å¶ä¸å˜ã€‚è€ƒè™‘å¯¹ç³»æ•°æŒ‰å¥‡å¶æ€§åˆ†ç±»ï¼Œå¼å­å˜æˆäº†è¿™ä¸ªæ ·å­ã€‚</p>
<p>$(a_0+a_2x^2+\cdots +a_{n-2}x^{n-2})+x(a_1+a_3x^2+\cdots + a_{n-1}x^{n-2})$</p>
<p>ç„¶åè€ƒè™‘å‰åä¸¤ä¸ªéƒ¨åˆ†ï¼Œéœ€è¦å¯¹ä»–ä»¬æ±‚ $x&#x3D;W_n^0,W_n^1\cdots W_n^{\frac{n}{2}-1}$ å¤„çš„å–å€¼ï¼Œæœ¬è´¨ä¸Šæ˜¯æ±‚ $x^2&#x3D;W_n^0,W_n^2\cdots W_n^{n-2}$ å¤„çš„å–å€¼ï¼Œç»“åˆç¬¬äºŒä¸ªæ€§è´¨ï¼Œwocï¼Œå°±æ˜¯ä¸¤ä¸ªå­é—®é¢˜ï¼Œè§£å†³ä¹‹åå°±å¯ä»¥ $O(n)$ å¾—åˆ°åŸé—®é¢˜çš„è§£ï¼Œè¾¹ç•Œæ˜¾ç„¶æ˜¯ $n&#x3D;1$ã€‚</p>
<p>å¤æ‚åº¦ $T(n)&#x3D;2T(\frac{n}{2}) + O(n) &#x3D; O(n\log n)$</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FFT</span><span class="params">(<span class="type">int</span> now,com *a,<span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(now==<span class="number">0</span>)</span><br><span class="line">	<span class="keyword">return</span>;</span><br><span class="line">	com a1[<span class="number">1</span>&lt;&lt;now],a2[<span class="number">1</span>&lt;&lt;now];</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;now;i+=<span class="number">2</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		a1[i/<span class="number">2</span>]=a[i];</span><br><span class="line">		a2[i/<span class="number">2</span>]=a[i+<span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">FFT</span>(now<span class="number">-1</span>,a1,op);</span><br><span class="line">	<span class="built_in">FFT</span>(now<span class="number">-1</span>,a2,op);</span><br><span class="line">	com w0=(com&#123;<span class="built_in">cos</span>(<span class="number">2.0</span>*Pi/(<span class="number">1</span>&lt;&lt;now)),op*<span class="built_in">sin</span>(<span class="number">2.0</span>*Pi/(<span class="number">1</span>&lt;&lt;now))&#125;),w=(com)&#123;<span class="number">1</span>,<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;now<span class="number">-1</span>;i++,w=w*w0)</span><br><span class="line">	&#123;</span><br><span class="line">		a[i]=a1[i]+w*a2[i];</span><br><span class="line">		a[i+(<span class="number">1</span>&lt;&lt;(now<span class="number">-1</span>))]=a1[i]-w*a2[i];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœé€’å½’çš„è¯ï¼Œå¸¸æ•°ä¼šæ¯”è¾ƒæ‹‰è·¨ã€‚å› ä¸ºé€’å½’å¿…ç„¶éœ€è¦å¤åˆ¶æ•°ç»„é‡æ–°å¼„æˆä¸€ä¸ªä¸‹æ ‡ $1-n$ çš„é—®é¢˜ï¼Œæ— è®ºç”¨ä»€ä¹ˆåŠæ³•è§£å†³ï¼Œä½ çš„é«˜é€Ÿç¼“å­˜éƒ½ä¼šè¡¨ç¤ºæ„è§å¾ˆå¤§ï¼Œæ‰€ä»¥è€ƒè™‘è¿­ä»£å†™æ³•ã€‚</p>
<p>æœ¬è´¨ä¸Šé€’å½’æ˜¯ä¸€å±‚ä¸€å±‚åˆå¹¶äº†ä¸¤ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆèƒ½ä¸èƒ½ç›´æ¥æ¨¡æ‹Ÿè¿™ä¸ªåˆå¹¶çš„è¿‡ç¨‹å‘¢ï¼Œç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚</p>
<p>è§‚å¯Ÿå‘ç°æœ¬è´¨ä¸Šæ˜¯å°†ä¸‹æ ‡äºŒè¿›åˆ¶ <code>reverse</code> ä¹‹åé€å±‚åˆå¹¶çš„ï¼Œæˆ‘ä»¬ä¹Ÿè¿™ä¹ˆåšå°±è¡Œã€‚</p>
<p>æ±‚ <code>reverse</code> å¯ä»¥ $O(n)$ï¼Œå¦‚ä¸‹ï¼ˆå¦‚æœä½ ä¸äº†è§£è¿ç®—é¡ºåºï¼Œè¯·è€è€å®å®æ‰“æ‹¬å·ï¼‰</p>
<p>è¿™ä¸ªåŸç†å¾ˆç®€å•ï¼Œä¸çœ‹æœ€åä¸€ä½ï¼Œå…¶å®ƒä½å…ˆ <code>reverse</code>ï¼Œç„¶åå¤„ç†ä¸€ä¸‹æœ€åä¸€ä½å°±è¡Œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;<span class="number">1</span>&lt;&lt;lim;i++)res[i]=res[i&gt;&gt;<span class="number">1</span>]&gt;&gt;<span class="number">1</span>|(i&amp;<span class="number">1</span>)&lt;&lt;<span class="number">1</span>-lim;</span><br></pre></td></tr></table></figure>

<p>ä¸‹é¢æ˜¯è¿­ä»£å†™æ³•ä»£ç ï¼Œæœ¬è´¨æ˜¯æ¨¡æ‹Ÿäº†é€’å½’åˆå¹¶çš„è¿‡ç¨‹ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">FFT</span><span class="params">(com a[],com b[],<span class="type">int</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;maxn;i++)</span><br><span class="line">    <span class="keyword">if</span>(r[i]&gt;i)<span class="built_in">swap</span>(a[r[i]],a[i]),<span class="built_in">swap</span>(b[r[i]],b[i]);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=maxn;i++)&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">1</span>&lt;&lt;maxn;j+=<span class="number">1</span>&lt;&lt;i)&#123;</span><br><span class="line">			com w0=(com)&#123;<span class="built_in">cos</span>(<span class="number">2.0</span>*Pi/(<span class="number">1</span>&lt;&lt;i)),op*<span class="built_in">sin</span>(<span class="number">2.0</span>*Pi/(<span class="number">1</span>&lt;&lt;i))&#125;,w=(com)&#123;<span class="number">1</span>,<span class="number">0</span>&#125;;</span><br><span class="line">			<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>;k++,w=w*w0)&#123;</span><br><span class="line">				com x=a[j+k],y=a[j+k+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)]*w;</span><br><span class="line">				a[j+k]=x+y;</span><br><span class="line">				a[j+k+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)]=x-y;</span><br><span class="line">                </span><br><span class="line">				x=b[j+k],y=b[j+k+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)]*w;</span><br><span class="line">				b[j+k]=x+y;</span><br><span class="line">				b[j+k+(<span class="number">1</span>&lt;&lt;i<span class="number">-1</span>)]=x-y;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æå®Œäº†ç³»æ•°è½¬ç‚¹å€¼ï¼Œæ¥ä¸‹æ¥æ˜¯ç‚¹å€¼è½¬ç³»æ•°ã€‚</p>
<p>å‰äººå‘Šè¯‰æˆ‘ä»¬åªéœ€è¦å°†å•ä½æ ¹æ”¹ä¸º $W_n^{0},W_n^{-1}\cdots W_n^{-n+1}$ï¼Œå†åšä¸€éç³»æ•°è½¬ç‚¹å€¼çš„è¿‡ç¨‹å°±å¯ä»¥å¾—åˆ°ç³»æ•°ï¼Œä½†æ˜¯ç³»æ•°ä¼šå˜æˆåŸæ¥çš„ $n$ å€ï¼Œé™¤æ‰å°±è¡Œã€‚</p>
<p>ç»™å‡ºç®€è¦è¯æ˜ï¼Œ$i$ æ¬¡é¡¹çš„ç³»æ•°ä¸º $a_i$ï¼Œè½¬ä¸€æ¬¡ç‚¹å€¼</p>
<p>ä¹‹åå˜ä¸º $b_i$ï¼Œå†åšä¸€æ¬¡å˜æˆ $c_i$<br>$$<br>\begin{eqnarray}<br>c_x &amp;&#x3D;&amp; \sum\limits_{i&#x3D;0}^{n-1}b_iW_n^{-ix} \<br> &amp;&#x3D;&amp; \sum\limits_{i&#x3D;0}^{n-1} W_n^{-ix}\sum\limits_{j&#x3D;0}^{n-1}a_jW_n^{ij}\<br> &amp;&#x3D;&amp; \sum\limits_{i&#x3D;0}^{n-1} \sum\limits_{j&#x3D;0}^{n-1}a_jW_n^{i(j-x)}\<br>\end{eqnarray}<br>$$<br>å¯¹äº $j&#x3D;x$ï¼Œè´¡çŒ®æ˜¾ç„¶ä¸º $\sum\limits_{i&#x3D;0}^{n-1}a_xW_n^{i\times0} &#x3D; na_x$</p>
<p>å¯¹äº $j\neq x$ è´¡çŒ®ä¸º $a_j \sum\limits_{i&#x3D;0}^{n-1}(W_n^{j-x})^{i}$</p>
<p>å¯¹è¿™ä¸ªå¼å­çš„æ±‚å’Œç”¨ç­‰æ¯”æ•°åˆ—æ±‚å’Œå…¬å¼æœ‰è´¡çŒ®ä¸º $\dfrac{W_n^{n(j-x)}-1}{W_n^{j-x}-1}$</p>
<p>æ˜¾ç„¶åˆ†å­ä¸º $0$ï¼Œåˆ†æ¯ä¸ä¸º $0$ï¼Œæ‰€ä»¥è´¡çŒ®æ˜¯ $0$ï¼Œæ‰€ä»¥ç»“æœå°±æ˜¯ $na_x$</p>
<p>æå®šã€‚</p>
<h4 id="NTT-å¤šé¡¹å¼ä¹˜æ³•"><a href="#NTT-å¤šé¡¹å¼ä¹˜æ³•" class="headerlink" title="NTT å¤šé¡¹å¼ä¹˜æ³•"></a>NTT å¤šé¡¹å¼ä¹˜æ³•</h4><p>FFT å¤šé¡¹å¼ä¹˜æ³•æ˜¯ç”±ç¼ºé™·çš„ï¼Œç”±äºæµ®ç‚¹æ•°ç²¾åº¦å’Œè¿ç®—é€Ÿåº¦é—®é¢˜ï¼ŒFFT å¯èƒ½å¹¶ä¸èƒ½å¾ˆå¥½çš„è§£å†³ä¸€äº›é—®é¢˜ï¼Œæ‰€ä»¥å¼•å…¥äº† NTTï¼ŒNTT ä»æœ‰é™æ•´æ•°åŸŸä¸­æ‰¾åˆ°äº†è¿™æ ·ä¸€ç»„å…·æœ‰åŒæ ·ä¼˜ç§€æ€§è´¨çš„ $W_n$ï¼Œå³ $g$ï¼Œä¹Ÿå°±æ˜¯åŸæ ¹ã€‚</p>
<p>åŸæ ¹çš„å†…å®¹å¯ä»¥å‚è€ƒæ•°å­¦è¯æ˜æ€»ç»“ä¸­çš„ä»‹ç»ã€‚</p>
<p><strong>æ³¨æ„ï¼Œå’Œ FFT ä¸€æ ·ï¼ŒNTT ä¹Ÿéœ€è¦ä¸¥æ ¼çš„æŒ‰ç…§ $2^k$ å–æ¬¡æ•°ï¼Œå› ä¸ºæˆ‘ä»¬åˆ©ç”¨äº† $W_n^{2i} &#x3D; W_{\frac{n}{2}}^{i}$ è¿™ä¸€é‡è¦æ€§è´¨</strong> </p>
<p>æ‰€ä»¥èƒ½å–å‡ºè¾ƒå¤§çš„ $2^k$ ä½œä¸ºé˜¶çš„è´¨æ•°æ‰å¯ä»¥ä½œä¸º NTT çš„æ¨¡æ•°ï¼Œå¸¸è§çš„ NTT æ¨¡æ•°æ˜¯ $998244353&#x3D;2^{23}\times 7\times 17 +1$ ï¼Œæˆ‘ä»¬å¯ä»¥å–å®ƒçš„åŸæ ¹ $g&#x3D;3$ ä½œä¸ºåŸºæœ¬å•ä½æ ¹å¸¦å…¥ï¼Œå®é™…ä¸Šå¦‚æœè¦æ‰¾åˆ°ä¸€ä¸ªåº”ç”¨äº $n$ çš„å•ä½æ ¹ $W_n$ï¼Œéœ€è¦å– $W_n&#x3D;g^{\frac{p-1}{n}}$ã€‚è¿™æ ·å®ƒå°±æ»¡è¶³äº†æˆ‘ä»¬åœ¨ FFT è¯æ˜ä¸­ç”¨åˆ°çš„ä¸€åˆ‡æ€§è´¨ã€‚</p>
<p>ç„¶åç…§ç€ FFT æ‰“ä¸€éå°±è¡Œï¼Œåªæ˜¯åŸºæœ¬è¿ç®—è¿™äº›æ¢ä¸ºæ¨¡ $p$ æ„ä¹‰ä¸‹çš„è¿ç®—å°±è¡Œã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">NTT</span><span class="params">(<span class="type">int</span> *a,<span class="type">int</span> type)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">1</span>&lt;&lt;s;i++)</span><br><span class="line">	<span class="keyword">if</span>(rk[i]&gt;i)<span class="built_in">swap</span>(a[rk[i]],a[i]);</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> len=<span class="number">1</span>;len&lt;=s;len++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> w=<span class="number">1</span>,wn=<span class="built_in">quick</span>(g,mod<span class="number">-1</span>&gt;&gt;len);</span><br><span class="line">		<span class="keyword">if</span>(type==<span class="number">-1</span>)wn=<span class="built_in">quick</span>(wn,mod<span class="number">-2</span>);</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j+(<span class="number">1</span>&lt;&lt;len)&lt;=<span class="number">1</span>&lt;&lt;s;j+=<span class="number">1</span>&lt;&lt;len,w=<span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span>(k=j;k&lt;j+(<span class="number">1</span>&lt;&lt;len<span class="number">-1</span>);k++,w=<span class="number">1ll</span>*w*wn%mod)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="type">int</span> x=a[k],y=a[k+(<span class="number">1</span>&lt;&lt;len<span class="number">-1</span>)];</span><br><span class="line">				a[k]=(x+<span class="number">1ll</span>*w*y%mod)%mod,a[k+(<span class="number">1</span>&lt;&lt;len<span class="number">-1</span>)]=(x<span class="number">-1ll</span>*w*y%mod)%mod;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å…¶å®ƒå¤šé¡¹å¼ä¹˜æ³•å’Œä¸€äº›ä¼˜åŒ–"><a href="#å…¶å®ƒå¤šé¡¹å¼ä¹˜æ³•å’Œä¸€äº›ä¼˜åŒ–" class="headerlink" title="å…¶å®ƒå¤šé¡¹å¼ä¹˜æ³•å’Œä¸€äº›ä¼˜åŒ–"></a>å…¶å®ƒå¤šé¡¹å¼ä¹˜æ³•å’Œä¸€äº›ä¼˜åŒ–</h4><p>FFT ä¸‰æ¬¡å˜ä¸¤æ¬¡ï¼ŒæŠŠ $b$ æ‰”åˆ° $a$ çš„è™šéƒ¨å»ï¼Œå˜æˆäº† $A(x) &#x3D; (a_0+b_0i) + (a_1+b_1i)x+ \cdots + (a_{n-1}+b_{n-1}i)x^{n-1}$</p>
<p>ç„¶åæ±‚ $A^2(x)$ï¼Œå¾—åˆ°çš„ç³»æ•°è¡¨è¾¾å¼çš„è™šéƒ¨å°±æ˜¯ $2ab$ã€‚</p>
<p>ä¼šæ¯” NTT ç•¥å¿«ã€‚</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
        <category>æ•°å­¦</category>
      </categories>
      <tags>
        <tag>æ•°å­¦</tag>
      </tags>
  </entry>
  <entry>
    <title>æ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿå­¦ä¹ ç¬”è®°</title>
    <url>/2022/07/12/%E6%B7%B1%E5%85%A5%E7%90%86%E8%A7%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</url>
    <content><![CDATA[<h3 id="C-è¯­è¨€ç¼–è¯‘è¿‡ç¨‹"><a href="#C-è¯­è¨€ç¼–è¯‘è¿‡ç¨‹" class="headerlink" title="C è¯­è¨€ç¼–è¯‘è¿‡ç¨‹"></a>C è¯­è¨€ç¼–è¯‘è¿‡ç¨‹</h3><ul>
<li>æºæ–‡æœ¬â€”â€”-é¢„å¤„ç†ï¼Œå¤„ç† define,include ç­‰</li>
<li>é¢„å¤„ç†æ–‡æœ¬â€”â€”â€“ç¼–è¯‘</li>
<li>æ±‡ç¼–æ–‡æœ¬â€”â€”â€”-æ±‡ç¼–å¾—åˆ°äºŒè¿›åˆ¶æ–‡ä»¶ .o</li>
<li>ç›®æ ‡æ ¼å¼â€”â€”â€”-é“¾æ¥</li>
<li>å¯æ‰§è¡Œæ–‡ä»¶</li>
</ul>
<h3 id="äºŒè¿›åˆ¶è¡¥ç åŸç†å’Œ-C-è¯­è¨€å¤„ç†ç±»å‹è½¬æ¢"><a href="#äºŒè¿›åˆ¶è¡¥ç åŸç†å’Œ-C-è¯­è¨€å¤„ç†ç±»å‹è½¬æ¢" class="headerlink" title="äºŒè¿›åˆ¶è¡¥ç åŸç†å’Œ C è¯­è¨€å¤„ç†ç±»å‹è½¬æ¢"></a>äºŒè¿›åˆ¶è¡¥ç åŸç†å’Œ C è¯­è¨€å¤„ç†ç±»å‹è½¬æ¢</h3><ul>
<li>äºŒè¿›åˆ¶è¡¥ç æœ€é«˜ä½æœ¬è´¨æ˜¯ä¸€ä¸ª $-2^x$</li>
<li>åŒæ—¶å¤„ç†æœ‰ç¬¦å·å’Œæ— ç¬¦å·æ•´æ•°æ¯”è¾ƒæ—¶æˆ–è€…è¿›è¡Œå…¶å®ƒäºŒå…ƒè¿ç®—æ—¶ï¼ŒC è¯­è¨€ä¼šé»˜è®¤æ— ç¬¦å·ä¸”å‡ä¸ºæ­£æ•°ã€‚</li>
<li>ç¼–è¯‘å™¨å¤„ç†ä¸€ä¸ª <code>-x</code> çš„è¡¨è¾¾å¼æ—¶ï¼Œä¼šå…ˆè¯» <code>x</code> ç„¶åå–åï¼Œæ‰€ä»¥ <code>-2147483648</code> æ˜¯ä¸åˆæ³•çš„ï¼Œåº”è¯¥å†™ä¸º <code>-2147483647-1</code></li>
</ul>
<h3 id="ç®€å•çš„æ±‡ç¼–è¯­è¨€"><a href="#ç®€å•çš„æ±‡ç¼–è¯­è¨€" class="headerlink" title="ç®€å•çš„æ±‡ç¼–è¯­è¨€"></a>ç®€å•çš„æ±‡ç¼–è¯­è¨€</h3><ul>
<li><p>æ“ä½œç³»ç»Ÿå°†ç‰©ç†å†…å­˜æŠ½è±¡ä¸ºäº†ä¸€ä¸ªä¸€ç»´æ•°ç»„ï¼Œæ‰€æœ‰æ±‡ç¼–å±‚é¢çš„æ“ä½œå‡åœ¨ä¸€ç»´æ•°ç»„å†…è¿›è¡Œ</p>
</li>
<li><p>æ¯ä¸€æ¡æ±‡ç¼–æŒ‡ä»¤éƒ½å¯ä»¥è¢«æè¿°ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼ŒæŒ‡ä»¤å’Œæ“ä½œå¯¹è±¡ï¼Œè¿™ä¸¤éƒ¨åˆ†çš„<strong>æ•´ä½“</strong>å¯ä»¥è¢«ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚æè¿°ï¼Œæ­¤è§„åˆ™æœ¬è´¨ä¸Šæ˜¯ä¸€é¢—å“ˆå¤«æ›¼æ ‘ã€‚</p>
</li>
<li><p>ä¸€ä¸ªç¨‹åºçš„æ±‡ç¼–æŒ‡ä»¤ä¼šè¢«ä¿å­˜åœ¨ä¸»å­˜ä¸Šï¼Œæœ‰ä¸€ä¸ªç¨‹åºè®¡æ•°å™¨ <code>epi</code> æŒ‡å‡ºå½“å‰æ‰§è¡Œåˆ°çš„åœ°æ–¹ã€‚</p>
</li>
<li><p>å¸¸ç”¨å¯„å­˜å™¨åæœ‰ <code>eax,ecx,edx,ebx,esi,edi,esp,ebp</code>ã€‚å‰ä¸‰è€…çš„æ•°æ®ç”±å½“å‰ç¨‹åºä¿å­˜åœ¨æ ˆä¸­ï¼Œåä¸‰è€…çš„å€¼ç”±ä¸‹çº§ç¨‹åºä¿å­˜ï¼Œæœ€åäºŒè€…ä¸ºå¸§æŒ‡é’ˆå’Œæ ˆæŒ‡é’ˆï¼Œä¸€èˆ¬ä¸ä½¿ç”¨ã€‚å‰å››ä¸ªå¯„å­˜å™¨å¯ä»¥é€šè¿‡ <code>ah,al,ax</code> ç­‰å½¢å¼è®¿é—®ä½äºŒå­—èŠ‚å’Œä½ä¸€å­—ï¼Œä½†éƒ½å¯ä»¥ç”¨ <code>di</code> å½¢å¼è®¿é—®ä½ä¸€å­—ã€‚ </p>
</li>
<li><p>ä¼ é€æŒ‡ä»¤åˆ†ä¸ºä¸‰ç§ <code>movb movw movl</code> åˆ†åˆ«è¡¨ç¤ºå­—èŠ‚ï¼Œå­—å’ŒåŒå­—ã€‚ä¼ é€å¯¹åº”ç±»å‹æ—¶ï¼Œåº”è¯¥ä½¿ç”¨å¯¹åº”çš„å¯„å­˜å™¨ä½ç½®ã€‚ <code>push,pop</code> æŒ‡ä»¤ä¸ºå‹æ ˆå’Œå¼¹æ ˆï¼Œæœ¬è´¨ä¸Šæ˜¯æ“ä½œäº†ä¸»å­˜å’Œæ ˆæŒ‡é’ˆã€‚</p>
</li>
<li><p><code>lea</code> æŒ‡ä»¤å¯ä»¥å¿«é€Ÿè®¡ç®— <code>a+b*(1,2,4,8)+c</code> ï¼Œ<code>a</code> å¿…é¡»ä¸ºå¸¸é‡ï¼Œ<code>b,c</code> å¿…é¡»ä¸ºå¯„å­˜å™¨ä¸­çš„æ•°ã€‚</p>
</li>
<li><p>æ“ä½œæ•°åˆ†ä¸ºä¸‰ç±»ï¼Œä¸€ç±»æ˜¯ç«‹å³æ•°ï¼Œä¸€ç±»æ˜¯å¯„å­˜å™¨ï¼Œä¸€ç±»æ˜¯ä¸»å­˜æ•°æ®ï¼Œè®¿é—®æ ¼å¼å¦‚ä¸‹ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">$imm //ç«‹å³æ•° imm</span><br><span class="line">eg. $0x3f</span><br><span class="line"></span><br><span class="line">E	//å¯„å­˜å™¨ E</span><br><span class="line">eg. eax</span><br><span class="line"></span><br><span class="line">Imm(e1,e2,s) //ä¸»å­˜ä¸Š Imm+e1+e2*s ä½ç½®ä¸Šçš„æ•°æ®ï¼ŒImm å¯ä»¥ç¼ºçœï¼ŒåäºŒè€…å¯ä»¥ç¼ºçœï¼Œe1 ç¼ºçœæ—¶ä¸èƒ½çœç•¥ &#x27;,&#x27;</span><br><span class="line">eg. 0x3f(eax,ebx,4)</span><br><span class="line">eg. (eax)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>ç”¨ <code>test</code> å’Œ <code>cmp</code> æŒ‡ä»¤æ¥æ§æŒ‡æ¡ä»¶ï¼Œæœ¬è´¨ä¸Šï¼Œå®ƒä»¬æ”¹å˜äº†æ¡ä»¶å¯„å­˜å™¨å†…çš„å€¼ï¼Œ<code>test x x</code> ç­‰ä»·äº <code>cmp 0 x</code>ã€‚æ‰§è¡Œ <code>cmp</code> åï¼Œ<code>jl</code> ç­‰æ¡ä»¶è·³è½¬è¯­å¥ä¼šåœ¨ <code>cmp</code> æˆç«‹æ—¶æ‰§è¡Œï¼Œ<code>jl</code> è¡¨ç¤ºå°äºæ—¶è·³è½¬ï¼Œ<code>cmp x y</code> å¯ä»¥çœ‹ä½œæ˜¯ <code>y&lt;x</code> æ—¶æ‰§è¡Œ <code>jl</code></p>
</li>
<li><p><code>call</code> æŒ‡ä»¤ä¼šå°†è¿”å›åœ°å€ (call) è¯­å¥åé‚£æ¡è¯­å¥çš„åœ°å€å…¥æ ˆåè·³è½¬åˆ°å‡½æ•°æ‰€åœ¨ä½ç½®ã€‚<code>ret</code> æŒ‡ä»¤åˆ©ç”¨è¿”å›åœ°å€è·³è½¬å›å»ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œç”¨ <code>eax</code> ä¿å­˜è¿”å›å†…å®¹ã€‚</p>
</li>
<li><p>ç”±äºç¨‹åºå¯„å­˜å™¨ä¸­çš„æŸäº›å€¼ä¼šè¢«ç¼“å­˜åˆ°ä¸»å­˜ä¸­ï¼Œæ‰€ä»¥ä½¿ç”¨ <code>gets</code> ç­‰ä¸å®‰å…¨å‡½æ•°è¯»å–æ—¶ï¼Œå¦‚æœè¯»å–çš„å†…å®¹è¿‡é•¿è¶…å‡ºäº†ä¸ºæ­¤ç¼“å­˜åŒºåˆ†åˆ«çš„å­—èŠ‚åï¼Œä¼šæ±¡æŸ“ä¸€äº›<strong>å…ˆå‰è¢«å­˜å‚¨åœ¨ä¸»å­˜ä¸­çš„å¯„å­˜å™¨å€¼</strong>ï¼Œå› ä¸ºè¶…å‡ºåˆ†é…çš„å†…å­˜åï¼Œä¼šå†™åœ¨å¤–é¢ï¼Œé€šè¿‡è¿™æ ·çš„æ“ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å˜ä¸€äº›ç³»ç»Ÿå¯„å­˜å™¨çš„å€¼ï¼Œè®©ç¨‹åºè·³è½¬æ‰§è¡Œä¸€äº›æˆ‘ä»¬å¸Œæœ›è®©å®ƒæ‰§è¡Œçš„ä»£ç ï¼ˆè¿™æ ·çš„ä»£ç é€šå¸¸è¢«å†™åœ¨æˆ‘ä»¬çš„è¾“å…¥é‡Œï¼‰ï¼Œè¿™å°±æ˜¯ç¼“å†²åŒºæ”»å‡»ï¼Œé€šå¸¸æ“ä½œæ˜¯æ”¹å˜ <code>ebp</code> çš„å€¼ä½¿å¾— <code>ret</code> æ“ä½œè·³åˆ°æˆ‘ä»¬å¸Œæœ›çš„åœ°æ–¹ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>è®¡ç®—æœº</category>
        <category>ç³»ç»Ÿ</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºç³»ç»Ÿ</tag>
        <tag>å­¦ä¹ ç¬”è®°</tag>
      </tags>
  </entry>
  <entry>
    <title>ç½‘ç»œæµç›¸å…³</title>
    <url>/2022/07/12/%E7%BD%91%E7%BB%9C%E6%B5%81%E7%9B%B8%E5%85%B3/</url>
    <content><![CDATA[<h2 id="ç½‘ç»œæµ"><a href="#ç½‘ç»œæµ" class="headerlink" title="ç½‘ç»œæµ"></a>ç½‘ç»œæµ</h2><p>å†…å®¹ä¸»è¦ä¸ºè‡ªå·±å¯¹ç½‘ç»œæµçš„ä¸€äº›ç†è§£å’Œä¸€äº›å…¸ä¾‹ã€‚</p>
<h3 id="ä¸€äº›çº¦å®šï¼š"><a href="#ä¸€äº›çº¦å®šï¼š" class="headerlink" title="ä¸€äº›çº¦å®šï¼š"></a>ä¸€äº›çº¦å®šï¼š</h3><ul>
<li>s ä¸ºæºç‚¹ï¼Œt ä¸ºæ±‡ç‚¹</li>
<li>å¯¹äºé›†åˆ $S,T,T\subseteq S$ï¼Œçº¦å®š $S-T$ ä¸ºä» $S$ ä¸­åˆ æ‰ $T$ ä¸­æ¯ä¸ªå…ƒç´ ä¹‹åçš„é›†åˆ</li>
<li>ç½‘ç»œæµå›¾ä¸º $G&#x3D;(V,E)$ï¼Œè¾¹ $(u,v)$ å®¹é‡è®°ä¸º $c_{u,v}$</li>
</ul>
<h3 id="æœ€å¤§æµæœ€å°å‰²å®šç†å’Œå¢å¹¿è·¯å®šç†"><a href="#æœ€å¤§æµæœ€å°å‰²å®šç†å’Œå¢å¹¿è·¯å®šç†" class="headerlink" title="æœ€å¤§æµæœ€å°å‰²å®šç†å’Œå¢å¹¿è·¯å®šç†"></a>æœ€å¤§æµæœ€å°å‰²å®šç†å’Œå¢å¹¿è·¯å®šç†</h3><p>è¿™ä¸¤ä¸ªå®šç†æ˜¯ç½‘ç»œæµé—®é¢˜çš„æ ¸å¿ƒå®šç†ã€‚</p>
<h4 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h4><p>æœ€å¤§æµ &#x3D; æœ€å°å‰²ã€‚</p>
<p>æ®‹é‡ç½‘ç»œä¸­ä¸å­˜åœ¨å¢å¹¿è·¯æ˜¯å½“å‰æµä¸ºæœ€å¤§æµçš„å……è¦æ¡ä»¶ã€‚</p>
<h4 id="è¯æ˜"><a href="#è¯æ˜" class="headerlink" title="è¯æ˜"></a>è¯æ˜</h4><p>è‹¥å½“å‰æµä¸ºæœ€å¤§æµï¼Œæ˜¾ç„¶ä¸å­˜åœ¨å¢å¹¿è·¯ã€‚</p>
<p>è‹¥å½“å‰æµç­‰äºæŸä¸ªå‰²ï¼Œæ˜¾ç„¶å½“å‰æµä¸ºæœ€å¤§æµï¼Œä¸”è¯¥å‰²ä¸ºæœ€å°å‰²ã€‚</p>
<p>è‹¥ä¸å­˜åœ¨å¢å¹¿è·¯ï¼Œæˆ‘ä»¬å°è¯•è¯æ˜å½“å‰æµç­‰äºä¸€ä¸ªå‰²ã€‚</p>
<p>ä»¤ $S&#x3D;{v,\exist\ p_{s,v}}$ï¼Œ$S$ å³ $s$ åœ¨æ®‹é‡ç½‘ç»œä¸­èƒ½åˆ°è¾¾çš„ç‚¹çš„é›†åˆã€‚ä»¤ $T&#x3D;V-S$ã€‚æ˜¾ç„¶ $(S,T)$ æ˜¯ä¸€ä¸ªå‰²ï¼Œå¯¹äºå½“å‰æ®‹é‡ç½‘ç»œ $Gâ€™&#x3D;(V,Eâ€™)$ï¼Œä¸€å®šæœ‰ $\forall x \in S,\forall y\in T$ï¼Œè¾¹ $(x,y)$ æ»¡æµï¼Œå¦åˆ™ $y\in S$ã€‚å®¹æ˜“è¯æ˜å½“å‰æµæ°å¥½ä¸º $S$ åˆ° $T$ çš„æ‰€æœ‰è¾¹çš„å®¹é‡å’Œï¼Œä¹Ÿå°±æ˜¯å‰²çš„å¤§å°ã€‚å› ä¸º $S$ åˆ° $T$ æ‰€æœ‰çš„æ­£å‘è¾¹æµé‡ä¸ºå®¹é‡ï¼Œåå‘è¾¹æµé‡ä¸º $0$ï¼Œæ‰€ä»¥æµé‡ä¸ºæ­£å‘è¾¹å®¹é‡å’Œã€‚  </p>
<h3 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h3><h4 id="Dinic"><a href="#Dinic" class="headerlink" title="Dinic"></a>Dinic</h4><p>è€ƒè™‘å¯¹æ®‹é‡ç½‘ç»œ bfs åˆ†å±‚ï¼Œå¼ºåˆ¶æµé‡åªèƒ½æµå‘ä¸‹ä¸€å±‚ï¼Œå†è¿›è¡Œä¸€æ¬¡ dfsï¼Œæ±‚é™åˆ¶ä¸‹æ‰€æœ‰çš„å¢å¹¿è·¯ï¼Œæå®šã€‚</p>
<p>å¤æ‚åº¦ $O(n^2m)$</p>
<p>æ¯æ¬¡å¢å¹¿å¤æ‚åº¦ä¸º $O(nm)$ï¼Œå…±è®¡å¢å¹¿ $n$ æ¬¡ï¼Œå› ä¸ºæ¯æ¬¡å¢å¹¿éƒ½ä¼šè®© $dep[t]$ å¢åŠ  1ã€‚</p>
<p>æ¯æ¬¡å¢å¹¿çš„å¤æ‚åº¦ä¸æ˜¯å¾ˆå¥½è¯ï¼Œä½†åŠ äº†å½“å‰å¼§ä¼˜åŒ–å…¶å®å°±å¾ˆæ¾ã€‚</p>
<p>ä»£ç è®°åœ¨è„‘å­é‡Œäº†ï¼Œä¸æ”¾äº†ã€‚</p>
<h4 id="ISAP"><a href="#ISAP" class="headerlink" title="ISAP"></a>ISAP</h4><p>å’•å’•å’•</p>
<h4 id="HLPP"><a href="#HLPP" class="headerlink" title="HLPP"></a>HLPP</h4><p>å’•å’•å’•</p>
<h3 id="è´¹ç”¨æµç›¸å…³"><a href="#è´¹ç”¨æµç›¸å…³" class="headerlink" title="è´¹ç”¨æµç›¸å…³"></a>è´¹ç”¨æµç›¸å…³</h3><p>ä¸€èˆ¬æŒ‡æœ€å°è´¹ç”¨æœ€å¤§æµï¼Œæš‚æ—¶æ²¡å•¥æ„Ÿè§‰ï¼Œä¸å†™ã€‚</p>
<h2 id="æœ€å°å‰²"><a href="#æœ€å°å‰²" class="headerlink" title="æœ€å°å‰²"></a>æœ€å°å‰²</h2><p>éå¸¸å¸¸è§çš„ä¸€ä¸ªç½‘ç»œæµæ¨¡å‹åº”ç”¨ã€‚</p>
<h3 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h3><p>é€šè¿‡æ„é€ ä¸€ä¸ªå›¾çš„å‰²åˆ°å†³ç­–æ–¹æ¡ˆçš„æ˜ å°„ï¼Œå…¶ä¸­å†³ç­–å¿…é¡»å¯æ‹†åˆ†è®¡ç®—ï¼Œæ±‚å‡ºæœ€å°çš„ä»£ä»·ï¼Œä¸€èˆ¬æ¥è¯´å†³ç­–çš„é™åˆ¶å¦‚æœæ¯”è¾ƒå¥‡æ€ªå°±åº”è¯¥è€ƒè™‘æœ€å°å‰²ã€‚</p>
<p>å¸¸ç”¨äºè§„åˆ’ $0&#x2F;1$ ç‹¬ç«‹è´¡çŒ®å†³ç­–é—®é¢˜ã€‚</p>
<h3 id="é€‚ç”¨æ¡ä»¶"><a href="#é€‚ç”¨æ¡ä»¶" class="headerlink" title="é€‚ç”¨æ¡ä»¶"></a>é€‚ç”¨æ¡ä»¶</h3><ul>
<li>ä¸èƒ½å­˜åœ¨è´Ÿå®¹é‡è¾¹æƒï¼Œæˆ‘ä¸çŸ¥é“æœ‰æ²¡æœ‰äººä¼šï¼Œåæ­£æˆ‘æ˜¯ä¸ä¼šã€‚</li>
</ul>
<h3 id="1-æœ€å¤§é—­åˆæƒå­å›¾é—®é¢˜"><a href="#1-æœ€å¤§é—­åˆæƒå­å›¾é—®é¢˜" class="headerlink" title="1.æœ€å¤§é—­åˆæƒå­å›¾é—®é¢˜"></a>1.æœ€å¤§é—­åˆæƒå­å›¾é—®é¢˜</h3><p>ç»™å®šä¸€å¼ æœ‰å‘å›¾ï¼Œç‚¹å¸¦æƒï¼ˆæƒå¯ä»¥ä¸ºè´Ÿï¼‰ï¼Œé€‰ä¸€ä¸ªå­å›¾å‡ºæ¥ï¼Œè¦æ±‚å¦‚æœ $u$ é€‰äº†é‚£å¦‚æœå­˜åœ¨ $(u,v)$ï¼Œé‚£ $v$ ä¹Ÿè¦é€‰ã€‚æ±‚æœ€å¤§æƒå€¼å’Œã€‚</p>
<p>å†³ç­–è´¡çŒ®ç‹¬ç«‹ï¼Œå†³ç­–ç±»å‹ä¸º 0&#x2F;1ã€‚åº”è¯¥å¯ä»¥æœ€å°å‰²ã€‚ä»¤å‰²ä¸­ä¸ $s$ åŒé›†åˆçš„ç‚¹ä¸ºé€‰æ‹©çš„ç‚¹ï¼Œä¸ $t$ åŒä¸€ä¸ªé›†åˆçš„ç‚¹ä¸ºæœªé€‰æ‹©çš„ç‚¹ã€‚é‚£ä¹ˆæ¯ä¸ªç‚¹åº”è¯¥å’Œ $t$ è¿ä¸€æ¡æµé‡ä¸ºæƒå€¼çš„ç›¸åæ•°çš„è¾¹ï¼Œä»£è¡¨é€‰å®ƒçš„ä»£ä»·ï¼Œå†å¯¹äºæ¯æ¡ $(u,v)$ ä» $u$ å‘ $v$ è¿ä¸€æ¡ inf è¾¹,ä»£è¡¨é€‰äº† $u$ ä¸é€‰ $v$ çš„ä»£ä»·ã€‚è€ƒè™‘è¿™å¼ å›¾çš„ä¸€ä¸ªæœ€å°å‰²ï¼Œå®ƒå¿…ç„¶ä¸ä¼šåŒ…å« inf è¾¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬é€‰äº† $u$ åœ¨ $s$ ä¸­ä¸€å®šä¼šè®© $v$ åœ¨ $s$ ä¸­ï¼Œæ‰€ä»¥ä¸€å®šåˆæ³•ã€‚ç„¶åå‘ç°åŸé—®é¢˜çš„æ¯ä¸€ä¸ªç­”æ¡ˆéƒ½å¯ä»¥å’Œå›¾ä¸Šçš„ä¸€ä¸ªä¸å« inf è¾¹çš„å‰²ä¸€ä¸€å¯¹åº”ï¼Œæ•…æœ€å°å‰²å°±æ˜¯åŸé—®é¢˜çš„ç­”æ¡ˆçš„ç›¸åæ•°ã€‚</p>
<p>è¿™å¼ å›¾æœ‰è´Ÿæ•°ï¼Œä¸è¡Œï¼Œæ‰€ä»¥è€ƒè™‘å…ˆé»˜è®¤é€‰æ‰€æœ‰æ­£æ•°ã€‚é‚£ä¹ˆé€‰è´Ÿæ•°çš„ä»£ä»·ä¸ºç›¸åæ•°ï¼Œä¸é€‰æ­£æ•°çš„ä»£ä»·ä¸ºæœ¬èº«ã€‚</p>
<p>é‚£ä¹ˆåº”è¯¥ä» $s$ å‘æ­£æƒç‚¹è¿è¾¹ï¼Œä»è´Ÿæƒç‚¹å‘ $t$ è¿è¾¹ï¼Œæœ€åå¯¹äº $(u,v)$ ä» $u$ å‘ $v$ è¿ inf è¾¹å³å¯ã€‚</p>
]]></content>
      <categories>
        <category>ç®—æ³•</category>
        <category>ç½‘ç»œæµ</category>
      </categories>
      <tags>
        <tag>ç½‘ç»œæµ</tag>
      </tags>
  </entry>
  <entry>
    <title>åšé¢˜2</title>
    <url>/2022/07/12/%E5%81%9A%E9%A2%982/</url>
    <content><![CDATA[<h2 id="20220305"><a href="#20220305" class="headerlink" title="20220305"></a>20220305</h2><h3 id="ABC242F-äºŒé¡¹å¼åæ¼”çš„è¿›ä¸€æ­¥ç†è§£"><a href="#ABC242F-äºŒé¡¹å¼åæ¼”çš„è¿›ä¸€æ­¥ç†è§£" class="headerlink" title="ABC242F(äºŒé¡¹å¼åæ¼”çš„è¿›ä¸€æ­¥ç†è§£)"></a>ABC242F(äºŒé¡¹å¼åæ¼”çš„è¿›ä¸€æ­¥ç†è§£)</h3><h4 id="é¢˜æ„ï¼š"><a href="#é¢˜æ„ï¼š" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><p>ç»™å®šä¸€ä¸ª $n*m$ çš„çŸ©é˜µï¼Œéœ€è¦æ”¾ $a$ ä¸ªç™½å— $b$ ä¸ªé»‘å—ï¼Œè®©å®ƒä»¬äº’ä¸ä¾µçŠ¯ï¼Œ$n,m\leq 50$ã€‚</p>
<p>æœ€å¼€å§‹çœ‹åˆ°è¿™é“é¢˜ä»¥ä¸ºåˆè¦æŒ‘æˆ˜ $\text{npc}$ äº†ï¼Œä»”ç»†ä¸€çœ‹äº’ä¸ä¾µçŠ¯çš„å®šä¹‰ï¼Œæ˜¯ä¸èƒ½æ”¾åœ¨åŒä¸€è¡Œæˆ–åŒä¸€åˆ—ã€‚</p>
<h4 id="æ€è€ƒï¼š"><a href="#æ€è€ƒï¼š" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>å¾ˆæœ‰æ„æ€çš„å®¹æ–¥é¢˜ï¼Œè€ƒè™‘æšä¸¾ç™½è‰²å äº†å¤šå¤§çš„åœ°ç›˜ï¼Œè®¾ $f[i][j]$ è¡¨ç¤ºå…è®¸ç™½è‰²å ç”¨äº† $i$ è¡Œ $j$ åˆ—çš„æ–¹æ¡ˆæ•°ï¼Œç„¶åç»„åˆæ•°å®¹æ–¥ã€‚æˆ‘ä»¬å¯ä»¥è®¾ $g[i][j]$ ä¸ºç™½è‰²æ°å¥½å ç”¨  $i$  è¡Œ $j$ åˆ—çš„æ–¹æ¡ˆæ•°ï¼Œè€ƒè™‘åˆ—å‡ºäºŒé¡¹å¼åæ¼”çš„å¼å­ã€‚æ€è€ƒ $f,g$ çš„å…³ç³»ï¼Œè¿™æ˜¯ä¸€ç±»é«˜ç»´å®¹æ–¥é—®é¢˜ã€‚</p>
<p>ç»“è®ºå¦‚ä¸‹ï¼š<br>$$<br>g[i][j] &#x3D; f[i][j] - \sum\limits_{x\leq i,y\leq j,x+y \neq i+j } \tbinom{i}{x} \times \tbinom{j}{y} \times g[x][y]<br>$$<br>ç†è§£è¿™ä¸ªå¼å­ä¸éš¾ï¼Œå°±æ˜¯å‡å»æ°å¥½è¢«å ç”¨çš„éƒ¨åˆ†ï¼Œæ³¨æ„å®¹æ–¥ç³»æ•°ã€‚</p>
<p>æˆ‘ä»¬è€ƒè™‘èƒ½ä¸èƒ½ä¸ç”¨ $g$ å‚ä¸è¿™ä¸ªå¼å­ã€‚</p>
<p>å›æƒ³çº¿æ€§çš„äºŒé¡¹å¼åæ¼”é—®é¢˜ï¼Œæˆ‘ä»¬æœ‰å¼å­ï¼š<br>$$<br>f(n) &#x3D; \sum\limits_{i&#x3D;n}^{m} \tbinom{i}{n} \times g(i) 	\Leftrightarrow<br>g(n) &#x3D; \sum\limits_{i&#x3D;n}^{m} (-1)^{n-i}\times\tbinom{i}{n} \times f(i)<br>$$<br>å…¶ä¸­ $f(n)$ è¡¨ç¤ºé’¦å®šæ»¡è¶³ $n$ ä¸ªæ¡ä»¶çš„æ–¹æ¡ˆæ•°ã€‚$g(n)$ è¡¨ç¤ºæ°å¥½æ»¡è¶³ $n$ çš„æ¡ä»¶çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>å·¦è¾¹å¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯é’¦å®š $n$ ä¸ªæ¡ä»¶æ»¡è¶³çš„æ–¹æ¡ˆæ•°å°±æ˜¯ä»æ»¡è¶³ $i$ ä¸ªæ¡ä»¶çš„æ–¹æ¡ˆä¸­é€‰å‡º $n$ ä¸ªé’¦å®šæ»¡è¶³ã€‚</p>
<p>å³è¾¹å¯ä»¥ç¨å¾®å˜æ¢ä¸€ä¸‹ä»¥ä¾¿ç†è§£<br>$$<br>g(n) &#x3D; f(n)  - \sum\limits_{i&#x3D;n+1}^{m} \tbinom{i}{n} g(i)<br>$$<br>å°±æ˜¯é’¦å®š $i$ ä¸ªçš„æƒ…å†µå‡å»æ°å¥½æœ‰å¤§äº $i$ ä¸ªçš„æƒ…å†µä¹˜ä¸Šä¸€ä¸ªç»„åˆæ•°ï¼Œè¿™å’Œä¸Šé¢é‚£ä¸ªäºŒç»´çš„å¾ˆç±»ä¼¼ã€‚</p>
<p>ç»™å‡ºé«˜ä½äºŒé¡¹å¼åæ¼”å…¬å¼ï¼š<br>$$<br>g(n_1,n_2,â‹¯,n_m)&#x3D;âˆ‘\limits_{k_i &#x3D; 0}^{n_i} âˆ\limits_{i&#x3D;1}^{m}\tbinom{n_i}{k_i}f(k_1,k_2,â‹¯,k_m)<br>$$</p>
<p>$$<br>\ \ \ \ \ \ \ \ \ \ \ \Updownarrow<br>$$</p>
<p>$$<br>f(n_1,n_2,â‹¯,n_m)&#x3D;âˆ‘\limits_{k_i&#x3D;0}^{n_i}âˆ\limits_{i&#x3D;1}^{m}(âˆ’1)^{n_iâˆ’k_i}\tbinom{n_i}{k_i} g(k_1,k_2,â‹¯,k_m)<br>$$</p>
<p>ç¬¬ä¸€ä¸ªäºŒç»´å¼å­å’Œç¬¬äºŒä¸ªä¸€ç»´å¼å­å¾ˆç±»ä¼¼ï¼Œæ‰€ä»¥è€ƒè™‘æ¨å‡º $f,g$ çš„å…³ç³»ã€‚<br>$$<br>f(n,m) &#x3D; \sum\limits_{i&#x3D;0}^{n} \sum\limits_{j&#x3D;0}^{m} g(i,j) \times \tbinom{n}{i} \times \tbinom{m}{j}<br>$$<br>ç»„åˆè§£é‡Šæ˜¯é’¦å®š $n$ è¡Œ $m$ åˆ—å¯ä»¥è¢«å ç”¨çš„æ–¹æ¡ˆæ•°å°±æ˜¯å…ˆä»å…¶ä¸­é€‰å‡º $i$ è¡Œ $j$ åˆ—ã€‚ç„¶åè®¡ç®—æ°å¥½è¿™ä¹ˆå¤šè¢«å ç”¨çš„æ–¹æ¡ˆæ•°ã€‚ å› ä¸ºè¡Œå’Œåˆ—æ˜¯æœ‰æ ‡å·çš„ã€‚</p>
<p>ç›´æ¥ä»£å…¬å¼æœ‰<br>$$<br>g(n,m) &#x3D; \sum\limits_{i&#x3D;0}^{n} \sum\limits_{j&#x3D;0}^{m} (-1)^{n-i+m-j} \tbinom{n}{i}\times \tbinom{m}{j}\times f(i,j)<br>$$<br>ç»“æŸã€‚</p>
<h3 id="ABC242H-åˆæ­¥ç†è§£-min-max-å®¹æ–¥"><a href="#ABC242H-åˆæ­¥ç†è§£-min-max-å®¹æ–¥" class="headerlink" title="ABC242H(åˆæ­¥ç†è§£ min-max å®¹æ–¥)"></a>ABC242H(åˆæ­¥ç†è§£ min-max å®¹æ–¥)</h3><h4 id="é¢˜æ„ï¼š-1"><a href="#é¢˜æ„ï¼š-1" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><p>ç»™å®š $m$ æ¡çº¿æ®µï¼Œä¸€ä¸ªé•¿åº¦ä¸º $n$ çš„æ•°è½´ï¼Œæ¯æ¬¡éšæœºé€‰ä¸€æ¡æŠŠæ•°è½´ä¸Šå¯¹åº”ä½ç½®æ¶‚é»‘ï¼Œé—®å…¨éƒ¨æ¶‚é»‘çš„æœŸæœ›é€‰æ‹©æ¬¡æ•°ã€‚</p>
<h4 id="æ€è€ƒï¼š-1"><a href="#æ€è€ƒï¼š-1" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è®° $E(i)$ è¡¨ç¤ºç¬¬ $i$ ä¸ªæ ¼å­è¢«æ¶‚é»‘çš„æœŸæœ›æ—¶é—´ã€‚è®° $E(S)$ è¡¨ç¤ºé›†åˆ $S$ å…¨éƒ¨è¢«æ¶‚é»‘çš„æœŸæœ›æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰æ ¼å­ä¸­è¢«æ¶‚é»‘æ—¶é—´çš„æœ€å¤§å€¼ï¼Œ$Eâ€™(S)$ è¡¨ç¤ºé›†åˆ $S$ ä¸­ä»»æ„ä¸€ä¸ªè¢«æ¶‚é»‘çš„æœŸæœ›æ—¶é—´ï¼Œå³æœ€å°å€¼ã€‚</p>
<p>æ˜¾ç„¶ $E(S) \neq \max\limits_{i\in S} (E(i))$ï¼Œå› ä¸ºæœŸæœ›åªæœ‰çº¿æ€§æ€§ï¼Œ$max,min$  æ˜¯éçº¿æ€§æ“ä½œã€‚</p>
<p>ä½†æ˜¯æˆ‘ä»¬å‘ç°ä¸€ä»¶äº‹ $\max(S) &#x3D; \sum\limits_{T \subseteq S} (-1)^{|T| - 1} \min(T)$ï¼Œå³ $\text{min-max}$ å®¹æ–¥çš„å…¬å¼åœ¨æœŸæœ›æ„ä¹‰ä¸‹ä¹Ÿæˆç«‹ã€‚</p>
<p>è€Œå¯¹è¿™é“é¢˜æ¥è¯´ï¼Œè®¡ç®—ä¸€ä¸ªé›†åˆçš„æœ€å°å€¼æ˜¯å®¹æ˜“çš„ï¼Œåªéœ€è¦è®¡ç®—å‡ºæœ‰å¤šå°‘ä¸ªåŒ…å«ä»»æ„ä¸€ä¸ªå…ƒç´ çš„çº¿æ®µå°±è¡Œäº†ã€‚</p>
<p>æˆ‘ä»¬è®¾ $dp[i][j][k][0&#x2F;1]$ è¡¨ç¤ºè€ƒè™‘åˆ°ç¬¬ $i$ ä¸ªä½ç½®ï¼Œä¸Šä¸€ä¸ªä½ç½®ä¸º $j$ï¼Œå·²ç»åŒ…å« $k$ æ¡çº¿æ®µçš„æ–¹æ¡ˆæ•°ï¼Œé›†åˆå¤§å°ä¸ºå¥‡æ•°æˆ–å¶æ•°çš„æ–¹æ¡ˆæ•°ï¼Œè½¬ç§»å¯ä»¥é¢„å¤„ç† $[l,r]$ ä¼šæ–°å¢å¤šå°‘çº¿æ®µï¼Œåšåˆ° $O(1)$ï¼Œäº‹å®ä¸Šæœ€åä¸€ç»´å¯ä»¥çœæ‰ï¼Œç›´æ¥å¸¦ç³»æ•°è½¬ç§»å°±è¡Œã€‚</p>
<h2 id="20220309"><a href="#20220309" class="headerlink" title="20220309"></a>20220309</h2><h3 id="haltoj128"><a href="#haltoj128" class="headerlink" title="haltoj128"></a>haltoj128</h3><h4 id="æ€è€ƒï¼š-2"><a href="#æ€è€ƒï¼š-2" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>æ¬§æ‹‰å›¾è®¡æ•°ç›¸å…³é—®é¢˜ã€‚å…³äºæ— å‘æ¬§æ‹‰å›¾æœ‰ä¸€ä¸ªç»“è®ºï¼Œæ¬§æ‹‰å­å›¾çš„ä¸ªæ•°ä¸º $2^{m-n+c}$ ä¸ªï¼Œä¹Ÿå°±æ˜¯å…¶ç”Ÿæˆæ£®æ—ä¸­éæ ‘è¾¹ç»„æˆçš„é›†åˆä¸ªæ•°ï¼Œå…¬å¼ä¸­ $c$ ä»£è¡¨è¿é€šå—ä¸ªæ•°ã€‚</p>
<p>ç†è§£æ¯”è¾ƒå®¹æ˜“ï¼Œè€ƒè™‘æ„é€ æ–¹æ¡ˆï¼Œä»»æ„ä¸€ä¸ªéæ ‘è¾¹é›†åˆä¼šå”¯ä¸€å¯¹åº”ä¸€ç§åˆæ³•æ–¹æ¡ˆï¼Œé€‰ä¸€æ¡éæ ‘è¾¹åˆ™å°†å®ƒè¦†ç›–çš„æ ‘è¾¹çŠ¶æ€åè½¬ï¼ˆé€‰å˜ä¸ºä¸é€‰ï¼Œä¸é€‰å˜ä¸ºé€‰ï¼‰ï¼Œå¯ä»¥å¾—åˆ°å”¯ä¸€åˆæ³•æ–¹æ¡ˆã€‚</p>
<p>è¿™ä¸ªé€‰éæ ‘è¾¹é›†åˆçš„æ–¹å¼ç»™è¿™é“é¢˜ç›®å¸¦æ¥äº†å¯å‘ã€‚ç„¶è€Œè¿™ç§ç±»ä¼¼å¼‚æˆ–çš„æ–¹å¼å¹¶ä¸ä¾¿äºç»Ÿè®¡ $|S|^2$ è¿™ç§ä¸œè¥¿ã€‚æˆ‘ä»¬è€ƒè™‘å®ƒçš„ç»„åˆæ„ä¹‰ã€‚å‘ç°å…¶ç»„åˆæ„ä¹‰ä¸ºæ¯å¯¹è¾¹åœ¨åŒä¸€å­å›¾ä¾¿è´¡çŒ®ä¸¤æ¬¡ï¼Œä¸€æ¡è¾¹åœ¨æŸä¸€å­å›¾è´¡çŒ®ä¸€æ¬¡ã€‚</p>
<p>ä¸€æ¡è¾¹çš„æƒ…å†µæ˜¯ç®€å•çš„ï¼Œè€ƒè™‘ä¸¤æ¡è¾¹ã€‚</p>
<p>ä¸¤æ¡éæ ‘è¾¹æ˜¯å¯ä»¥ä»»é€‰çš„ï¼Œè¿™ä¸€éƒ¨åˆ†ç­”æ¡ˆä¸º $k*(k-1)*2^{k-2}$ï¼Œå› ä¸ºå·²ç»é’¦å®šè¿™ä¸¤è¾¹è¦é€‰ï¼Œå…¶å®ƒçš„ä»»æ„é€‰ã€‚</p>
<p>ä¸€æ¡éæ ‘è¾¹å’Œä¸€æ¡æ ‘è¾¹çš„è´¡çŒ®å¯ä»¥åˆ†ä¸¤ç§æƒ…å†µï¼Œåˆ†åˆ«æ˜¯æ ‘è¾¹æ˜¯å¦å—åˆ°éæ ‘è¾¹å½±å“ã€‚ä¸å—å½±å“ç­”æ¡ˆä¸º $(k-cover[v]) * 2^{k-2}$ï¼Œ$cover[v]$ å½±å“è¿™æ¡æ ‘è¾¹çš„éæ ‘è¾¹æ¡æ•°ï¼Œ$k-2$ å› ä¸ºé’¦å®šäº†é€‰æ‹©çš„éæ ‘è¾¹è¦é€‰ï¼Œå¹¶ä¸”å½±å“è¿™æ¡æ ‘è¾¹çš„è¾¹æœ‰ä¸€ä¸ªçš„é€‰æ‹©æƒ…å†µæ˜¯ä¸èƒ½ä»»æ„ï¼Œå› ä¸ºè¦è®©æ ‘è¾¹è¢«é€‰æ‹©ã€‚</p>
<p>å¦‚æœå—åˆ°éæ ‘è¾¹å½±å“ï¼Œé‚£ä¹ˆç­”æ¡ˆä¹Ÿä¸º $cover[v] * 2^{k-2}$ï¼Œä½†å¦‚æœ $cover[v] &#x3D; 1$ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º $2^{k-1}$ã€‚ç†è§£æ–¹å¼ç±»ä¼¼ã€‚</p>
<p>ä¸¤æ¡æ ‘è¾¹çš„æƒ…å†µï¼Œè€ƒè™‘å½±å“è¿™ä¸¤æ¡æ ‘è¾¹çš„è¾¹é›†ï¼Œæˆ‘ä»¬æ–­è¨€å¦‚æœè¾¹é›†å®Œå…¨ç›¸åŒï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º $2^{k-1}$ï¼Œå¦åˆ™ç­”æ¡ˆä¸º $2^{k-2}$ï¼Œè¾¹é›†å®Œå…¨ç›¸åŒçš„æƒ…å†µä¸éš¾ç†è§£ï¼Œå¦‚æœä¸å®Œå…¨ç›¸åŒï¼Œæˆ‘ä»¬åœ¨æ¯æ¡è¾¹ç‰¹æœ‰çš„éƒ¨åˆ†é’¦å®šä¸€ä¸ªæ¥æ§åˆ¶è¯¥è¾¹ï¼Œæ‰€ä»¥ç­”æ¡ˆä¸º $2^{k-2}$ã€‚å¦‚æœæ˜¯åŒ…å«å…³ç³»ï¼Œå…ˆé’¦å®šé‡Œé¢çš„ï¼Œå†é’¦å®šå¤–é¢çš„å³å¯ã€‚</p>
<p>å¦‚æœè¦é€‰æ‹©æ ‘è¾¹ï¼Œè®°å¾—ä¸è¦è€ƒè™‘ $cover[v] &#x3D; 0$  çš„è¾¹ã€‚è®¡ç®— $cover$ å¯ä»¥æ ‘ä¸Šå‰ç¼€å’Œï¼Œå¯¹äºä¸¤æ¡éæ ‘è¾¹ï¼Œéœ€è¦ç»Ÿè®¡è¾¹é›†ç›¸åŒçš„ä¸ªæ•°ï¼Œè¿™ä¸ªå¯ä»¥å¼‚æˆ–å“ˆå¸Œï¼Œå– $2^{63}$ ä¸ºä¸Šç•Œï¼ŒåšåŒå“ˆå¸Œï¼Œé”™è¯¯æ¦‚ç‡åœ¨æœ¬é¢˜æ•°æ®è§„æ¨¡ä¸‹å°äº $10^{-9}$ã€‚</p>
<h3 id="haltoj132-åˆ†æ²»NTTçš„æ€è·¯"><a href="#haltoj132-åˆ†æ²»NTTçš„æ€è·¯" class="headerlink" title="haltoj132(åˆ†æ²»NTTçš„æ€è·¯)"></a>haltoj132(åˆ†æ²»NTTçš„æ€è·¯)</h3><h4 id="æ€è€ƒï¼š-3"><a href="#æ€è€ƒï¼š-3" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>å‡è®¾ä¸è€ƒè™‘ $â€™&gt;â€™$ï¼Œå³ä»¤ $â€™&gt;â€™$ ä¸ºæ— é™åˆ¶ï¼Œé‚£ä¹ˆåºåˆ—ä¼šè¢« $â€™&gt;â€™$  åˆ’åˆ†ä¸ºè‹¥å¹²æ®µï¼Œè®°æ¯ä¸€æ®µçš„é•¿åº¦ä¸º $a$ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º<br>$$<br>\dfrac{n!}{\prod a_i !}<br>$$<br>æˆ‘ä»¬è€ƒè™‘å®¹æ–¥ï¼Œæšä¸¾ä¸€ä¸ªå­é›†è¡¨ç¤ºé‚£äº›ä½ç½®ä¸Šçš„ $â€™&gt;â€™$ å¼ºåˆ¶ä¸º $â€™&lt;â€™$ï¼Œä¹Ÿå°±æ˜¯ä¸åˆæ³•çš„æƒ…å†µï¼Œç„¶åå°±å¯ä»¥ç”¨æ€»æ•°å‡å»è¿™äº›ä¸åˆæ³•æƒ…å†µå¾—åˆ°ç­”æ¡ˆã€‚</p>
<p>ä¸Šé¢çš„é‚£ä¸ª $n!$ åœ¨åšè½¬ç§»çš„æ—¶å€™å¾ˆéº»çƒ¦ï¼Œå…ˆä¸ç®¡ã€‚</p>
<p>è®¾ $dp[i]$ è¡¨ç¤ºå¯¹å‰ $i$ ä¸ªç¬¦å·åšå®¹æ–¥ï¼Œè€ƒè™‘åˆ°ç¬¬ $i$ ä¸ªç¬¦å·åçš„æ•°å­—çš„ç»“æœã€‚</p>
<p>æ³¨æ„åˆ°è¿™é‡Œ $dp[i] \times (i+1)!$ ä¹Ÿå°±æ˜¯å‰ç¼€ $s_i$ çš„ç­”æ¡ˆã€‚</p>
<p>é¡ºä¾¿è®¾ $f_i$ è¡¨ç¤ºå‰ $i$ ä¸ªç¬¦å·ä¸­ $â€™&gt;â€™$ çš„ä¸ªæ•°ã€‚</p>
<p>æ˜¾ç„¶æœ‰ $dp[0] &#x3D; 1$</p>
<p>æˆ‘ä»¬å¾—åˆ°ä»¥ä¸‹å¼å­ï¼š<br>$$<br>dp[i] &#x3D; (-1)^{f_i}\times \dfrac{1}{(i+1)!} +\sum\limits_{s_j &#x3D; â€˜&gt;â€™,j\in[1,i]} dp[j-1] \times (-1)^{f_{i}-f_{j}} \times\dfrac{1}{(i-j+1)}!<br>$$<br>è€ƒè™‘å¦‚ä½•ç†è§£è¿™ä¸ªå¼å­ã€‚</p>
<p>æˆ‘ä»¬æšä¸¾ä¸Šä¸€ä¸ªä¸å—é™åˆ¶çš„ä½ç½® $j$ï¼Œç„¶åä¹˜ä¸Šå¯¹åº”çš„å®¹æ–¥ç³»æ•°å’Œè®¡ç®—è½¬ç§»ç³»æ•°ï¼Œæœ€ååŠ ä¸Šå…¨éƒ¨å—é™åˆ¶çš„æƒ…å†µã€‚</p>
<p>å› ä¸ºè¦ä¼˜åŒ–ï¼Œæ‰€ä»¥æŠŠå¼å­å°å°çš„å˜ä¸€ä¸‹ï¼š<br>$$<br>dp[i] &#x3D; (-1)^{f_i}\times \dfrac{1}{(i+1)!} +\sum\limits_{s_{j+1} &#x3D; â€˜&gt;â€™,j\in[0,i-1]} dp[j] \times (-1)^{f_{i}-f_{j+1}} \times\dfrac{1}{(i-j)}!<br>$$<br>ä¼ è¯´ä¸­çš„åˆ†æ²» $NTT$ å¯ä»¥è§£å†³è¿™ä¸€ç±» $dp$ çš„ä¼˜åŒ–é—®é¢˜ï¼Œå®ƒçš„æ ¸å¿ƒæ€è·¯å¤§æ¦‚æ˜¯è¿™æ ·çš„ï¼š</p>
<p>åˆ†æ²» $NTT$ è§£å†³å½¢å¦‚è¿™æ ·çš„é—®é¢˜ï¼š</p>
<p>å‡è®¾è¦æ±‚çš„å‡½æ•°ä¸º $f$ï¼Œæœ‰å¦ä¸€ä¸ªå‡½æ•° $g$ã€‚</p>
<p>æ»¡è¶³ $f(i) &#x3D; \sum\limits_{j\ &lt; i} f(j) \times g(i-j)$ã€‚</p>
<p>ç±»ä¼¼äº $\text{CDQ}$ ä¸€æ ·ï¼Œè€ƒè™‘å·¦è¾¹å¯¹å³è¾¹çš„è´¡çŒ®å³å¯ï¼Œå®¹æ˜“å‘ç°è¿™æ˜¯ä¸€ä¸ªå¥½åšçš„å·ç§¯å½¢å¼ã€‚</p>
<p>å¯¹äºè¿™é“é¢˜æ¥è¯´ï¼Œ$-1$ çš„æ¬¡å¹‚å¯ä»¥è¢«æ‹†åˆ°ä¸¤è¾¹ï¼Œå‰©ä¸‹çš„äº‹æƒ…æœ‰æ‰‹å°±è¡Œã€‚</p>
<h4 id="æ”¶è·"><a href="#æ”¶è·" class="headerlink" title="æ”¶è·"></a>æ”¶è·</h4><p>å®¹æ–¥åŸç†å¯ä»¥è§£å†³è¿™æ ·ä¸€ç±»é—®é¢˜ï¼Œæœ‰ä¸€ä¸ªå…¨é›† $S$ï¼Œ$|S|$ å¥½æ±‚ï¼Œç°åœ¨æœ‰è‹¥å¹²å±æ€§ $p_i$ï¼Œæ„æˆé›†åˆ $T$ï¼Œéœ€è¦æ±‚æ»¡è¶³å±æ€§é›†åˆ $T$ çš„å…ƒç´ ä¸ªæ•°ã€‚å¹¶ä¸”å¯ä»¥å¾ˆå®¹æ˜“æ±‚å‡ºè¿™æ ·ä¸€ç§æƒ…å†µçš„ç­”æ¡ˆï¼šé™å®šæŸäº›å±æ€§ä¸æ»¡è¶³ï¼Œå…¶å®ƒå±æ€§ä¸åšè¦æ±‚ã€‚</p>
<h2 id="20220320"><a href="#20220320" class="headerlink" title="20220320"></a>20220320</h2><h3 id="HaltOJ-7"><a href="#HaltOJ-7" class="headerlink" title="HaltOJ 7"></a>HaltOJ 7</h3><h4 id="æ€è€ƒï¼š-4"><a href="#æ€è€ƒï¼š-4" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>æƒ³ä¸€ä¸‹å°å­¦çš„æ—¶å€™åšè¿‡çš„å¥¥æ•°é¢˜ï¼Œä¸€ä¸ªåœ†é‡Œç”» $n$ æ¡çº¿æœ€å¤šåˆ†æˆå‡ éƒ¨åˆ†ï¼Œç­”æ¡ˆæ˜¯ $n*(n+1)&#x2F;2 + 1$ã€‚å†è€ƒè™‘ä¸‹å¹³è¡Œçº¿å’Œå¤šç‚¹å…±çº¿çš„æƒ…å†µï¼Œå‘ç°ç­”æ¡ˆåªå’Œæ¯ä¸ªäº¤ç‚¹çš„æƒ…å†µå’Œäº¤ç‚¹ä¸ªæ•°æœ‰å…³ã€‚æ‰‹ç©ä¸€ä¸‹å¯ä»¥å‘ç°ï¼Œåœ¨é€ä¸ªåŠ å…¥ç›´çº¿çš„æƒ…å†µä¸‹ï¼Œéƒ¨åˆ†çš„ä¸ªæ•°å¢é‡ä¸ºæ­¤æ¡ç›´çº¿å’Œå…¶å®ƒæ‰€æœ‰ç›´çº¿äº¤ç‚¹ä¸ªæ•° $x$ï¼Œå†åŠ ä¸Š $1$ï¼Œæ³¨æ„ï¼Œç›¸åŒäº¤ç‚¹åªç®—ä¸€ä¸ªã€‚</p>
<p>è¯æ˜å¯ä»¥å‚è€ƒå¹³é¢æ¬§æ‹‰å®šç†ï¼Œæ­¤å¤„ä¸åšèµ˜è¿°ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬æ¨¡æ‹Ÿè¿™ä¸ªè¿‡ç¨‹ï¼Œæ¯æ¬¡åŠ å…¥ä¸€æ¡ç›´çº¿åˆ¤æ–­æ–°å¢äº†å¤šå°‘äº¤ç‚¹ï¼Œå…·ä½“å¯ä»¥å…ˆæš´åŠ›æšä¸¾ç›´çº¿ï¼Œæ±‚å‡ºæ‰€æœ‰äº¤ç‚¹ä¹‹åå¸¦ä¸Š $eps$ å»é‡ã€‚ç„¶åå‘ç° $y$ åªå’Œ $x$ æœ‰å…³ï¼Œæ‰€ä»¥åªç”¨è®¡ç®—ä¸€ä¸ªã€‚ç„¶åæˆ‘ä»¬å‘ç°å¦‚æœæŒ‰ç…§æ–œç‡ä¸ºç¬¬ä¸€å…³é”®å­—ï¼Œæˆªè·ä¸ºç¬¬äºŒå…³é”®å­—æ’åºåŠ å…¥çº¿æ®µï¼Œé‚£ä¹ˆ $x$ æ˜¯ä¸€ä¸ªç›¸å½“ä¼˜ç¾çš„å½¢å¼ $\dfrac{j-b}{a-i}$ï¼Œ$a,b$ è¡¨ç¤ºå½“å‰çº¿æ®µçš„æ–œç‡å’Œæˆªè·ï¼Œ$i,j$ è¡¨ç¤ºæšä¸¾çš„çº¿æ®µçš„æ–œç‡å’Œæˆªè·ï¼Œ$i,j$ çš„å–å€¼éƒ½è¿ç»­ï¼Œæ‰€ä»¥è¿™ä¸ªå¼å­ä¸­ï¼Œåˆ†æ¯ä¼šå–é $[1,i]$ï¼Œåˆ†å­ä¼šå–é $[-b,B-j-1]$ï¼Œæ­£è´Ÿæ•°åˆ†å¼€è€ƒè™‘ï¼Œç°åœ¨é—®é¢˜å˜æˆäº†é—® $\dfrac{[1,x]}{[1,y]}$ ä¸­æœ‰å¤šå°‘ä¸ªä¸åŒçš„æ•°ï¼Œ$A^2$ é¢„å¤„ç†ï¼Œ$O(1)$  å›ç­”å³å¯ï¼Œçº¦å®šæ¯ä¸ªæ•°åœ¨æœ€ç®€åˆ†æ•°è¢«ç»Ÿè®¡ã€‚</p>
<p>å¯ä»¥è«æ¯”ä¹Œæ–¯åæ¼”ä¼˜åŒ–ï¼Œè¿™ä¸ªå¯ä»¥å¾ˆæ–¹ä¾¿çš„è½¬åŒ–æˆ $[gcd(x,y)&#x3D;1]$ çš„å½¢å¼å¹¶æ•´é™¤åˆ†å—è®¡ç®—ï¼Œå¯ä»¥ $n\sqrt n$ï¼Œä½†æ²¡å¿…è¦ã€‚</p>
<h3 id="HaltOJ8"><a href="#HaltOJ8" class="headerlink" title="HaltOJ8"></a>HaltOJ8</h3><h4 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>è¿™é“é¢˜å‡ºå‡ºæ¥å°±å±•ç°å‡ºå¯¹ç›´æ¥ $dp$ çš„æ¶æ„ï¼Œæ— è®ºé‚£ç§åˆå¹¶æ–¹æ³•éƒ½æ— æ³•è§£å†³è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬ä¸å¦¨å¦è¾Ÿè¹Šå¾„ï¼Œè€ƒè™‘å­—ç¬¦ä¸²çš„å¦ä¸€ç§ç”Ÿæˆæ–¹å¼â€”â€”æ’å…¥ã€‚</p>
<p>å…·ä½“çš„ï¼Œæˆ‘ä»¬å°†ä¸åŒçš„èŠ±è§†ä¸ºä¸åŒå­—ç¬¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç›¸é‚»å­—ç¬¦ä¸åŒï¼Œæ¯ä¸ªå­—ç¬¦ä¸ªæ•°æŒ‡å®šã€‚</p>
<p>æˆ‘ä»¬å‘ç°å½“å‰çš„æ’å…¥æ–¹å¼ä»…ä»…å—åˆ°å½“å‰ç›¸åŒå­—ç¬¦ä½ç½®ä¸ªæ•°çš„é™åˆ¶ï¼Œæ‰€ä»¥è®¾ $f_i$ è¡¨ç¤ºè€ƒè™‘åˆ°ç°åœ¨ï¼Œæœ‰ $i$ ä¸ªå­—ç¬¦ç›¸åŒä½ç½®çš„æ–¹æ¡ˆæ•°ã€‚</p>
<p>è½¬ç§»å¯ä»¥æšä¸¾å½“å‰å­—ç¬¦åˆ’åˆ†ä¸ºå¤šå°‘æ®µï¼Œå…¶ä¸­æœ‰å¤šå°‘æ®µæ’å…¥ç›¸åŒå­—ç¬¦ä½ç½®ï¼Œå…·ä½“æ¯ä¸€æ®µæ”¾å‡ ä¸ªå¯ä»¥é€šè¿‡æ’æ¿æ³•è®¡ç®—æ–¹æ¡ˆã€‚è¿™æ ·çš„è½¬ç§»çœ‹ä¸Šå»æ˜¯ $O{(10^{5}})^3$,ä½†æ˜¯å¦‚æœæˆ‘ä»¬å°†å­—ç¬¦æŒ‰ä¸ªæ•°æ’åºåå¹¶æŒ‰ç…§ $3,1,2,4$ çš„é¡ºåºæ’å…¥ï¼Œå› ä¸ºä¿è¯äº†æœ‰ä¸¤ä¸ªåªæœ‰ $200$ï¼Œæ‰€ä»¥å¤æ‚åº¦ä¸º $O(1+200^2 + 200^3 + 10^5)$ çš„å¤æ‚åº¦ï¼Œæœ€åä¸€æ¬¡è½¬ç§»å¼ºåˆ¶è¦æ±‚äº†æ®µæ•°å’Œæ’å…¥ç›¸åŒå­—ç¬¦ä½ç½®çš„æ•°é‡ï¼Œç¬¬ä¸‰æ¬¡åˆ™æ˜¯å› ä¸ºç¬¬äºŒæ¬¡è½¬ç§»åæœ‰æ•ˆä½ç½®ä»…æœ‰ $200$ ä¸ªã€‚</p>
<p>å¬è¯´å¯ä»¥åšåˆ° $O(200^2 + 10^5)$ ï¼Œä½†æ˜¾ç„¶æˆ‘ä¸ä¼šã€‚</p>
<h2 id="20220322"><a href="#20220322" class="headerlink" title="20220322"></a>20220322</h2><h3 id="ARC137D"><a href="#ARC137D" class="headerlink" title="ARC137D"></a>ARC137D</h3><h4 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><p>ç»™å®šä¸€ä¸ªåºåˆ— $a$ï¼Œåå¤åšå‰ç¼€å¼‚æˆ–æ“ä½œï¼Œé—®è‹¥å¹²æ¬¡æ“ä½œå $a_n$ çš„å€¼ï¼Œè¯¢é—®æ‰€æœ‰ $[1,k]$ çš„ç­”æ¡ˆã€‚</p>
<h4 id="æ€è€ƒ-1"><a href="#æ€è€ƒ-1" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>è€ƒåœºä¸Šä¸€ç›´åœ¨è€ƒè™‘åˆ†æå•çº¯çš„ $01$ ç³»æ•°ï¼Œè€Œå¿½ç•¥äº†ç³»æ•°ä¹‹é—´çš„å†…åœ¨å…¶å®ƒè”ç³»ï¼Œäº‹å®ä¸Šï¼Œå¯¹äºåå¤æ‰§è¡Œçš„å¯åŠ å‰ç¼€æ“ä½œï¼Œè®¾è·ç¦»ä¸º $d$ï¼Œæ“ä½œæ¬¡æ•°ä¸º $k$ï¼Œé‚£ä¹ˆè´¡çŒ®åº”è¯¥ä¸ºä» $(0,0)$ èµ°åˆ° $(d,k-1)$ çš„æ–¹æ¡ˆæ•°ã€‚è¯æ˜æ¯”è¾ƒç®€å•ï¼Œå°†åŸç‚¹çš„è´¡çŒ®è½¬ç§»æ‹†åˆ†åˆ°æ¨ªåæ ‡å³å¯ã€‚</p>
<p>æ›´ä¸¥è°¨çš„è¯æ˜å¯ä»¥ä½¿ç”¨å½’çº³æ³•ï¼Œè®°è´¡çŒ®å‡½æ•°ä¸º $f(x,y)$ï¼Œ$f(n,k) &#x3D; f(n-1,k)+f(n,k-1)$ï¼Œé‚£ä¹ˆè€ƒè™‘å…¶ç»„åˆæ„ä¹‰ï¼Œç¬¬ä¸€é¡¹ä»£è¡¨äº†å‰ $n-1$ é¡¹çš„å’Œï¼Œç¬¬äºŒé¡¹åˆ™æ˜¯è‡ªå·±åœ¨ä¸Šé¢çš„æ­¥éª¤ä¸­çš„ç´¯è®¡ã€‚</p>
<p>é‚£ä¸ª $-1$ å¾ˆè®¨åŒï¼Œå…ˆä¸ç®¡ã€‚</p>
<p>ç”¨ç»„åˆæ•°çš„å½¢å¼è¡¨ç¤ºç­”æ¡ˆï¼Œå³ä¸º $\tbinom{n+k}{n}$,å¯¹å…¶åº”ç”¨å¢å¡æ–¯å®šç†æ±‚å‡º $\bmod2$ çš„ç»“æœï¼Œå‘ç°å½“ä¸”ä»…å½“ $n&amp;k &#x3D; 0$ æ—¶æœ‰å€¼ï¼Œé‚£ä¹ˆå¯¹äºä¸€ä¸ªå›ºå®šçš„ $n$ ï¼Œæœ‰å€¼çš„ $k$ ä¸€å®šå¯ä»¥æè¿°ä¸ºä¸€ä¸ª $s$ åœ¨äºŒè¿›åˆ¶æ„ä¹‰ä¸‹çš„å­é›†ã€‚</p>
<p>ç„¶åå¯¹å…¶åšä¸€æ¬¡ $\text{FMT}$ å˜æ¢å³å¯å¾—åˆ°ç»“æœã€‚</p>
<p>æ³¨æ„å¤„ç†è¢«å¿½ç•¥çš„ $-1$</p>
<h2 id="20220323"><a href="#20220323" class="headerlink" title="20220323"></a>20220323</h2><h3 id="CF1657D"><a href="#CF1657D" class="headerlink" title="CF1657D"></a>CF1657D</h3><h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>å…ˆåšä¹˜æ³•è½¬æ¢ï¼Œè¿™ä¸ªæ²¡å•¥è¯´çš„ã€‚ç„¶åæˆ‘è€ƒè™‘çš„æ˜¯æ ¹å·åˆ†æ²»ï¼Œå…ˆæŠŠä¸åœ¨å‡¸åŒ…ä¸Šçš„æ‰”æ‰ï¼Œå¯¹äºä»£ä»·å¤§äº $B$ çš„ï¼Œæšä¸¾é€‰çš„ä¸ªæ•°ï¼Œç„¶åå°ºå–æ³•æå®šï¼Œå¯¹äºä»£ä»·å°äº $B$ çš„ï¼Œç›´æ¥è®¡ç®—ã€‚åœºä¸Šè¿‡äº†ï¼Œèµ›åè¢«å‰ã€‚å®é™…ä¸Šï¼Œå¯¹äºè¿™ç§æ•´é™¤çš„é¢˜ç›®ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥è€ƒè™‘æšä¸¾å€æ•°çº¦æ•°ï¼Œç„¶åå¯ä»¥ç›´æ¥è®¡ç®—ä»£ä»·ä¸º $[1,C]$  çš„æœ€å¤§æƒå€¼ï¼Œç„¶åç›´æ¥åœ¨ä¸Šé¢äºŒåˆ†å°±è¡Œã€‚</p>
<h3 id="CF1647E"><a href="#CF1647E" class="headerlink" title="CF1647E"></a>CF1647E</h3><h4 id="æ€è·¯-1"><a href="#æ€è·¯-1" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><p>ä¸éš¾å‘ç°å……è¦æ¡ä»¶æ˜¯æ¯ä¸ªç‚¹å‘ $1$ çš„è¾¹ä¸ºæœ€å°å€¼ã€‚ç„¶åè€ƒè™‘ $dp$ï¼Œç›´æ¥å¯¹ç‚¹ $dp$ ä¸å¤ªå¥½åšï¼Œæˆ‘ä»¬å‘ç°å®ƒæ˜¯æœ‰å…³å¤§å°çš„ï¼Œæ‰€ä»¥è€ƒè™‘æŒ‰ç…§å‘ $1$ çš„è¾¹æƒå€¼ä»å°åˆ°å¤§ $dp$ï¼Œæ¯æ¬¡æšä¸¾ä¸€æ®µè¿ç»­çš„åŒºé—´ï¼Œä»¥åŠå¡«çš„å€¼è½¬ç§»ï¼Œè½¬ç§»æ˜¯ä¸€ä¸ªå‰ç¼€å’Œä¹˜ä¸Šä¸€ä¸ªç»„åˆæ•°å†ä¹˜ä¸Šä¸€ä¸ªå¹‚æ¬¡ã€‚</p>
<h3 id="CF1647F"><a href="#CF1647F" class="headerlink" title="CF1647F"></a>CF1647F</h3><h4 id="æ€è·¯ï¼š"><a href="#æ€è·¯ï¼š" class="headerlink" title="æ€è·¯ï¼š"></a>æ€è·¯ï¼š</h4><p>çœ‹ä¸Šå»å°±éå¸¸æš´åŠ›ï¼Œå¯¹æ¯ä¸ªé™åˆ¶å»ºç‚¹ï¼Œä¸¤ç§çŠ¶æ€ï¼Œé™åˆ¶å’Œæ ‘ä¸Šçš„ç‚¹çš„çŠ¶æ€æ¨å‡ºå…³ç³»è¿è¾¹ï¼Œç„¶åæš´åŠ›ç¡®å®šæ¯ä¸ªé™åˆ¶çš„çŠ¶æ€çœ‹æ˜¯å¦å†²çªå³å¯ã€‚å®é™…ä¸Šè¿™å°±æ˜¯æ¨¡æ‹Ÿäº† $\text{2-SAT}$ã€‚</p>
<p>è€ƒè™‘è¿™ä¸ªä¸œè¥¿ä¸ºä»€ä¹ˆå’Œ $\text{2-SAT}$ çš„æ­£å¸¸åšæ³•ä¸€æ ·çš„ï¼Œæ­£å¸¸åšæ³•æ˜¯æ‰¾å¼ºè¿é€šåˆ†é‡ï¼Œ æ‹“æ‰‘æ’åºåå¯¹æ¯ä¸ªç‚¹é€‰æ‹“æ‰‘åºå¤§é‚£ä¸ªå€¼ã€‚å’Œæˆ‘ä»¬çš„æš´åŠ›æ¨¡æ‹Ÿè¿‡ç¨‹æ²¡å•¥åŒºåˆ«ã€‚</p>
<h3 id="HaltOJ126-2-SAT-çš„ç®€å•ç†è§£"><a href="#HaltOJ126-2-SAT-çš„ç®€å•ç†è§£" class="headerlink" title="HaltOJ126(2-SAT çš„ç®€å•ç†è§£)"></a>HaltOJ126(2-SAT çš„ç®€å•ç†è§£)</h3><h4 id="æ€è€ƒï¼š-5"><a href="#æ€è€ƒï¼š-5" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>æœ‰ä¸€äº›æ¯”è¾ƒå¥‡æ€ªçš„é™åˆ¶ï¼Œç„¶åæ¯ä¸ªäººåœ¨æ¯ä¸ªç‚¹å°±ä¸¤ç§çŠ¶æ€ï¼Œè¦æƒ³èµ·ä¸€ä¸ªä¸œè¥¿å« $\text{2-SAT}$ï¼Œæˆ‘ä»¬ä»¤ $statu[i][j]$ è¡¨ç¤º $i$ å­æ ‘å†…æ˜¯å¦æœ‰ $j$ï¼Œé‚£ä¹ˆå¾ˆå®¹æ˜“æ„é€ å‡ºæ ‡å‡†çš„ $\text{2-SAT}$ é™åˆ¶ï¼Œç„¶åæˆ‘ä»¬è€ƒè™‘çº¦æŸï¼Œåˆ†ç±»è®¨è®ºä¸€ä¸‹ã€‚ä»¥ $\text{2-SAT}$ çš„å½¢å¼æ¥è¯´ï¼Œå¯¹äº $x$ çš„æ¯ä¸ªå„¿å­ $v$ï¼Œä¸¤ä¸ªç‚¹éƒ½ä¸èƒ½åŒæ—¶åœ¨ $v$ ä¸­ã€‚åŒæ—¶ï¼Œå¦‚æœ $lca(x,r) \neq x$ ï¼Œé‚£ä¹ˆä¸¤ä¸ªäººéƒ½å¿…é¡»åœ¨ $x$ å­æ ‘å†…ã€‚å¦‚æœ $lca(x,r) &#x3D; x$ï¼Œé‚£ä¹ˆ $a,b$ åªèƒ½æœ‰ä¸€ä¸ªåœ¨å­æ ‘å¤–ï¼Œå°±æ˜¯ä¸€ä¸ªä¸ºå‡é‚£ä¹ˆå¦ä¸€ä¸ªä¸ºçœŸï¼Œé™¤æ­¤ä»¥å¤–ï¼Œå¦‚æœ $x \neq r$ï¼Œé‚£ä¹ˆ $a,b$ ä¸èƒ½åœ¨ $x$ å‘ $r$ çš„å„¿å­é‡Œã€‚</p>
<p>ç„¶åè·‘ä¸€ä¸ªæ ‡å‡†çš„ $\text{2-SAT}$ã€‚</p>
<p>$\text{Tarjan}$ è·‘å‡ºæ¥çš„ $\text{SCC}$ ç¼–å·æ˜¯åæ‹“æ‰‘åºã€‚</p>
<p>$\text{2-SAT}$ çš„ä¸€äº›é™åˆ¶ï¼šå¼ºåˆ¶ $u$ ä¸ºçœŸï¼Œé‚£ä¹ˆæŠŠå‡è¿å‘çœŸï¼Œåä¹‹äº¦ç„¶ã€‚å…¶å®ƒæƒ…å†µä¸‹æ³¨æ„é€†å¦å‘½é¢˜ä¹Ÿè¦è¿è¾¹</p>
<p>$\text{2-SAT}$ å›¾çš„ä¸€äº›æ€§è´¨ï¼š$u \rightarrow v \Rightarrow \overline{v} \rightarrow \overline{u}$ </p>
<p>$\text{2-SAT}$ åˆæ³•æ€§ï¼šåŒä¸€å˜é‡çš„ä¸¤ä¸ªçŠ¶æ€ä¸åœ¨åŒä¸€ $\text{SCC}$ å†…æ˜¯å­˜åœ¨æ–¹æ¡ˆçš„å……è¦æ¡ä»¶ï¼Œå¿…è¦æ€§æ˜¾ç„¶ï¼Œå……åˆ†æ€§ç”¨æ„é€ æ³•è¯æ˜ã€‚</p>
<p>$\text{2-SAT}$ æ–¹æ¡ˆæ„é€ ï¼šä¾æ¬¡è€ƒè™‘æ¯ä¸ªå˜é‡ï¼Œé€‰æ‹© $\text{SCC}$ ç¼–å·è¾ƒå°é‚£ä¸ªå€¼ï¼Œé‚£ä¹ˆåŒä¸€å˜é‡ä¸ä¼šç›´æ¥å†²çªï¼Œå‡è®¾å…ˆå‰çš„ç‚¹ $v$ æ¨å‡ºäº† $\overline{u}$ï¼Œå¹¶ä¸” $\overline{u} \rightarrow u$ï¼Œå› ä¸ºåˆšåˆšæåˆ°çš„æ€§è´¨ï¼Œä¸€å®šæœ‰ $u\rightarrow \overline{v}$ï¼Œæˆ‘ä»¬ä¸€å®šä¼šé€‰æ‹“æ‰‘åºè¾ƒå¤§çš„ $\overline{v}$ï¼Œå› æ­¤é€‰æ‹©ä¸ä¼šå†²çªã€‚</p>
<h2 id="20220325"><a href="#20220325" class="headerlink" title="20220325"></a>20220325</h2><h3 id="CF1656D"><a href="#CF1656D" class="headerlink" title="CF1656D"></a>CF1656D</h3><h4 id="é¢˜æ„ï¼š-2"><a href="#é¢˜æ„ï¼š-2" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><ul>
<li><p>æ‚¨æœ‰ä¸€ä¸ª $n$ï¼Œæ‚¨éœ€è¦æ‰¾ä¸€ä¸ª $k \in[2,\infty)$ï¼Œä½¿å¾— $n$ å¯ä»¥è¢«è¡¨ç¤ºä¸º $k$ ä¸ªæ¨¡ $k$ æ„ä¹‰ä¸‹ä¸åŒçš„æ•°ï¼Œå¤šè§£å¯ä»¥è¾“å‡ºä»»æ„ä¸€ä¸ªã€‚</p>
</li>
<li><p>å¤šæµ‹ $T\leq 10^5,n\leq10^{18}$</p>
</li>
</ul>
<h4 id="æ€è€ƒï¼š-6"><a href="#æ€è€ƒï¼š-6" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>å› ä¸ºè¦æ‰¾çš„ $k$ ä¸ªæ•°æ¨¡ $k$ æ„ä¹‰ä¸‹ä¸åŒï¼Œæˆ‘ä»¬åˆçŸ¥é“ä»»æ„ä¸€ä¸ªæ•° $a$ éƒ½å¯ä»¥è¡¨ç¤ºä¸º $a&#x3D;b \times k +r$ï¼Œæ‰€ä»¥ä¸å¦¨å…ˆæŠŠæ¨¡ $k$ çš„ä½™æ•°å’Œï¼Œä¹Ÿå°±æ˜¯ä¸Šå¼ä¸­çš„ $r$ æå–å‡ºæ¥ï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„å¼å­ã€‚ä¸‹é¢è®¾ $n$ ä¸º $k$ ä¸ªæ•°çš„å’Œã€‚<br>$$<br>n &#x3D; c\times k + \dfrac{k\times(k+1)}{2}<br>$$<br>å…¶ä¸­ $c$ è¡¨ç¤ºè¿™ $k$ ä¸ªæ•°å¯¹åº” $b$ çš„å’Œã€‚åˆ†æ¯è®©äººå¾ˆä¸çˆ½ï¼Œæ‰€ä»¥ä¹˜è¿‡å»ã€‚è‡³äºä¸ºä»€ä¹ˆæ˜¯ $(k+1)\times k$ï¼Œæ˜¯ä¸ºäº†è®© $c$ å¯ä»¥å–åˆ° $[0,\infty)$<br>$$<br>2n &#x3D; (2c+k+1)\times k<br>$$<br>$2n$ çš„ä¸¤ä¸ªå› å­å¥‡å¶æ€§ä¸åŒï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬çš„ $n$ ä¸ºå¥‡æ•°å°±å¯ä»¥ç›´æ¥ä»¤ $k&#x3D;2$ï¼Œå¦åˆ™æˆ‘ä»¬æ¯æ¬¡ä»¤ $k$ å– $2,4,8,\cdots$,ç›´åˆ° $\dfrac{2n}{k}$ ä¸ºå¥‡æ•°ä¸ºæ­¢ï¼Œè¿™ä¸ªæ—¶å€™è®° $res &#x3D; \dfrac{2n}{k}$ï¼Œå¦‚æœ $res$ è¾ƒå¤§ï¼Œåˆ™å–å¯¹åº”çš„ $k$ï¼Œå¦åˆ™å– $k&#x3D;res$ã€‚</p>
<p>æ³¨æ„ç‰¹åˆ¤æ‰ä¸€äº›è¾¹ç•Œæƒ…å†µï¼Œæ¯”å¦‚ $2$ çš„æ¬¡å¹‚ï¼Œ$2$ çš„æ¬¡å¹‚ï¼Œè¿˜æœ‰ $2$ çš„æ¬¡å¹‚ã€‚</p>
<h4 id="å‚è€ƒä»£ç "><a href="#å‚è€ƒä»£ç " class="headerlink" title="å‚è€ƒä»£ç "></a>å‚è€ƒä»£ç </h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1000000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(_type &amp;x)</span></span>&#123;</span><br><span class="line">	x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="number">45</span>&amp;&amp;(ch&gt;<span class="string">&#x27;9&#x27;</span>||ch&lt;<span class="string">&#x27;0&#x27;</span>))ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(ch==<span class="number">45</span>)&#123;f=<span class="number">-1</span>,ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;<span class="function"><span class="type">void</span> <span class="title">cmin</span><span class="params">(_type &amp;a,_type b)</span></span>&#123;a=<span class="built_in">min</span>(a,b);&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;<span class="function"><span class="type">void</span> <span class="title">cmax</span><span class="params">(_type &amp;a,_type b)</span></span>&#123;a=<span class="built_in">max</span>(a,b);&#125;</span><br><span class="line"><span class="type">int</span> i,j,k,n,s,t,m;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">read</span>(t);</span><br><span class="line">	<span class="keyword">while</span>(t--)&#123;</span><br><span class="line">		<span class="built_in">read</span>(n);<span class="type">int</span> ans=<span class="number">-1</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;<span class="number">1ll</span>&lt;&lt;<span class="number">62</span>;i*=<span class="number">2</span>)&#123;</span><br><span class="line">			<span class="type">int</span> res=<span class="number">2</span>*n/i;</span><br><span class="line">			<span class="keyword">if</span>(res%<span class="number">2</span>)&#123;</span><br><span class="line">				<span class="keyword">if</span>(res&gt;i)&#123;</span><br><span class="line">					ans=i;</span><br><span class="line">					<span class="keyword">break</span>;	</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="keyword">else</span>&#123;</span><br><span class="line">					ans=res;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(ans==<span class="number">1</span>)<span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="CF1656E"><a href="#CF1656E" class="headerlink" title="CF1656E"></a>CF1656E</h3><h4 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><ul>
<li>æ‚¨æœ‰ä¸€æ£µ $n$ ä¸ªç‚¹çš„æ— å‘æ— æ ¹æ ‘ï¼Œæ‚¨éœ€è¦ä¸ºæ¯ä¸ªç‚¹å®‰æ’ä¸€ä¸ªæƒå€¼ $a_i\in[-10^5,10^5]$ï¼Œä½¿å¾—åˆ æ‰ä»»æ„ä¸€ä¸ªç‚¹ä¹‹åå‰©ä¸‹è¿é€šå—çš„æƒå€¼å’Œç›¸åŒï¼Œæ³¨æ„å®‰æ’çš„æƒå€¼ä¸èƒ½ä¸º $0$ã€‚</li>
<li>å¤šæµ‹ $T\leq 10^4,\sum n \leq 10^5$</li>
</ul>
<h4 id="æ€è€ƒ-2"><a href="#æ€è€ƒ-2" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>è¯ˆéª—é¢˜ã€‚æˆ‘ä»¬è€ƒè™‘æŒ‡å®šä¸€ä¸ªæ ¹ï¼Œå°±è®©å®ƒæ˜¯ $1$ï¼Œç„¶åéšä¾¿åˆ ä¸€ä¸ªç‚¹ $u$ï¼Œé‚£ä¹ˆ $u$ çš„æ‰€æœ‰å„¿å­çš„å­æ ‘éƒ½å¿…é¡»æœ‰åŒä¸€ä¸ªå€¼ï¼Œæˆ‘ä»¬å¯ä»¥å°è¯•å®‰æ’æ¯ä¸€æ£µå­æ ‘çš„æƒå€¼å’Œï¼Œè¿™æ˜¯å¯ä»¥åšåˆ°çš„ï¼Œå› ä¸ºå¯ä»¥è®©æ ¹æ§åˆ¶è¿™ä¸ªå€¼ã€‚ä¸å¦¨å®‰æ’æ¯é¢—å­æ ‘çš„æƒå€¼å’Œä¸º $1$ï¼Œ é‚£ä¹ˆæˆ‘ä»¬å†å®‰æ’æ•´ä¸ªæ ‘çš„æƒå€¼å’Œä¸º $2$ï¼Œå°±å¯ä»¥è®©åˆ æ‰æ¯ä¸ªç‚¹ $u$ åå‰©ä¸‹çš„è¿é€šå—æƒå€¼å’Œç›¸åŒã€‚$u$ çš„æ‰€æœ‰å„¿å­å­æ ‘çš„æƒå€¼å’Œéƒ½ä¸º $1$ï¼Œè€Œé™¤å¼€ $u$ çš„å­æ ‘åçš„é‚£ä¸ªè¿é€šå—çš„æƒå€¼å’Œå°±æ˜¯æ•´æ£µæ ‘çš„æƒå€¼å’Œ $2$ï¼Œå‡å» $u$ å­æ ‘çš„æƒå€¼å’Œï¼Œå°±æ˜¯ $1$ï¼Œä¹Ÿå’Œ $u$ æ‰€æœ‰å„¿å­çš„å­æ ‘çš„æƒå€¼å’Œç›¸åŒã€‚</p>
<p>ä½†æ˜¯æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœä¸€ä¸ªç‚¹ $u$ åªæœ‰ä¸€ä¸ªå„¿å­ï¼Œé‚£ä¹ˆ $u$ çš„æƒå€¼ä¼šè¢«å®‰æ’ä¸º $0$ï¼Œæ˜¯ä¸åˆæ³•çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹å®‰æ’çš„æ–¹å¼ï¼Œå¯¹äºä¸€ä¸ªç‚¹ï¼Œè®¾å®ƒå­æ ‘çš„æƒå€¼å’Œä¸º $x$ï¼Œ å¹¶ä¸”å®ƒæ‰€æœ‰å„¿å­çš„å­æ ‘çš„æƒå€¼å’Œå‡ä¸º $y$ï¼Œè€Œä¸”æ•´æ£µæ ‘çš„æƒå€¼å’Œä¸º $x+y$ã€‚è¿™æ˜¯åˆæ³•çš„å¿…è¦æ¡ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦è®© $a_i \neq0$ï¼Œæ‰€ä»¥å®‰æ’æ ¹çš„æƒå€¼ä¸º $0$ï¼Œå…¶å®ƒç‚¹æŒ‰æ·±åº¦æ¨¡ $2$ï¼Œçš„å€¼å®‰æ’ $-1$ å’Œ $1$ å³å¯ã€‚</p>
<h4 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h4><figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> INF 1000000000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> LL long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pii pair<span class="string">&lt;int,int&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">read</span><span class="params">(_type &amp;x)</span></span>&#123;</span><br><span class="line">	x=<span class="number">0</span>;<span class="type">int</span> f=<span class="number">1</span>;<span class="type">char</span> ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">while</span>(ch!=<span class="number">45</span>&amp;&amp;(ch&gt;<span class="string">&#x27;9&#x27;</span>||ch&lt;<span class="string">&#x27;0&#x27;</span>))ch=<span class="built_in">getchar</span>();</span><br><span class="line">	<span class="keyword">if</span>(ch==<span class="number">45</span>)&#123;f=<span class="number">-1</span>,ch=<span class="built_in">getchar</span>();&#125;</span><br><span class="line">	<span class="keyword">while</span>(ch&lt;=<span class="string">&#x27;9&#x27;</span>&amp;&amp;ch&gt;=<span class="string">&#x27;0&#x27;</span>)&#123;x=x*<span class="number">10</span>+ch<span class="number">-48</span>;ch=<span class="built_in">getchar</span>();&#125;x*=f;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;<span class="function"><span class="type">void</span> <span class="title">cmin</span><span class="params">(_type &amp;a,_type b)</span></span>&#123;a=<span class="built_in">min</span>(a,b);&#125;</span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> _type&gt;<span class="function"><span class="type">void</span> <span class="title">cmax</span><span class="params">(_type &amp;a,_type b)</span></span>&#123;a=<span class="built_in">max</span>(a,b);&#125;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">10</span>;</span><br><span class="line"><span class="type">int</span> i,j,k,n,s,t,m;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; e[N];</span><br><span class="line"><span class="type">int</span> val[N],fa[N],dep[N],deg[N],tar[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span>&#123;</span><br><span class="line">	<span class="keyword">if</span>(u==s)tar[u]=val[u]=<span class="number">0</span>;</span><br><span class="line">	<span class="keyword">else</span> tar[u]=val[u]=dep[u]%<span class="number">2</span>?<span class="number">1</span>:<span class="number">-1</span>;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> v:e[u])&#123;</span><br><span class="line">		<span class="keyword">if</span>(fa[u]==v)<span class="keyword">continue</span>;</span><br><span class="line">		dep[v]=dep[u]+<span class="number">1</span>,fa[v]=u;<span class="built_in">dfs</span>(v);val[u]-=tar[v];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">read</span>(t);</span><br><span class="line">	<span class="keyword">while</span>(t--)&#123;</span><br><span class="line">		<span class="built_in">read</span>(n);dep[<span class="number">1</span>]=<span class="number">1</span>;s=<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)e[i].<span class="built_in">clear</span>(),val[i]=<span class="number">0</span>,tar[i]=deg[i]=<span class="number">0</span>,fa[i]=<span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">			<span class="type">int</span> x,y;<span class="built_in">read</span>(x),<span class="built_in">read</span>(y);</span><br><span class="line">			e[x].<span class="built_in">push_back</span>(y),e[y].<span class="built_in">push_back</span>(x);</span><br><span class="line">			deg[x]++,deg[y]++;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="keyword">if</span>(deg[i]&gt;deg[s])s=i;</span><br><span class="line">		<span class="built_in">dfs</span>(s);</span><br><span class="line">		<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)<span class="built_in">printf</span>(<span class="string">&quot;%d &quot;</span>,val[i]);</span><br><span class="line">		<span class="built_in">puts</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">		</span><br><span class="line">	&#125; </span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="CF1656F"><a href="#CF1656F" class="headerlink" title="CF1656F"></a>CF1656F</h3><h4 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a>é¢˜æ„</h4><ul>
<li><p>æ‚¨æœ‰ $n$ ä¸ªç‚¹ï¼Œæ¯ä¸ªç‚¹æœ‰ä¸€ä¸ªæƒå€¼ $a_i$ï¼Œå®šä¹‰ä¸€å¼ æœ‰æƒæ— å‘å®Œå…¨å›¾ $K(t)$ ä¸ºæ¯ä¸ªç‚¹ $i$ å‘ $j$ è¿ä¸€æ¡æƒå€¼ä¸º $a_i\times a_j+(a_i+a_j)\times t$ çš„æ— å‘è¾¹åæ‰€æ„æˆçš„å›¾ï¼Œå®šä¹‰ $f(t)$ ä¸º $K(t)$ æœ€å°ç”Ÿæˆæ ‘çš„æƒå€¼å’Œã€‚æ‚¨éœ€è¦å¯¹æ‰€æœ‰çš„å®æ•° $t$ æ±‚å‡º $f(t)$ çš„æœ€å¤§å€¼å¹¶è¾“å‡ºå®ƒï¼Œå¦‚æœæœ€å¤§å€¼ä¸æ”¶æ•›ï¼Œé‚£ä¹ˆè¾“å‡º <code>INF</code>ã€‚</p>
</li>
<li><p>å¤šæµ‹ï¼Œ$T\leq 10^4,\sum n\leq 2\times 10^5,-10^6\leq a_i\leq 10^6$</p>
</li>
</ul>
<h4 id="æ€è€ƒ-3"><a href="#æ€è€ƒ-3" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p><del>åœºä¸Šå·®é‚£ä¹ˆä¸€ç‚¹ç‚¹å°± 15Ton äº†</del></p>
<p>ä¸€ä¸ªç“¶é¢ˆåœ¨æ’åºçš„çº¿æ€§åšæ³•ã€‚  </p>
<p>è®° $d_i$ è¡¨ç¤ºç‚¹ $i$ çš„åº¦æ•°ã€‚  </p>
<p>åˆ¤æ–­ $\text{INF}$ æ˜¯ç®€å•çš„ï¼Œåªéœ€è¦çœ‹èƒ½ä¸èƒ½å‡‘å‡º $\sum a_i\times d_i$ åˆ†åˆ«ä¸ºæ­£å’Œè´Ÿæˆ–è€… $0$ å°±è¡Œï¼Œå¦‚æœå‡‘ä¸å‡ºæ¥ï¼Œä»¤ $t$ ä¸ºæ­£æ— ç©·æˆ–è€…è´Ÿæ— ç©·ï¼Œç„¶åå®ƒå°±ä¸æ”¶æ•›äº†ã€‚</p>
<p>ç°åœ¨å·²çŸ¥æœ‰è§£ã€‚</p>
<p>è€ƒè™‘å›ºå®šä¸€ä¸ª $t$ åæ€ä¹ˆå¿«é€Ÿæ±‚ $\text{MST}$ã€‚åšä¸ªæ’ç­‰å˜å½¢ï¼Œæƒå€¼ä¸º $(a_i+t)\times (a_j+t)-t^2$ï¼ŒæŠŠ $t^2$ ç»™æ‰”æ‰ã€‚</p>
<p>ç»“è®ºæ˜¯æ’åºåæŒ‰æ­£è´Ÿæ€§æ–­å¼€ï¼Œ$a_1$  å‘æ‰€æœ‰ $a_i$ å¤§äº $0$ çš„è¿è¾¹ï¼Œ $a_n$ å‘æ‰€æœ‰ $a_i$ å°äº $0$ çš„è¿è¾¹ï¼Œ$0$ æ— æ‰€è°“ã€‚</p>
<p>è¯æ˜å¯ä»¥è€ƒè™‘ <code>Prime</code> ç®—æ³•çš„è¿‡ç¨‹ï¼Œæœ€å¼€å§‹ä¸€å®šæ˜¯ $a_1$ åˆ° $a_n$ã€‚ç„¶ååé¢ä¸ä¼šå–åˆ°æ­£è´Ÿæ€§ç›¸åŒçš„ï¼Œå¹¶ä¸”ä¸€ä¸ªç‚¹ä¸€å®šæ˜¯è¿å‘ $a_1$ æˆ–è€… $a_n$ã€‚</p>
<p>å¦‚æœå¤„ç†ä¸€ä¸ªå‰ç¼€å’Œï¼ŒçŸ¥é“æ­£è´Ÿäº¤ç•Œçš„ä½ç½®ä¹‹åå¯ä»¥å¿«é€Ÿç®—ï¼Œä»å°åˆ°å¤§æšä¸¾ $t$ï¼Œç„¶ååŒæŒ‡é’ˆç»´æŠ¤äº¤ç•Œå¤„ã€‚</p>
<p>å¯ä»¥è¯æ˜ $t$ ä¸€å®šå–åˆ°æ¯ä¸ª $-a_i$ã€‚å¦‚æœå¤¹åœ¨ä¸¤å¨ä¸­é—´ï¼Œé‚£ä¹ˆç”±äºå…·ä½“é€‰å“ªäº›è¾¹æ˜¯å›ºå®šçš„ï¼Œæ ¹æ® $\sum a_i\times d_i$ æ­£è´Ÿæ€§è°ƒæ•´å³å¯ã€‚</p>
<p>ä¸ä¼šå–åˆ° $[a_1,a_n]$ å¤–é¢å»ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åˆ¤äº†æ— è§£ï¼Œæ‰€ä»¥å–åˆ°è¾¹ç•Œå¤–é¢æ—¶ $\sum a_i\times d_i$  çš„æ­£è´Ÿæ€§ä¼šå¯¼è‡´å‘é‡Œé¢è°ƒæ•´æ›´ä¼˜ã€‚</p>
<h2 id="20220329"><a href="#20220329" class="headerlink" title="20220329"></a>20220329</h2><h3 id="HaltOJ129-Powerful-Number-ç­›"><a href="#HaltOJ129-Powerful-Number-ç­›" class="headerlink" title="HaltOJ129(Powerful Number ç­›)"></a>HaltOJ129(Powerful Number ç­›)</h3><h4 id="æ€è€ƒ-4"><a href="#æ€è€ƒ-4" class="headerlink" title="æ€è€ƒ:"></a>æ€è€ƒ:</h4><p>æ‰“ä¸ªè¡¨å‘ç° $f$ æ˜¯ç§¯æ€§å‡½æ•°ã€‚</p>
<p>ç„¶å $f(p^c)$ æ˜¯å¥½æ±‚çš„ï¼Œè€ƒè™‘äºšçº¿æ€§ç­›æ³•ã€‚</p>
<p>æˆ‘ä¹Ÿä¸çŸ¥é“ä¸ºå•¥ä¼šæƒ³åˆ° PN ç­›ï¼Œæ€»ä¹‹è¿™ç§ä¸œè¥¿å„ç§ç­›æ³•éƒ½å¯ä»¥å°è¯•ä¸€ä¸‹ã€‚</p>
<p>PN ç­›å’Œå…¶å®ƒäºšçº¿æ€§ç­›æ³•ä¸€æ ·ï¼Œæ˜¯ç”¨æ¥æ±‚ä¸€äº›ç§¯æ€§å‡½æ•°çš„å‰ç¼€å’Œçš„ï¼Œå®ƒçš„å…³é”®åœ¨äºæ„é€ ä¸€ä¸ªå¥½æ±‚çš„å‰ç¼€å’Œçš„ $g$ï¼Œæ»¡è¶³ $g(p)&#x3D;f(p)$ï¼Œç„¶åæ„é€ ä¸€ä¸ª $h$ ï¼Œæ»¡è¶³ $f&#x3D;h * g$ï¼Œä¹˜æ³•ä¸ºè¿ªåˆ©å…‹é›·å·ç§¯ã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬æ„é€  $g(x)&#x3D;1$</p>
<p>ç§¯æ€§å‡½æ•°æœ‰ä¸ªæ€§è´¨ï¼Œ$f(1)&#x3D;1$ï¼Œæ‰€ä»¥å±•å¼€ä¸‹ $f$ï¼Œå‘ç° $f(p)&#x3D;1&#x3D;h(1)*g(p)+h(p)*g(1)$ï¼Œç„¶å $h(p)&#x3D;0$ï¼Œç”±äº $h$ ä¹Ÿæ˜¯ä¸ªç§¯æ€§å‡½æ•°ï¼ˆè¿ªåˆ©å…‹é›·å·ç§¯çš„æ€§è´¨ï¼‰ï¼Œæ‰€ä»¥ $h$ åªä¼šåœ¨ PN å¤„æœ‰å–å€¼ï¼ŒPN çš„å®šä¹‰ä¸ºæ¯ä¸ªè´¨å› å­æ¬¡æ•°éƒ½å¤§äºç­‰äº  $2$  çš„æ•°ã€‚</p>
<p>å¯ä»¥è¯æ˜æ‰€æœ‰æ¯” $n$ å°çš„ PN ä¸ªæ•°æ˜¯ $O(\sqrt n)$ çš„ ã€‚</p>
<p>å¯ä»¥é¢„å¤„ç† $\sqrt n$ ä»¥å†…çš„æ‰€æœ‰è´¨æ•°ï¼Œç„¶åæšä¸¾æŒ‡æ•°å¾—åˆ°æ¯ä¸ª PNï¼Œè¿™ä¸ª $dfs$ çš„è¿‡ç¨‹ä¸­å¯ä»¥è®°å½•ä¸€ä¸‹å¯¹åº”çš„ $h$ï¼Œ$h$ çš„è½¬ç§»æ˜¯å¥½åšçš„ï¼Œå› ä¸ºåªéœ€è¦æ±‚ $h(p^c)$ã€‚</p>
<p>è¿™é‡Œä¸éš¾å‘ç° $h(p^c)&#x3D;f(p^c)-f(p^{c-1})$ã€‚</p>
<p>åŸå› æ˜¯ $g$ å®é™…ä¸Šæ˜¯ $1$ï¼Œè€Œ $f &#x2F; 1 &#x3D; f * \mu$</p>
<h2 id="20220331"><a href="#20220331" class="headerlink" title="20220331"></a>20220331</h2><h3 id="20220330è€ƒè¯•T2"><a href="#20220330è€ƒè¯•T2" class="headerlink" title="20220330è€ƒè¯•T2"></a><a href="https://cwoi.com.cn/contest/C39/problem/A">20220330è€ƒè¯•T2</a></h3><h4 id="æ€è€ƒ-5"><a href="#æ€è€ƒ-5" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>é™åˆ¶ä¸å¥½å¼„ï¼Œè€ƒè™‘è½¬åŒ–é™åˆ¶ï¼Œä¸éš¾å‘ç°ï¼Œå¦‚æœå»ºå›¾ï¼Œå¹¶ä¾æ¬¡åŠ å…¥æœ‰å‘è¾¹ï¼Œé‚£ä¹ˆä»»æ„ä¸€ä¸ªæ—¶åˆ»ï¼Œéƒ½éœ€è¦æ»¡è¶³å½“å‰å›¾åŠå…¶è¡¥å›¾éƒ½æ˜¯ä¸€ä¸ªä¼ é€’é—­åŒ…ï¼Œå³ï¼Œå¦‚æœèƒ½é—´æ¥ $a\rightarrow b$ ï¼Œé‚£ä¹ˆ $a,b$ æœ‰è¾¹ã€‚è¿™æ ·çš„å›¾ä¸æ˜¯å¾ˆå¤šï¼Œæ˜¯ $n!$ ä¸ªçš„ï¼Œåªéœ€è¦è€ƒè™‘å›¾ä¹‹é—´çš„è½¬ç§»å°±è¡Œã€‚</p>
<p>è¿™æ ·çš„å›¾å’Œä¸€ä¸ª $n$ çš„æ’åˆ—ä¸€ä¸€å¯¹åº”ï¼Œæ„é€ æ–¹æ¡ˆä¸ºå¦‚æœ $a,b$ ä¸ºé€†åºå¯¹ï¼Œé‚£ä¹ˆåŠ å…¥ä¸€æ¡è¾¹ $(a,b)$ã€‚åŠ å…¥ä¸€æ¡è¾¹æ—¶ï¼Œåªéœ€è¦æšä¸¾ç›¸é‚»çš„é€†åºå¯¹å¹¶äº¤æ¢ï¼Œè½¬ç§»å¯ä»¥åº·æ‰˜å±•å¼€å¾—åˆ°äº¤æ¢åçš„ç¼–å·ã€‚é™åˆ¶ä¹Ÿæ¯”è¾ƒå¥½åšï¼Œè½¬ç§»çš„æ—¶å€™çœ‹çœ‹å¼ºåˆ¶åœ¨å‰é¢çš„è¾¹åœ¨ä¸åœ¨é‡Œé¢å°±è¡Œã€‚</p>
<p>å¤æ‚åº¦ä¸º $O(n!\times n \times (n+m))$ï¼Œå¸¸æ•°è¾ƒå°ï¼Œå¯ä»¥è¿‡ã€‚</p>
<h2 id="20220402"><a href="#20220402" class="headerlink" title="20220402"></a>20220402</h2><h3 id="20220401è€ƒè¯•T1"><a href="#20220401è€ƒè¯•T1" class="headerlink" title="20220401è€ƒè¯•T1"></a><a href="https://cwoi.com.cn/contest/C41/problem/A">20220401è€ƒè¯•T1</a></h3><h4 id="æ€è€ƒ-6"><a href="#æ€è€ƒ-6" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>å¯¹äºè¿™ç§ç¿»è½¬çš„åšå¼ˆé—®é¢˜ï¼Œå…¶å®éƒ½å¯ä»¥åšä¸€ä¸ªè½¬åŒ–ï¼šä¸è¦ç¿»è½¬é¢œè‰²ï¼Œè€Œæ˜¯åœ¨æ¯ä¸ªç¿»è½¬çš„åœ°æ–¹å†æ”¾ä¸€ä¸ªæ£‹å­ï¼Œè¿™æ ·ä¸ä¼šæ”¹å˜æ¸¸æˆçš„èƒœè´Ÿæ€§ï¼Œå› ä¸ºå¦‚æœåŸå¤„æ²¡æœ‰æ£‹å­ï¼Œé‚£ä¹ˆç­‰æ•ˆï¼Œå¦‚æœæœ‰æ£‹å­ï¼Œé‚£ä¹ˆæœ‰ä¸¤ä¸ªï¼Œåœ¨ $SG$ çš„æ„ä¹‰ä¸‹ï¼Œè¿™æ˜¯å¯ä»¥æŠµæ¶ˆçš„ã€‚å¦‚æœä»¥ç»„åˆæ–¹å¼ç†è§£ï¼Œé‚£ä¹ˆå› ä¸ºæ”¾äº†ä¹‹åå¦‚æœæœ‰äººæ“ä½œäº†ï¼Œé‚£ä¹ˆå¦ä¸€ä¸ªäººæŠŠå®ƒçš„æ“ä½œå¤åˆ¶ä¸€éå³å¯ï¼Œç”±äºä¸¤ä¸ªäººéƒ½æ˜¯æœ€ä¼˜æ“ä½œï¼Œæ‰€ä»¥å¯ä»¥æŠµæ¶ˆã€‚</p>
<p>æœ‰äº†è¿™ä¸ªè½¬åŒ–ï¼Œæ¯ä¸ªæ£‹å­éƒ½å˜æˆäº†ä¸€ä¸ªç‹¬ç«‹çš„æ¸¸æˆï¼Œè¯¥å±€é¢çš„ $SG$ å€¼å°±ä¸éš¾è®¡ç®—äº†ï¼ŒæŒ‰ç…§å®šä¹‰è®¡ç®—å‡ºæ¯ä¸ªä½ç½®çš„ $SG$ å€¼ç„¶åå¼‚æˆ–æŸ¥è¡¨å³å¯ã€‚</p>
<h3 id="20220401è€ƒè¯•T3"><a href="#20220401è€ƒè¯•T3" class="headerlink" title="20220401è€ƒè¯•T3"></a><a href="https://cwoi.com.cn/contest/C41/problem/C">20220401è€ƒè¯•T3</a></h3><h4 id="æ€è€ƒ-7"><a href="#æ€è€ƒ-7" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>åœºä¸Šå†™äº†ä¸ª $O(n^3)$ å¡å¸¸å¡è¿‡å»äº†ï¼Œå®é™…ä¸Š $O(n^2)$ çš„æœ‰ç‚¹éš¾æƒ³ï¼Œå®ƒæ˜¯æŠŠæ„é€ è¡¨è¾¾å¼çš„è¿‡ç¨‹è§†ä½œäº†ä¸€ä¸ªæ·»åŠ å·¦å³æ‹¬å·çš„è¿‡ç¨‹ï¼Œæ€»ä¹‹éå¸¸ç¥ä»™ã€‚</p>
<p>æœ‰ä¸ªå¯¹äºåŒºé—´ $dp$ çš„å¸¸æ•°ä¼˜åŒ–æ€è·¯ï¼Œå¯ä»¥æ”¹å˜ä¸€ä¸‹æšä¸¾é¡ºåºï¼Œè®©æ•°ç»„è®¿é—®å°½é‡è¿ç»­ï¼Œä»¥ä¾¿æœ€å¤§ç¨‹åº¦åˆ©ç”¨å¥½ $L1$ï¼Œå¯ä»¥èŠ‚çœå¤§é‡å†…å­˜æ“ä½œæ—¶é—´ã€‚</p>
<p>å’•ä¸€ç¯‡å¸¸æ•°ä¼˜åŒ–æ–‡ç« ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>è®­ç»ƒé¢˜ç›®</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
      </tags>
  </entry>
  <entry>
    <title>åšé¢˜1</title>
    <url>/2022/07/12/%E5%81%9A%E9%A2%981/</url>
    <content><![CDATA[<h2 id="2022-2-7"><a href="#2022-2-7" class="headerlink" title="2022.2.7"></a>2022.2.7</h2><h3 id="CF1634E"><a href="#CF1634E" class="headerlink" title="CF1634E"></a>CF1634E</h3><h4 id="é¢˜æ„ï¼š"><a href="#é¢˜æ„ï¼š" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><p>ç»™å®šä¸€äº›æ•°ç»„ï¼Œé•¿åº¦éƒ½ä¸ºå¶æ•°ï¼Œéœ€è¦å°†æ¯ä¸ªæ•°ç»„çš„å…ƒç´ åˆ’åˆ†åˆ°ä¸¤ä¸ªå¯é‡é›†åˆé‡Œï¼Œè¦æ±‚ä¸¤ä¸ªé›†åˆç›¸åŒï¼Œé—®æ–¹æ¡ˆæˆ–è¾“å‡ºæ— è§£ï¼Œ$n,m&#x3D;10^5$ã€‚</p>
<h4 id="æ€è€ƒï¼š"><a href="#æ€è€ƒï¼š" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è€ƒè™‘æ¯ä¸ªæ•°ç»„å•ç‹¬åˆ’åˆ†ï¼Œä¸å¤ªè¡Œï¼Œæ‰€ä»¥ä¸èƒ½ä¸€ä¸ªæ•°ç»„ä¸€ä¸ªæ•°ç»„çš„è€ƒè™‘ï¼Œæ˜¾ç„¶æœ‰è§£çš„å¿…è¦æ¡ä»¶æ˜¯æ¯ä¸ªæ•°å­—ä¸ªæ•°ä¸ºå¶æ•°ã€‚æ‰€ä»¥ä¸€ä¸ªæ•°å­—ä¸€ä¸ªæ•°å­—çš„è€ƒè™‘ï¼Œå…¶å®ä¹Ÿä¸å¤ªè¡Œï¼Œå› ä¸ºè¿™å’Œåˆšåˆšé‚£ç§æ–¹æ³•æ˜¯æœ¬è´¨ä¸Šä¸€æ ·çš„ã€‚</p>
<p>æ³¨æ„åˆ°ä¹Ÿä¿è¯æ¯ä¸ªæ•°ç»„é•¿åº¦ä¸ºå¶æ•°<del>ï¼ˆè¿™ä¸æ˜¯åºŸè¯å—ï¼‰</del>ï¼Œéƒ½æ˜¯å¶æ•°ï¼Œä¸ç”±å¾—è®©æˆ‘ä»¬æƒ³åˆ°æ¬§æ‹‰å›è·¯ï¼Œæ‰€ä»¥å°è¯•å»ºå›¾ï¼Œæ¯ä¸ªä¸åŒçš„æ•°å’Œæ•°ç»„è§†ä¸ºä¸€ä¸ªç‚¹ï¼Œç”±æ•°ç»„å‘æ•°è¿è¾¹ï¼Œæ•°ç»„å†…å­˜åœ¨ä¸€ä¸ªæ•°ï¼Œå°±ç”±æ•°ç»„å‘è¿™ä¸ªæ•°è¿ä¸€æ¡è¾¹ï¼Œç°åœ¨éœ€è¦ç»™å›¾å®šå‘ä¸ºä¸€å¼ æ¬§æ‹‰å›¾ï¼Œæˆ‘ä»¬å°†æ•°ç»„å‘æ•°è¿çš„è¾¹æ˜¯ä¸ºå°†è¿™ä¸ªæ•°åˆ†åˆ°ç¬¬ä¸€ä¸ªé›†åˆï¼Œåä¹‹åˆ™ä¸ºç¬¬äºŒä¸ªï¼Œæ„é€ æ¬§æ‹‰å›¾å³å¯ã€‚</p>
<h4 id="å®ç°ä¸Šçš„é—®é¢˜ï¼š"><a href="#å®ç°ä¸Šçš„é—®é¢˜ï¼š" class="headerlink" title="å®ç°ä¸Šçš„é—®é¢˜ï¼š"></a>å®ç°ä¸Šçš„é—®é¢˜ï¼š</h4><p>å­˜è¾¹ç”¨ <code>set</code> å­˜ï¼Œä¸ç„¶ <code>TLE</code> æ²¡å•†é‡ã€‚</p>
<p>å›¾ä¸ä¸€å®šè”é€šï¼Œæ‰€ä»¥ä¸€å®šè¦å¤šèµ·ç‚¹ã€‚</p>
<h2 id="20220209"><a href="#20220209" class="headerlink" title="20220209"></a>20220209</h2><h3 id="22020208è€ƒè¯•-T1"><a href="#22020208è€ƒè¯•-T1" class="headerlink" title="22020208è€ƒè¯• T1"></a>22020208è€ƒè¯• T1</h3><h4 id="é¢˜æ„ï¼š-1"><a href="#é¢˜æ„ï¼š-1" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><p>å®šä¹‰çŸ©é˜µ $Mat_n$</p>
<ul>
<li>$n &#x3D; 0$ æ—¶ï¼Œä¸ºä¸€ä¸ª $1$</li>
<li>$n &gt; 0$ æ—¶ï¼Œå·¦ä¸Šè§’ä¸º $0$ çŸ©é˜µï¼Œå…¶ä½™éƒ¨åˆ†ä¸ºä¸‰ä¸ª $Mat_{n-1}$ã€‚</li>
</ul>
<p>åœ¨ä¸€ä¸ªå¹³é¢ä¸Šç”»å‡ºä¸¤ä¸ª $Mat_n$ï¼Œå·¦ä¸‹è§’åˆ†åˆ«ä¸º $(0,0),(x,y)$ï¼Œæ±‚éƒ½ä¸º $1$ çš„ä½ç½®æœ‰å¤šå°‘ä¸ªã€‚</p>
<h4 id="æ€è€ƒï¼š-1"><a href="#æ€è€ƒï¼š-1" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è€ƒè™‘æ—‹è½¬çŸ©é˜µè½¬åŒ–ä¸ºä½è¿ç®—è®¡æ•°é—®é¢˜ï¼Œè½¬åŒ–ä¸ºæ±‚æ•´æ•°å¯¹ $(i,j)$ æ»¡è¶³ <code>(i&amp;j) == 0 and ((i+x)&amp;(j-y)) == 0</code></p>
<p>è€ƒåœºä¸Šçœ‹åˆ°è¦é«˜ç²¾å°±æ¶¦äº†ï¼Œæ²¡æœ‰è®¤çœŸæ€è€ƒã€‚</p>
<p>å®é™…ä¸Šå¯ä»¥è€ƒè™‘ç±»ä¼¼ æ•°ä½dp çš„ç®—æ³•ï¼Œä¹Ÿä¸éš¾ã€‚</p>
<h3 id="22020208è€ƒè¯•-T2-åç¼€è‡ªåŠ¨æœºå¤ä¹ "><a href="#22020208è€ƒè¯•-T2-åç¼€è‡ªåŠ¨æœºå¤ä¹ " class="headerlink" title="22020208è€ƒè¯• T2(åç¼€è‡ªåŠ¨æœºå¤ä¹ )"></a>22020208è€ƒè¯• T2(åç¼€è‡ªåŠ¨æœºå¤ä¹ )</h3><h4 id="é¢˜æ„ï¼š-2"><a href="#é¢˜æ„ï¼š-2" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><p>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸² $s$ ï¼Œ$q$ æ¬¡è¯¢é—® $l,r$ï¼Œè¡¨ç¤ºæ‰€æœ‰ $[l,r]$ å¼€å¤´çš„å­ä¸²ä¸­æœ¬è´¨ä¸åŒçš„å­ä¸²ä¸ªæ•°ã€‚</p>
<p>$n,q &#x3D; 2 \times 10^5$</p>
<h4 id="æ€è€ƒ1ï¼š"><a href="#æ€è€ƒ1ï¼š" class="headerlink" title="æ€è€ƒ1ï¼š"></a>æ€è€ƒ1ï¼š</h4><p>è€ƒè™‘åç¼€è‡ªåŠ¨æœºæ±‚æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°çš„æ–¹å¼ï¼Œå‘ç°å®ƒå¯ä»¥åœ¨çº¿å®Œæˆã€‚</p>
<p>æ‰€ä»¥åç€å»ºåç¼€è‡ªåŠ¨æœºã€‚</p>
<p>å¯¹äº $r&#x3D;n$ çš„éƒ¨åˆ†åˆ†ï¼Œæ˜¾ç„¶å…ˆç¦»çº¿ï¼Œå¯ä»¥å»ºåç¼€è‡ªåŠ¨æœºæ—¶ç»Ÿè®¡ä¸‹æ¯ä¸€ä¸ªç»“å°¾çš„ç­”æ¡ˆï¼Œè¾“å‡ºå³å¯ã€‚</p>
<p>å¦‚æœ $r \neq n$ï¼Œé‚£ä¹ˆä¸å¦¨ä»ç„¶è€ƒè™‘åœ¨åç¼€è‡ªåŠ¨æœºä¸Šå¦‚ä½•ç»Ÿè®¡ç­”æ¡ˆã€‚</p>
<p>åç¼€è‡ªåŠ¨æœºæœ¬è´¨ä¸Šç»´æŠ¤çš„æ˜¯ $endpos$ é›†åˆï¼Œå¯¹äºä¸€ä¸ªè¯¢é—®ï¼Œå¦‚æœä¸€ä¸ª $endpos$ é›†åˆä¸­åŒ…å«ä¸€ä¸ªä½ç½® $x\in[l,r]$ï¼Œé‚£ä¹ˆè¿™ä¸ª $endpos$ é›†åˆæ‰€ä»£è¡¨çš„å­ä¸²åº”è¯¥è¢«è®¡å…¥è´¡çŒ®ã€‚</p>
<p>åç¼€è‡ªåŠ¨æœºä¸Šæ¯ä¸ªå­ä¸²ä»…åœ¨ä¸€ä¸ª $endpos$  é›†åˆä¸­å‡ºç°ï¼Œæ‰€ä»¥å¯ä»¥æ±‚å‡ºè‡³å°‘æœ‰ä¸€ä¸ªå…ƒç´ è¢«åŒ…å«çš„é›†åˆï¼Œå¹¶ç›´æ¥åŠ å’Œã€‚</p>
<p>è€ƒè™‘å¯¹äºæ¯ä¸ªè¯¢é—®è¯¥å¦‚ä½•ç»Ÿè®¡ç­”æ¡ˆï¼Œé™åˆ¶ä¸€å…±æœ‰ä¸¤ä¸ª  $l,r$ï¼Œå¹¶ä¸å¥½åšï¼Œç„¶è€Œæˆ‘ä»¬å‘ç°åç¼€è‡ªåŠ¨æœºæ˜¯åœ¨çº¿æ„å»ºçš„ï¼Œæ‰€ä»¥å¦‚æœå°†è¯¢é—®ç¦»çº¿ï¼Œé‚£ä¹ˆé™åˆ¶å°±åªå‰©ä¸‹ä¸€ä¸ª $r$ äº†ã€‚æˆ‘ä»¬åœ¨æ„å»ºåç¼€è‡ªåŠ¨æœºçš„åŒæ—¶åªéœ€è¦è®°å½•æ¯ä¸ª $endpos$ é›†åˆæœ€å°çš„å…ƒç´  $val$ï¼ŒæŸ¥è¯¢æ—¶æŸ¥è¯¢æ‰€æœ‰æ»¡è¶³ $val \leq r$ çš„é›†åˆçš„å­ä¸²æ•°é‡å’Œå³å¯ã€‚è€ƒè™‘ç»´æŠ¤ä¸€ä¸ªæ•°ç»„ $c$ï¼Œ$c[i]$ è¡¨ç¤º $val &#x3D; i$ çš„ $endpos$ é›†åˆå­ä¸²ä¸ªæ•°å’Œï¼Œç”¨ $BIT$  æŸ¥å‰ç¼€å’Œï¼Œç°åœ¨åªå‰©ä¸‹ä¿®æ”¹äº†ã€‚</p>
<p>è€ƒè™‘ $endpos$ æ ‘çš„æ€§è´¨ï¼Œå‘ç°ä¿®æ”¹æ“ä½œæ˜¯æŠŠä¸€æ®µåˆ°æ ¹çš„è·¯å¾„èµ‹å€¼ï¼ŒåŒæ—¶è¿˜æœ‰ä¿®æ”¹çˆ¶äº²ç­‰æ“ä½œï¼Œäºæ˜¯è€ƒè™‘åŠ¨æ€æ ‘ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ä¸€æ®µå®é“¾ä¸Šçš„é›†åˆï¼Œ$val$ éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥åœ¨æ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤ä¸€ä¸‹ $val,sum$ å€¼å³å¯ï¼Œæ³¨æ„ $push_down$ æ“ä½œæ—¶éœ€è¦æŠŠèµ‹å€¼ä¹Ÿ $push_down$ ä¸‹å»ã€‚</p>
<p>è¿™æ ·åšæœªå…æ˜¾å¾—æœ‰äº›éº»çƒ¦ï¼Œæˆ‘ä»¬è€ƒè™‘æœ€ç»ˆæ„å»ºçš„åç¼€è‡ªåŠ¨æœºï¼Œå€’åºæ¿€æ´» $endpos$ ä¸­æ¯ä¸€ä¸ªç‚¹ï¼Œè¿™æ ·å°±ä¸éœ€è¦ $Link$ å’Œ $Cut$ æ“ä½œï¼Œåªéœ€è¦å†™ $access$ å°±è¡Œã€‚</p>
<p>å®é™…ä¸Šæœªå¿…éœ€è¦ç”¨åç¼€æ ‘æ¥å®ç°ï¼Œé€šè¿‡æ¿€æ´»ç‚¹çš„æ–¹å¼ï¼Œæ ‘å·²ç»æ—¶é™æ€çš„äº†ï¼Œè¿™æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸€ä¸ªåŒºé—´æŸ“è‰²é—®é¢˜ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç›´æ¥é‡é“¾å‰–åˆ†ï¼Œåœ¨æ¯æ¡é‡é“¾ä¸Šå¼€ä¸ªæ ˆç»´æŠ¤æ–­ç‚¹ï¼Œè®°å½•ä¸‹å‰ç¼€å’Œã€‚</p>
<p>å¤æ‚åº¦éƒ½æ˜¯ $O(nlog_n^2)$ï¼Œä¸ªäººè®¤ä¸ºç±»ä¼¼åŠ¨æ€æ ‘çš„æ–¹æ³•ä¼šå¥½å†™ä¸€äº›ã€‚</p>
<h4 id="æ€è€ƒ2ï¼š"><a href="#æ€è€ƒ2ï¼š" class="headerlink" title="æ€è€ƒ2ï¼š"></a>æ€è€ƒ2ï¼š</h4><p>è€ƒè™‘ä½¿ç”¨åç¼€æ•°ç»„ï¼Œå›æƒ³åç¼€æ•°ç»„ç»Ÿè®¡ä¸åŒå­ä¸²ä¸ªæ•°çš„æ–¹å¼ï¼Œå®é™…ä¸Šå°±æ˜¯æ’åºåå‡æ‰ç›¸é‚»ä¸¤ä¸ªçš„ $lcp$ï¼Œäºæ˜¯å¯¹åŸä¸²åç¼€æ’åºï¼Œç„¶åç¦»çº¿è¯¢é—®è«é˜Ÿï¼Œæ‹¿ä¸ª <code>set</code> ç»´æŠ¤å½“å‰æ‰€æœ‰ä¸²çš„æ’åé›†åˆï¼Œå†æ¥ä¸ª $ST$ è¡¨è®¡ç®— $lcp$ï¼Œæ’å…¥å’Œåˆ é™¤éƒ½å¾ˆå¥½å†™ï¼Œå¤æ‚åº¦ $O(n\sqrt n \ log_n)$ï¼Œéš¾ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p>
<p>è€ƒè™‘ä¼˜åŒ–ï¼Œæœ‰ä¸€ä¸ªæŠ€å·§ï¼Œè¿™ç§éœ€è¦æŸ¥å‰é©±åç»§çš„ä¸œè¥¿ï¼Œå®é™…ä¸Šå¯ä»¥ç”¨é“¾è¡¨æï¼ŒåŠ å…¥ç›¸å¯¹å›°éš¾ä¸€äº›ï¼Œå› ä¸ºæˆ‘ä»¬ä¸çŸ¥é“åˆ°åº•åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼Œä½†åˆ é™¤å°±å¾ˆå®¹æ˜“äº†ï¼ŒåŒå‘é“¾è¡¨ä¸Šç›´æ¥åˆ å°±å®Œäº‹äº†ï¼Œæ‰€ä»¥å¯ä»¥å›æ»šè«é˜Ÿï¼Œéå¸¸æ— è„‘ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\sqrt n)$ã€‚</p>
<p>ç¨åŠ å¡å¸¸å³å¯é€šè¿‡ï¼Œ$ST$ è¡¨æŸ¥è¯¢å¸¸æ•°ç›¸å¯¹è¾ƒå¤§ï¼Œå¡å¸¸åº”è€ƒè™‘å°½é‡å‡å°‘æŸ¥è¯¢æ¬¡æ•°ã€‚</p>
<h2 id="20220210"><a href="#20220210" class="headerlink" title="20220210"></a>20220210</h2><h3 id="20220208è€ƒè¯•T3"><a href="#20220208è€ƒè¯•T3" class="headerlink" title="20220208è€ƒè¯•T3"></a>20220208è€ƒè¯•T3</h3><h4 id="æ¶å¿ƒçš„é¢˜æ„"><a href="#æ¶å¿ƒçš„é¢˜æ„" class="headerlink" title="æ¶å¿ƒçš„é¢˜æ„"></a><a href="https://cwoi.com.cn/contest/C15/problem/C">æ¶å¿ƒçš„é¢˜æ„</a></h4><h4 id="æ€è€ƒ"><a href="#æ€è€ƒ" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>å‘ç°ç”±äºç¼–å·è¿ç»­ï¼Œæ‰€ä»¥æœ€åç»è¿‡çš„ä¸€å®šæ˜¯ä¸€æ®µè¿ç»­åŒºé—´ã€‚æƒ³åˆ°å¯ä»¥æšä¸¾å³ç«¯ç‚¹ï¼ŒäºŒåˆ†å·¦ç«¯ç‚¹ã€‚</p>
<p>ä¸€ä¸ªåŒºåŸŸåˆ°å¦ä¸€ä¸ªåŒºåŸŸçš„è·¯å¾„å¯ä»¥åˆ†ä¸ºåŒºåŸŸåˆ°ä¸­è½¬ç«™å’Œä¸­è½¬ç«™åˆ°ä¸­è½¬ç«™ä¸¤éƒ¨åˆ†ï¼ŒåŒºåŸŸåˆ°ä¸­è½¬ç«™çš„æƒ…å†µå¯ä»¥åªè®¡ç®—åˆ°å·¦å³ä¸¤è¾¹æœ€è¿‘çš„ä¸­è½¬ç«™ï¼Œæ‰€ä»¥å®¹æ˜“è®¡ç®—ã€‚</p>
<p>æˆ‘ä»¬æŒ‰ç…§å³ç«¯ç‚¹é¡ºåºæ¿€æ´»ä¸­è½¬ç«™ï¼Œé—®é¢˜å°±æ˜¯è¦æœ€å°åŒ–å·¦ç«¯ç‚¹ã€‚</p>
<p>ä¸¤ä¸ªä¸­è½¬ç«™åªèƒ½é€šè¿‡åŒä¸€æ¡çº¿è¿æ¥ï¼ŒæŠŠæœ€ä½ç‚¹ä¹Ÿçœ‹æˆä¸­è½¬ç«™ï¼Œæ‰€ä»¥å¯ä»¥è®¤ä¸ºä»ä¸€ä¸ªä¸­è½¬ç«™åˆ°å¦ä¸€ä¸ªçš„ä»£ä»·ä¸ºä¸¤è€…æ‰€åœ¨åŒºåŸŸç¼–å·çš„è¾ƒå°å€¼ã€‚</p>
<p>ä¸­è½¬ç«™åˆ°ä¸­è½¬ç«™çš„è·ç¦»å¯ä»¥ <code>Floyd</code> æš´åŠ›ï¼Œæˆ‘ä»¬å°±å·²ç»è®¡ç®—å‡ºäº†æ¯å¯¹ä¸­è½¬ç«™ç‚¹ç›¸äº’æŠµè¾¾çš„ä»£ä»·ï¼Œæ‰€ä»¥äºŒåˆ†éƒ½ä¸éœ€è¦äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨è¿™ä¸ªä»£ä»·è®¡ç®—å‡ºæœ€ç»ˆç­”æ¡ˆã€‚</p>
<h4 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h4><p><code>Floyd</code> çš„æ—¶å€™ï¼Œå› ä¸ºåŠ å…¥çš„ä¸­è½¬ç«™å¹¶ä¸æ˜¯æŒ‰ä¸‹æ ‡é¡ºåºï¼Œæ‰€ä»¥éœ€è¦æ•´ä¸ªè·‘ä¸€éã€‚</p>
<h2 id="20220211"><a href="#20220211" class="headerlink" title="20220211"></a>20220211</h2><h3 id="20220211-æµ‹è¯•-T1"><a href="#20220211-æµ‹è¯•-T1" class="headerlink" title="20220211 æµ‹è¯• T1"></a>20220211 æµ‹è¯• T1</h3><h4 id="é¢˜æ„"><a href="#é¢˜æ„" class="headerlink" title="é¢˜æ„"></a><a href="https://cwoi.com.cn/contest/C18/problem/A">é¢˜æ„</a></h4><h4 id="æ€è€ƒ-1"><a href="#æ€è€ƒ-1" class="headerlink" title="æ€è€ƒ"></a>æ€è€ƒ</h4><p>è¿™é“é¢˜ç®—æ˜¯è€ƒåœºä¸Šæƒ³å‡ºæ¥çš„ï¼Œè€ƒåœºä¸Šæ‘¸äº†ä¸€ä¼šå„¿é±¼ï¼Œå‘ç°æœ‰ä¸ªåœ°æ–¹å‡äº†çš„æ—¶å€™åªå‰© $5min$ äº†ï¼Œæ‰€ä»¥ç´§æ€¥ä¿®å¤æˆäº†$50pts$ï¼Œå®é™…ä¸Šä¸ç®¡ç›´æ¥äº¤æœ‰ $80pts$ã€‚</p>
<p>å…ˆæŠŠæœ€ä¸Šé¢é‚£äº›æ²¡æœ‰çš„è¡Œåˆ æ‰ã€‚</p>
<p>è€ƒè™‘æ¯ä¸€è¡Œçš„å¯èƒ½æ€§ï¼Œåªæœ‰ç©¿è¿‡å’Œä¸ç©¿è¿‡ä¸¤ç§ï¼Œç©¿è¿‡åˆå¯ä»¥åˆ†ä¸ºå»çš„æ—¶å€™ç©¿è¿‡å’Œå›çš„æ—¶å€™ç©¿è¿‡ã€‚</p>
<p>æ¥çš„æ—¶å€™ç©¿è¿‡ï¼Œå›çš„æ—¶å€™ä¸€å®šä¸ä¼šç©¿è¿‡ï¼Œå› ä¸ºä¸€å®šä¸ä¼˜ï¼Œäºæ˜¯ä¸‰è¿›åˆ¶æšä¸¾ç©¿è¿‡çŠ¶æ€ï¼Œå¤§çš„è·¯å¾„æ¡†æ¶å·²ç»è¢«æ„å»ºå‡ºæ¥äº†ï¼Œç°åœ¨è¦è€ƒè™‘ç»è¿‡é‚£äº›æ²¡æœ‰ç©¿è¿‡çš„ç‚¹ã€‚</p>
<p>è¢«ç©¿è¿‡çš„è¡Œä¸ç”¨ç®¡ï¼Œç°åœ¨å°±å‰©æ²¡ç©¿è¿‡çš„è¡Œï¼Œæ¯ä¸€è¡Œå¯ä»¥ä»å·¦åˆ°å³ï¼Œä¹Ÿå¯ä»¥ä»å³åˆ°å·¦ï¼Œå¦‚æœä¸¤è¾¹éƒ½æœ‰ç»è¿‡ï¼Œè¿˜å¯ä»¥ä¸¤é¢åŒ…å¤¹ï¼Œç®—å‡ºæ¯ä¸€è¡Œçš„ç»“æœï¼Œç„¶ååŠ ä¸Šå»å°±è¡Œã€‚</p>
<p>è¿™æ ·å¯ä»¥æ‹¿åˆ° $80pts$ï¼Œå› ä¸ºå®ƒå¤„ç†ä¸äº†è¿™ç§æƒ…å†µã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3 7</span><br><span class="line">#.....#</span><br><span class="line">.#####.</span><br><span class="line">.#####.</span><br></pre></td></tr></table></figure>

<p>å®ƒä¼šç©¿è¿‡ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œï¼Œåˆ°ç¬¬ä¸‰è¡Œåç©¿è¿‡æˆ–è€…æ˜¯èµ°åˆ°åº•å†å›æ¥ï¼Œå®é™…ä¸Šåœ¨ç©¿è¿‡ç¬¬ä¸€è¡Œèµ°åˆ°ç¬¬äºŒè¡Œçš„æ—¶å€™å°±åº”è¯¥ä¸Šå»æ‹¿æ‰å³ä¸Šè§’ã€‚</p>
<p>æ‰€ä»¥æŠŠå¤§çš„è·¯å¾„ç”»å‡ºæ¥åï¼Œè®°å½•æ¯ä¸€ä¸ªè¾¹ç¼˜ä½ç½®æ˜¯å¦åˆ°è¾¾è¿‡ï¼Œè¿˜è¦è‡ªä¸‹è€Œä¸Š $dp$ ä¸€éæ±‚å‡ºç»è¿‡æ‰€æœ‰æœªç»è¿‡çš„ç‚¹çš„æœ€å°ä»£ä»·ã€‚</p>
<p>æä¾›ä¸€ç§æ€è·¯ï¼Œè®¾ $dp[i][j][k]$ è¡¨ç¤ºåˆ°ç¬¬ $i$ è¡Œï¼Œå·¦å³æœ€å‰é¢çš„å¯ä»¥å·²ç»ç»è¿‡çš„ç‚¹ä¸º $j,k$ çš„æœ€å°ä»£ä»·ï¼Œè½¬ç§»çš„æ—¶å€™çœ‹ $j,k$ æ˜¯å¦å¤§äº $i$ æˆ–è€… $i$ çš„ä¸¤ç«¯æ˜¯å¦å·²ç»ç»è¿‡ï¼Œå¦‚æœå¯è¡Œï¼Œå°±é€‰ç»è¿‡ä¸€è¡Œä¸‰ç§æ–¹æ¡ˆçš„æœ€å°å€¼ï¼Œå¦‚æœä¸è¡Œï¼Œå› ä¸ºä¸€å®šæœ‰ä¸€è¾¹å·²ç»ç»è¿‡ï¼Œæ‰€ä»¥åªè€ƒè™‘å¦ä¸€è¾¹æ˜¯å¦è¡¥å…¨å’Œä»ç»è¿‡çš„ç‚¹èµ°ä¸€éå†å›æ¥çš„æƒ…å†µï¼Œè¡¥å…¨çš„æ–¹æ¡ˆæœ‰ä¸¤ç§ï¼Œä»ä¸Šé¢å’Œä»ä¸‹é¢ï¼Œç›´æ¥è½¬ç§»å³å¯ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦ $O(n^3 * 3^n)$ï¼Œå®é™…ä¸Šå‰ªæåè·‘çš„é£å¿«ï¼Œ$10ms$ å°±è·‘å®Œäº†ã€‚</p>
<h2 id="20220212"><a href="#20220212" class="headerlink" title="20220212"></a>20220212</h2><h3 id="20220212æµ‹è¯•T2"><a href="#20220212æµ‹è¯•T2" class="headerlink" title="20220212æµ‹è¯•T2"></a>20220212æµ‹è¯•T2</h3><h4 id="é¢˜æ„-1"><a href="#é¢˜æ„-1" class="headerlink" title="é¢˜æ„"></a><a href="https://cwoi.com.cn/contest/C18/problem/B">é¢˜æ„</a></h4><h4 id="æ€è€ƒ-2"><a href="#æ€è€ƒ-2" class="headerlink" title="æ€è€ƒ:"></a>æ€è€ƒ:</h4><p>è€ƒè™‘ç›´æ¥ $dp$ è½¬ç§»ï¼Œè®¾ $dp[i][j][k][0&#x2F;1]$ è¡¨ç¤ºè€ƒè™‘å‰ $i$ ä¸ªæ•°ï¼Œ æ­£è‰²å­å·²ç»ç”¨äº† $j$ ä¸ªï¼Œåè‰²å­å·²ç»ç”¨äº† $k$ ä¸ªï¼Œæ˜¯å¦å·²ç»èµ¢äº†çš„æ–¹æ¡ˆæ•°ï¼Œç›´æ¥è½¬ç§»æ˜¯ $O(n^4 * t)$ çš„ï¼Œå¯ä»¥æ‹¿åˆ° $20pts$ çš„å¥½æˆç»©ã€‚</p>
<p>è€ƒè™‘ä¼˜åŒ–ï¼Œè½¬ç§»å¼å­æ˜¯ï¼š</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i1=<span class="number">0</span>;i1&lt;=n;i1++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i2=<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=i1;j1++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j2=<span class="number">0</span>;j2&lt;=i2;j2++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(i&lt;=t&amp;&amp;i1-j1&gt;i2-j2)</span><br><span class="line">    <span class="built_in">Inc</span>(dp[i][i1][i2][<span class="number">1</span>],<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2][<span class="number">0</span>]*C[n-j1][i1-j1]%mod*C[m-j2][i2-j2]%mod);</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    <span class="built_in">Inc</span>(dp[i][i1][i2][<span class="number">0</span>],<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2][<span class="number">0</span>]*C[n-j1][i1-j1]%mod*C[m-j2][i2-j2]%mod);</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">Inc</span>(dp[i][i1][i2][<span class="number">1</span>],<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2][<span class="number">1</span>]*C[n-j1][i1-j1]%mod*C[m-j2][i2-j2]%mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è½¬ç§»ç›®æ ‡</p>
<p><code>dp[i][i1][i2][1]</code></p>
<p>å‰é¢ä¸€éƒ¨åˆ†</p>
<p><code>1ll*dp[i-1][j1][j2][0]*C[n-j1][i1-j1]</code></p>
<p>å’Œåé¢ä¸€éƒ¨åˆ†</p>
<p><code>C[m-j2][i2-j2]</code></p>
<p>åªæœ‰å‰ä¸€éƒ¨åˆ†ä¾èµ– $j1$ï¼Œè€ƒè™‘èƒ½ä¸èƒ½é¢„å¤„ç†å‰ä¸€éƒ¨åˆ†çš„è½¬ç§»ï¼Œç„¶åä¼˜åŒ–ä¸€ä¸ª $n$</p>
<p> æ˜¾ç„¶æ˜¯å¯ä»¥çš„ï¼Œæ‰‹æ¨ä¸€ä¸‹å¼å­å¯ä»¥å¾—åˆ°ä¸€ä¸ªæ–°çš„è½¬ç§»ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=n;j1++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i2=<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line">&#123;</span><br><span class="line">	sum[j1][i2]=<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][<span class="number">0</span>][<span class="number">1</span>]*C[m][i2]%mod;</span><br><span class="line">	sum2[j1][i2][<span class="number">0</span>]=<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][<span class="number">0</span>][<span class="number">0</span>]*C[m][i2]%mod;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> j2=<span class="number">1</span>;j2&lt;=i2;j2++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(dp[i<span class="number">-1</span>][j1][j2][<span class="number">1</span>])</span><br><span class="line">        <span class="built_in">Inc</span>(sum[j1][i2],<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2][<span class="number">1</span>]*C[m-j2][i2-j2]%mod);</span><br><span class="line">		sum2[j1][i2][j2]=sum2[j1][i2][j2<span class="number">-1</span>];</span><br><span class="line">		<span class="keyword">if</span>(dp[i<span class="number">-1</span>][j1][j2][<span class="number">0</span>])</span><br><span class="line">        <span class="built_in">Inc</span>(sum2[j1][i2][j2],<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2][<span class="number">0</span>]*C[m-j2][i2-j2]%mod);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i1=<span class="number">0</span>;i1&lt;=n;i1++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i2=<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=i1;j1++)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> val=C[n-j1][i1-j1];</span><br><span class="line">	<span class="built_in">Inc</span>(dp[i][i1][i2][<span class="number">1</span>],<span class="number">1ll</span>*val*sum[j1][i2]%mod);</span><br><span class="line">	<span class="keyword">if</span>(i&lt;=t)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">int</span> pos=i2+j1-i1,val1=pos&lt;<span class="number">0</span>?<span class="number">0</span>:sum2[j1][i2][pos],val2;</span><br><span class="line">		val2=sum2[j1][i2][i2];<span class="built_in">Dec</span>(val2,val1);</span><br><span class="line">		<span class="keyword">if</span>(i&lt;t)<span class="built_in">Inc</span>(dp[i][i1][i2][<span class="number">0</span>],<span class="number">1ll</span>*val*val1%mod);</span><br><span class="line">		<span class="built_in">Inc</span>(dp[i][i1][i2][<span class="number">1</span>],<span class="number">1ll</span>*val*val2%mod);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¼˜åŒ–åˆ°äº† $O(n^3*t)$ï¼Œè®°æ­¤æ—¶çš„å¸¸æ•° $k &#x3D; 1$ï¼Œå®ƒéœ€è¦çº¦ $15s$ é€šè¿‡æ•°æ®è§„æ¨¡æœ€å¤§çš„æµ‹è¯•ç‚¹ã€‚</p>
<p>è¿™ä»½ä»£ç å¯ä»¥æ‹¿åˆ° $50pts$ çš„å¥½æˆç»©ï¼Œæ„Ÿè§‰ä¸Šå·²ç»ä¸å¤ªèƒ½ä¼˜åŒ–å¤æ‚åº¦äº†ï¼Œæˆ‘ä»¬è€ƒè™‘å¡å¸¸ã€‚</p>
<p>ç¬¬ä¸€æ­¥ï¼Œå‘ç° $n&#x3D;6$ çš„æ—¶å€™åªéœ€è¦è½¬ç§» $dp[6][n][m][1]$</p>
<p>ç¬¬äºŒæ­¥ï¼Œå‘ç° $n&#x3D;1$ çš„æ—¶å€™è¢«è½¬ç§»çš„åªæœ‰ $dp[0][0][0][0]$</p>
<p>å¸¸æ•°å˜ä¸º $k &#x3D; \dfrac{2}{3}$</p>
<p>æ­¤æ—¶å¯ä»¥æ‹¿åˆ° $70pts$ çš„å¥½æˆç»©ã€‚</p>
<p>ç»§ç»­è€ƒè™‘å¡å¸¸ã€‚</p>
<p>å‘ç°å…¶å®åœ¨ $i&gt;&#x3D;t$ æ—¶è½¬ç§» $dp[i][i1][i2][0]$ æ²¡æœ‰æ„ä¹‰ï¼Œç›´æ¥å‰ªæ‰ã€‚å¸¸æ•°æ²¡æœ‰å˜åŒ–ã€‚</p>
<p>å‘ç° $dp[i][i1][i2][1]$ å®é™…ä¸Šå¯ä»¥ç”± $dp[i][i1][i2][0]$ ç›´æ¥å¾—åˆ°ï¼Œæ‰€ä»¥åªè½¬ç§» $dp[i][i1][i2][0]$ ï¼Œè®°ä½œ $dp[i][i1][i2]$ï¼Œå¸¸æ•°å˜ä¸º $k &#x3D; \dfrac{1}{3}$</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(i&lt;=t)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=n;j1++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i2=i==<span class="number">6</span>?m:<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line">        &#123;</span><br><span class="line">            sum[j1][i2][<span class="number">0</span>]=<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][<span class="number">0</span>]*C[m][i2]%mod;</span><br><span class="line">            <span class="type">int</span> *p=&amp;sum[j1][i2][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j2=<span class="number">1</span>;j2&lt;=i2;j2++)</span><br><span class="line">            &#123;</span><br><span class="line">                *p=sum[j1][i2][j2<span class="number">-1</span>];</span><br><span class="line">                <span class="built_in">Inc</span>(*p++,<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2]*C[m-j2][i2-j2]%mod);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i1=i==<span class="number">6</span>?n:<span class="number">0</span>;i1&lt;=n;i1++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=i1;j1++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i2=i==<span class="number">6</span>?m:<span class="built_in">max</span>(<span class="number">0</span>,i1-j1);i2&lt;=m;i2++)</span><br><span class="line">                <span class="built_in">Inc</span>(dp[i][i1][i2],<span class="number">1ll</span>*C[n-j1][i1-j1]*sum[j1][i2][i2+j1-i1]%mod);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i2=i==<span class="number">6</span>?m:<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=n;j1++)</span><br><span class="line">            sum[j1][i2][<span class="number">0</span>]=<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][<span class="number">0</span>]*C[m][i2]%mod;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j2=<span class="number">1</span>;j2&lt;=i2;j2++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=n;j1++)</span><br><span class="line">                <span class="built_in">Inc</span>(sum[j1][i2][<span class="number">0</span>],<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2]*C[m-j2][i2-j2]%mod);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i1=i==<span class="number">6</span>?n:<span class="number">0</span>;i1&lt;=n;i1++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i2=i==<span class="number">6</span>?m:<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=i1;j1++)</span><br><span class="line">                <span class="built_in">Inc</span>(dp[i][i1][i2],<span class="number">1ll</span>*sum[j1][i2][<span class="number">0</span>]*C[n-j1][i1-j1]%mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p>æ­¤æ—¶çš„æˆç»©è¿˜æ˜¯ $70pts$ï¼Œä½†æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿä¸€ä¸‹ä»£ç ï¼Œåœ¨ $i&gt;t$ åçš„è½¬ç§»å®é™…ä¸Šæ²¡æœ‰ä»»ä½•æ„ä¹‰ï¼Œå¯ä»¥ç›´æ¥è®¡ç®—ï¼Œä¼˜åŒ–è¿™ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æ‹¿åˆ° $90pts$ çš„å¥½æˆç»©ã€‚</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=<span class="number">2</span>;i&lt;=<span class="built_in">min</span>(t,<span class="number">5</span>);i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=n;j1++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i2=<span class="number">0</span>;i2&lt;=m;i2++)</span><br><span class="line">        &#123;</span><br><span class="line">            sum[j1][i2][<span class="number">0</span>]=<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][<span class="number">0</span>]%mod*C[m][i2]%mod;</span><br><span class="line">            <span class="type">int</span> *p=&amp;sum[j1][i2][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j2=<span class="number">1</span>;j2&lt;=i2;j2++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[i<span class="number">-1</span>][j1][j2]&gt;=mod)dp[i<span class="number">-1</span>][j1][j2]%=mod;</span><br><span class="line">                *p=sum[j1][i2][j2<span class="number">-1</span>];</span><br><span class="line">                <span class="built_in">Inc</span>(*p++,<span class="number">1ll</span>*dp[i<span class="number">-1</span>][j1][j2]*C[m-j2][i2-j2]%mod);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i1=<span class="number">0</span>;i1&lt;=n;i1++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j1=<span class="number">0</span>;j1&lt;=i1;j1++)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> i2=<span class="built_in">max</span>(<span class="number">0</span>,i1-j1);i2&lt;=m;i2++)</span><br><span class="line">            &#123;</span><br><span class="line">                dp[i][i1][i2]+=<span class="number">1ll</span>*C[n-j1][i1-j1]*sum[j1][i2][i2+j1-i1];</span><br><span class="line">                <span class="keyword">if</span>(dp[i][i1][i2]&gt;=<span class="number">8e18</span>)dp[i][i1][i2]%=mod;</span><br><span class="line">            &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(t==<span class="number">6</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">            <span class="built_in">Inc</span>(dp[<span class="number">6</span>][n][m],(n-i&lt;=m-j)*dp[<span class="number">5</span>][i][j]%mod);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,((<span class="built_in">quick</span>(<span class="number">6</span>,n+m)-dp[<span class="number">6</span>][n][m]%mod)+mod)%mod);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> all=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=n;i++)</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;=m;j++)</span><br><span class="line">            <span class="built_in">Inc</span>(all,<span class="number">1ll</span>*dp[t][i][j]%mod*<span class="built_in">quick</span>(<span class="number">6</span>-t,n+m-i-j)%mod);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,((<span class="built_in">quick</span>(<span class="number">6</span>,n+m)-all)+mod)%mod);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€åçš„ $10pts$ å¯èƒ½éœ€è¦ä¸€äº›å¡å¸¸æŠ€å·§ã€‚</p>
<p>æˆ‘ä»¬å‘ç°å®é™…ä¸Šå¤æ‚åº¦çš„ç“¶é¢ˆåœ¨æ•°ç»„å¯»å€å’Œå–æ¨¡ï¼Œè€ƒè™‘ä¼˜åŒ–å…¶ä¸­ä¹‹ä¸€ï¼Œè¢«å¯»å€çš„æ•°ç»„ç»è¿‡å¾ªç¯å˜é‡çš„è°ƒæ•´å·²ç»ç›¸å½“è¿ç»­äº†ï¼Œæˆ‘ä»¬è€ƒè™‘ä¼˜åŒ–å–æ¨¡ã€‚</p>
<p>ç”¨ <code>long long</code> å­˜ $dp$ï¼Œæ¯ $8$ æ¬¡åŠ æ³•å–ä¸€æ¬¡æ¨¡ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚</p>
<p>ä¸€ä¸ªå¾ˆå¸¸è§çš„ï¼Œåœ¨å–æ¨¡è¿ç®—è¾ƒå¤šæ—¶çš„ä¼˜åŒ–æŠ€å·§ã€‚</p>
<h3 id="20220211-æµ‹è¯•T3"><a href="#20220211-æµ‹è¯•T3" class="headerlink" title="20220211 æµ‹è¯•T3"></a>20220211 æµ‹è¯•T3</h3><h4 id="é¢˜æ„-2"><a href="#é¢˜æ„-2" class="headerlink" title="é¢˜æ„"></a><a href="https://cwoi.com.cn/contest/C18/problem/C">é¢˜æ„</a></h4><h4 id="æ€è€ƒï¼š-2"><a href="#æ€è€ƒï¼š-2" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è¿™é“é¢˜æš´åŠ›æ€è·¯æ— éå°±äºŒè¿›åˆ¶æšä¸¾å’Œå®¹æ–¥ã€‚æ­£è§£çš„åšæ³•å¾ˆç¥ä»™ã€‚</p>
<p>åœ¨è¿™ç§ $\text{NP}$ é—®é¢˜ä¸­ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥è€ƒè™‘å°†æšä¸¾çš„éƒ¨åˆ†å‡å°‘ï¼Œè¿™é“é¢˜çš„æ€è·¯æ˜¯å¯¹ç¨€ç–å›¾åˆ ç‚¹å˜ä¸ºæ£®æ—ï¼Œç„¶åäºŒè¿›åˆ¶æšä¸¾ä¸€äº›åˆ æ‰çš„ç‚¹çš„çŠ¶å†µå†è¿›è¡Œæ ‘å½¢ $dp$ï¼Œç€å®æ˜¯ä¸€ä¸ªå¾ˆæœ‰å¯å‘æ€§çš„æ€è·¯ã€‚</p>
<h2 id="20220212-1"><a href="#20220212-1" class="headerlink" title="20220212"></a>20220212</h2><h3 id="CF1637F"><a href="#CF1637F" class="headerlink" title="CF1637F"></a>CF1637F</h3><h4 id="æ€è€ƒ-3"><a href="#æ€è€ƒ-3" class="headerlink" title="æ€è€ƒ:"></a>æ€è€ƒ:</h4><p>å¯¹äºè¿™ç§æ¡ä»¶ä¸ºæœ€å°å€¼çš„è¦†ç›–é—®é¢˜ï¼Œæˆ‘ä»¬ä¸å¦¨è€ƒè™‘æœ€å¤§çš„é‚£ä¸ªç‚¹æ˜¯å¦‚ä½•è¢«è¦†ç›–çš„ï¼Œé¦–å…ˆæœ‰ä¸€ä¸ªç»“è®ºæ˜¯åªä¼šåœ¨å¶å­æœ‰åŸºç«™ï¼Œè¯æ˜ç®€å•ï¼Œç•¥å»ã€‚ç„¶åè€ƒè™‘æœ€å¤§çš„é‚£ä¸ªç‚¹æ˜¯å¦‚ä½•è¢«è¦†ç›–çš„ï¼ŒæŠŠå®ƒçœ‹ä½œæ ¹ï¼Œä¸€å®šæ¥æºäºå®ƒä¸åŒå„¿å­çš„ä¸¤ä¸ªå¶å­ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘å…¶å®ƒç‚¹çš„æ—¶å€™ä¸€å®šå¯ä»¥è®¤ä¸ºè¿™ä¸ªæ ¹ä¸Šçš„å€¼ä¸º $\text{INF}$ ï¼Œç†ç”±ä¸å¤šè¯´äº†ã€‚æ‰€ä»¥æ¯ä¸ªç‚¹ $u$ çš„åŒ…å«çš„å¶å­è‡³å°‘æœ‰ä¸€ä¸ªæœ€å¤§å€¼ä¸º $h_u$ï¼Œè´ªå¿ƒå³å¯ï¼Œæœ€åå†³ç­–æœ€å¤§å€¼çš„ç‚¹åº”è¯¥æ”¾åœ¨å“ªé‡Œï¼ŒåŒæ ·çš„è´ªå¿ƒã€‚</p>
<p>å®ç°è¾ƒä¸ºç®€å•ï¼Œæ²¡ä»€ä¹ˆè¯´çš„ã€‚</p>
<h2 id="20220225"><a href="#20220225" class="headerlink" title="20220225"></a>20220225</h2><h3 id="haltoj116"><a href="#haltoj116" class="headerlink" title="haltoj116"></a>haltoj116</h3><h4 id="æ€è€ƒï¼š-3"><a href="#æ€è€ƒï¼š-3" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è€ƒè™‘å›¢å’Œç‹¬ç«‹é›†çš„æ€§è´¨ï¼Œæˆ‘åœ¨è€ƒåœºä¸Šå°±æƒ³åˆ°äº†ç­”æ¡ˆä¸€å®šä¸å¤šï¼Œæå¤§æ¦‚ç‡æ— éœ€å–æ¨¡è¿™ä¸€ç‰¹æ€§ï¼Œäºæ˜¯ç”¨ç±»ä¼¼åˆ†æ²»çš„æ–¹å¼å¾—åˆ°äº† $60pts$ï¼Œå¦‚æœæˆ‘ä»¬æ‰¾å‡ºäº†ä¸€ä¸ªåˆæ³•è§£ï¼Œé‚£ä¹ˆå…¶å®ƒåˆæ³•è§£çš„æ„é€ ä¹Ÿæ˜¯ç®€å•çš„ï¼Œè€ƒè™‘åˆæ³•è§£çš„æ€§è´¨ï¼Œä¸å¦¨è®¾å›¢çš„å¤§å°ä¸º $s$ ï¼Œé‚£ä¹ˆå› ä¸ºç‹¬ç«‹é›†åªèƒ½å‘å›¢è¿è¾¹ï¼Œæ‰€ä»¥ç‹¬ç«‹é›†ä¸­çš„ç‚¹æœ€å¤§åº¦æ•°ä¸º $s$ï¼Œè€Œè¿™æ ·åˆå¯¼è‡´äº†å›¢ä¸­çš„ç‚¹æœ€å°åº¦æ•°å¢åŠ ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éš¾å‘ç°å›¢ä¸­çš„ç‚¹ä¸€å®šæ˜¯åº¦æ•°æœ€å¤§çš„é‚£ä¸€æ®µå‰ç¼€ã€‚</p>
<p>å¯¹äºåº¦æ•°ç›¸åŒçš„ç‚¹ï¼Œçœ‹ä¼¼æ— æ³•ä¸‹æ‰‹ï¼Œä½†æ˜¯æˆ‘ä»¬çŸ¥é“è¾¹çš„æ„æˆæ˜¯å›¢å†…åŠ ä¸Šå›¢å’Œç‹¬ç«‹é›†ä¹‹é—´ï¼Œå›¢å†…çš„è¾¹æ•°æˆ‘ä»¬æ˜¯çŸ¥é“çš„ï¼Œè€Œå¦‚æœè®°å½•ä¸€ä¸‹å›¢ä¸­ç‚¹çš„æ€»åº¦æ•°ï¼Œæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„æ¨å‡ºç‹¬ç«‹é›†é—´æ˜¯å¦æœ‰è¾¹ï¼Œæˆ‘ä»¬è®¾å›¢å†…ç‚¹çš„æ€»åº¦æ•°ä¸º $p$,å›¢çš„å¤§å°ä¸º $i$ï¼Œå›¢å†…è¾¹æ•°ä¸º ï¼Œé‚£ä¹ˆå…¶ä»–ç‚¹ä¹‹é—´çš„è¾¹æ•°å°±ä¸º $(2<em>m-2</em>p+i*(i-1))&#x2F;2$ï¼Œæ‰€ä»¥æˆ‘ä»¬è€ƒè™‘æ»¡è¶³ $2m + i * (i-1) &#x3D; 2p$ è¿™ä¸ªæ¡ä»¶çš„é€‰æ‹©æœ‰ä»€ä¹ˆæ€§è´¨ï¼Œå› ä¸ºè¿™æ˜¯æˆç«‹çš„å¿…è¦æ¡ä»¶ï¼Œè€ƒè™‘è¯æ˜è¿™ä¹Ÿæ˜¯å……åˆ†æ¡ä»¶ã€‚å¦‚æœå›¢å†…è¾¹æ•°ä¸è¶³ $i*(i-1)$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å‘ç° $p$ è¿™è¾¹ä¼šå‡å°ã€‚è€ƒè™‘å¦‚æœç‹¬ç«‹é›†å†…è¾¹æ•°æœ‰è¾¹ï¼Œé‚£ä¹ˆ $p$ è¿™è¾¹ä¸€æ ·ç›¸å¯¹å‡å°‘ï¼Œæ‰€ä»¥è¿™ä¹Ÿæ˜¯å……åˆ†æ¡ä»¶ã€‚</p>
<p>è¿™é“é¢˜ç»“æŸäº†ã€‚</p>
<h3 id="haltoj117"><a href="#haltoj117" class="headerlink" title="haltoj117:"></a>haltoj117:</h3><h4 id="æ€è€ƒï¼š-4"><a href="#æ€è€ƒï¼š-4" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è€ƒè™‘åœ¨åŸåºåˆ—ä¸­æ˜¯å‰ç¼€ $max$ çš„ç‚¹ï¼Œå®ƒä»¬åœ¨æ–°åˆ’åˆ†çš„åºåˆ—ä¸­ä¸€å®šä¹Ÿæ˜¯å‰ç¼€ $max$ï¼Œå¦‚æœæ–°å¢äº†å‰ç¼€ $max$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾ˆè½»æ¾çš„æ”¹å˜åˆ’åˆ†æƒ…å†µå»é™¤è¿™ä¸ªå‰ç¼€ $max$ï¼Œæ‰€ä»¥å¦‚æœåŸåºåˆ—ä¸­å‰ç¼€ $max$ çš„æ•°é‡ä¸ºå¶æ•°ï¼Œå°±ä¸€å®šå¯ä»¥ã€‚å¦‚æœä¸ºå¥‡æ•°ï¼Œæˆ‘ä»¬ä¸å¦¨è€ƒè™‘åªæœ‰ä¸€ä¸ªåºåˆ—æœ‰æ–°å¢çš„å‰ç¼€ $max$ çš„æƒ…å†µã€‚æˆ‘ä»¬è€ƒè™‘ä»åŸåºåˆ—ä¸­æŠ½å‡ºä¸€ä¸ªæ–°åºåˆ—å‡ºæ¥ï¼Œè®¾ä¸¤ä¸ªåºåˆ—çš„æƒå€¼ä¹‹å·®ä¸º $k$ï¼Œå¦‚æœæŠ½äº†ä¸€ä¸ªåŸå…ˆçš„å‰ç¼€ $max$ï¼Œé‚£ä¹ˆ $k$ å‡å°‘ $2$ï¼Œå¦‚æœæ–°å¢äº†ä¸€ä¸ªå‰ç¼€ $max$ï¼Œ$k$ å‡å°‘é‡ä¸º $1$ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†åŸå…ˆæ˜¯å‰ç¼€ $max$ çš„æ•°çš„æƒå€¼è§†ä¸º $2$ï¼Œå…¶ä½™çš„è§†ä¸º $1$ï¼Œé—®é¢˜å°±æ˜¯æ˜¯è¦é€‰ä¸€ä¸ªä¸Šå‡å­åºåˆ—ï¼Œä½¿å¾—æƒå€¼å’Œä¸ºå‰ç¼€ $max$ çš„ä¸ªæ•°ï¼Œè¿™ä¸ªé—®é¢˜å°±ç›¸å½“ç®€å•äº†ã€‚</p>
<h2 id="20220228"><a href="#20220228" class="headerlink" title="20220228"></a>20220228</h2><h3 id="ABC215H-å­é›†å®¹æ–¥çš„å¦ä¸€ç§æ€è·¯"><a href="#ABC215H-å­é›†å®¹æ–¥çš„å¦ä¸€ç§æ€è·¯" class="headerlink" title="ABC215H(å­é›†å®¹æ–¥çš„å¦ä¸€ç§æ€è·¯)"></a>ABC215H(å­é›†å®¹æ–¥çš„å¦ä¸€ç§æ€è·¯)</h3><p>è€ƒè™‘éœå°”å®šå¾‹ï¼Œæšä¸¾ä¸æ»¡è¶³æ¡ä»¶çš„å­é›† $mask$ï¼Œå¯ä»¥ç”¨ $\text{FMT-DP}$ è®¡ç®—å‡ºå¿…é¡»ç”± $mask$ ä¾›ç»™çš„ç™½èœæ•°é‡ï¼Œè€ƒè™‘å‡å°‘ä¸€ä¸ªå­é›†ä¸­çš„ç™½èœä½¿å¾—ä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±å¯ä»¥è®¡ç®—å‡ºæœ€å°‘éœ€è¦åƒå¤šå°‘ä¸ªã€‚é—®é¢˜å˜æˆäº†ç»Ÿè®¡ç­”æ¡ˆï¼Œæˆ‘ä»¬å‘ç°å¯¹äºä¸€ä¸ª $mask$ ç›´æ¥ç»„åˆæ•°è®¡ç®—ç„¶åç›¸åŠ ä¼šç®—é‡ï¼Œåˆå› ä¸ºç­”æ¡ˆä¸æ˜¯å…¨é›†æ‰€ä»¥å¹¶ä¸èƒ½ç®€å•å®¹æ–¥ã€‚è€Œæš´åŠ›è®¡ç®—å¼ºåˆ¶æ¯ç§ç™½èœéƒ½é€‰ä¸€ä¸ªçš„å¤æ‚åº¦æ˜¯ $O(3^n)$ çš„ï¼Œæˆ‘ä»¬ä»ç„¶è€ƒè™‘åº”ç”¨ $\text{FMT-DP}$ è®¡ç®—ç­”æ¡ˆã€‚äº‹å®ä¸Šï¼Œè¿™ç§ç»„åˆæ•°é—®é¢˜éƒ½å¯ä»¥è€ƒè™‘è¿™ç§æ–¹å¼ã€‚</p>
<p>è®¾ $f_{mask}$ è¡¨ç¤ºæ‰€é€‰ç™½èœé›†åˆè¢« $mask$ åŒ…å«çš„æ–¹æ¡ˆæ•°ï¼Œè®¾ $fâ€™<em>{mask}$ è¡¨ç¤ºæ‰€é€‰ç™½èœç§ç±»é›†åˆæ°å¥½ä¸º $mask$   çš„æ–¹æ¡ˆæ•°ï¼Œåˆ—æœ‰ç­‰å¼ã€‚<br>$$<br>fâ€™</em>{mask} &#x3D; f_{mask} - \sum\limits_{x \sub mask} fâ€™_{mask}<br>$$<br>ä»¤ $f[i][mask]$ è¡¨ç¤ºå½“å‰å­é›†ä¸º $mask$ ï¼Œä½ $i$ ä½ä¸ä¸€å®šå­˜åœ¨ï¼Œä½†é«˜ä½éƒ½ä¸¥æ ¼ç¬¦åˆè¦æ±‚çš„æ–¹æ¡ˆæ€»æ•°ï¼Œåˆ—æœ‰ </p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mask=<span class="number">0</span>;mask&lt;<span class="number">1</span>&lt;&lt;n;mask++)&#123;</span><br><span class="line">        f[i][mask]=f[i+<span class="number">1</span>][mask];</span><br><span class="line">        <span class="keyword">if</span>(<span class="number">1</span>&lt;&lt;i&amp;mask)f[i][mask]-=f[i+<span class="number">1</span>][mask^(<span class="number">1</span>&lt;&lt;i)],f[i][mask]%=mod;	</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<p>ä» $i+1$ æ¨åˆ° $i$ çš„è¿‡ç¨‹ä¸­ï¼Œå› ä¸ºé«˜ä½å·²ç»å¼ºåˆ¶å­˜åœ¨äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡å»çš„å°±æ˜¯ $f[i][mask]$ ä¸­æ‰€æœ‰ä¸å­˜åœ¨ç¬¬ $i$ ä½ï¼Œä½†é«˜ä½ç¬¦åˆè¦æ±‚çš„æƒ…å†µã€‚</p>
<p>æœ€åè®¡ç®—å‡ºæ¥çš„ $f[0]$ å°±æ˜¯ä¸Šè¿°çš„ $f$ã€‚</p>
<p>ç„¶åè¿™é“é¢˜å°±å¥½åšäº†ã€‚</p>
<h2 id="20220301"><a href="#20220301" class="headerlink" title="20220301"></a>20220301</h2><h3 id="è€ƒè¯•-T1-SAMçš„è¿›ä¸€æ­¥ç†è§£"><a href="#è€ƒè¯•-T1-SAMçš„è¿›ä¸€æ­¥ç†è§£" class="headerlink" title="è€ƒè¯• T1(SAMçš„è¿›ä¸€æ­¥ç†è§£)"></a>è€ƒè¯• T1(SAMçš„è¿›ä¸€æ­¥ç†è§£)</h3><h4 id="é¢˜æ„ï¼š-3"><a href="#é¢˜æ„ï¼š-3" class="headerlink" title="é¢˜æ„ï¼š"></a>é¢˜æ„ï¼š</h4><p>ç»™å®šä¸€é¢—å­—ç¬¦åœ¨ç‚¹ä¸Šçš„ $\text{Trie}$ï¼Œæ±‚ $\text{Trie}$ ä»£è¡¨çš„æ‰€æœ‰å­—ç¬¦ä¸²æœ¬è´¨ä¸åŒå­ä¸²ä¸ªæ•°ï¼Œé¡ºä¾¿è¯¢é—®é’¦å®šå­—ç¬¦å¤§å°å…³ç³»åç¬¬ $k$ å°çš„å­ä¸²ï¼Œä¿è¯ $\text{Trie}$ ä¸Šå­—ç¬¦éšæœºä¸”ç­”æ¡ˆé•¿åº¦å’Œä¸è¶…è¿‡ $800KB$ã€‚</p>
<h4 id="æ€è€ƒï¼š-5"><a href="#æ€è€ƒï¼š-5" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è€ƒåœºä¸Šæƒ³åˆ°å¯ä»¥ç±»ä¼¼ $\text{SAM}$ ä¸€æ ·ä¹±æï¼Œç„¶åå°±å†™äº† $\text{dfs}$ æ„å»º $\text{SAM}$ï¼Œ$lst$ æŒ‡é’ˆè¢«ç½®ä¸ºå®ƒçˆ¶äº²æ’å…¥åçš„ $p$ï¼Œè¿™ä¸ªåšæ³•åœ¨æ•°æ®éšæœºçš„æƒ…å†µä¸‹æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å¦‚æœå‡ºç°æ„é€ æ•°æ®ï¼Œå®ƒä¼šæ²¡æ‰ã€‚</p>
<p>é¦–å…ˆæ˜¯å¦‚æœæ‹‰ä¸€æ¡ $a$  é“¾ï¼Œé“¾ä¸Šæ¯ä¸ªç‚¹å†æŒ‚ä¸€ä¸ª $b$ï¼Œç„¶å $dfs$ å›è·³çš„æ—¶å€™é‡ç½® $q$ çš„æ¥è¾¹åˆ° $np$ æ—¶æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n^2)$ çš„ã€‚</p>
<p>æˆ‘æ‰€ç†è§£çš„ $\text{SAM}$ æ—¶é—´å¤æ‚åº¦æ­£ç¡®æ€§åŸºäºä¸¤ä¸ªä¸œè¥¿ï¼Œä¸€ä¸ªæ˜¯ $p$ çš„æ·±åº¦å˜åŒ–æƒ…å†µï¼Œè¿™è¯æ˜äº†ç¬¬ä¸€æ¬¡æ„å»ºè¾¹çš„æ—¶å€™æ—¶é—´æ­£ç¡®ã€‚åœ¨ $dfs$ æ„å»º $SAM$ çš„æ—¶å€™ï¼Œå¤§é‡å›æº¯æ“ä½œä¼šå¯¼è‡´ $p$ æ·±åº¦çš„å¼‚å¸¸å˜åŒ–ï¼Œè¿™æ ·å°±ä¸å¯¹äº†ã€‚ç¬¬äºŒä¸ªæ˜¯é‡ç½® $q$ çš„æ¥è¾¹çš„å¾ªç¯ï¼Œè¿™ä¸ªå¯ä»¥åˆ†æ $p$ çš„ $fa$ æ‰€ä»£è¡¨æœ€çŸ­å­—ç¬¦ä¸²é•¿åº¦æ¥ç†è§£ï¼Œæ¯æ¬¡é‡ç½® $q$ çš„æ¥è¾¹ï¼Œæˆ‘ä»¬éƒ½è®¤ä¸ºæ˜¯æ‰¾åˆ°äº†ä¸€ä¸ªæ›´çŸ­çš„ $np$ æ‰€ä»£è¡¨çš„å­—ç¬¦ä¸²ï¼Œä¸å¦¨çœ‹æˆä¸€ä¸ªæŒ‡é’ˆåœ¨æ’å…¥çš„å­—ç¬¦ä¸²ä¸Šç§»åŠ¨ï¼Œå®ƒåªä¼šå‘å³ã€‚é‡ç½®å®Œ $p$ çš„æ¥è¾¹å†æ’å…¥ä¸‹ä¸ªç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬è‡³å°‘ä¼šè·³åˆ° $np$ å¤„ï¼ˆåªé’ˆå¯¹å•ä¸ªä¸²ï¼‰ï¼Œç„¶åé‡è®¾çš„ $pâ€™$ çš„ $fa$ çš„æœ€çŸ­é•¿åº¦ä¸€å®šå¯ä»¥ä» $np$ é‚£é‡Œç»§æ‰¿è¿‡æ¥ï¼Œæ‰€ä»¥æŒ‡é’ˆåªä¼šå³ç§»ã€‚$dfs$ åŠ å…¥æ—¶åŒæ ·å¯¼è‡´äº†è¿™ä¸ªæŒ‡é’ˆåœ¨ $\text{Trie}$ ä¸Šä¹±è·³ï¼Œå¤æ‚åº¦å°±æ²¡æœ‰äº†ä¿è¯ã€‚</p>
<p>ç„¶åæ˜¯æ­£ç¡®æ€§ç›¸å…³çš„é—®é¢˜ï¼Œè¿™ç§ $\text{SAM}$ å†™æ³•ä¼šå¯¼è‡´æ— æ•ˆçš„ç©ºèŠ‚ç‚¹å»ºç«‹ï¼Œæ¯”å¦‚è¯´æ’å…¥çš„æ—¶å€™å°±ç¢°åˆ°äº†æ»¡è¶³ $a[lst].ch[c]$ å­˜åœ¨çš„æƒ…å†µï¼Œè¿™æ ·æ–°å»ºå‡ºæ¥çš„ç‚¹å®é™…ä¸Šæ˜¯æ— æ•ˆçš„ï¼Œåœ¨ç»å¤§éƒ¨åˆ†é¢˜ç›®ä¸­è¿™ä¸ªæ— æ•ˆç‚¹æ˜¯ä¸å½±å“ç­”æ¡ˆçš„ï¼Œä½†æ˜¯å°‘éƒ¨åˆ†å†™æ³•ä¼šå¯¼è‡´çˆ†ç‚¸ã€‚</p>
<p>æ¥ä¸‹æ¥è®¨è®ºä¸‹ $\text{BFS}$ å»ºæ ‘çš„æ­£ç¡®æ€§ã€‚ç”±äºæ˜¯æŒ‰æ·±åº¦åŠ ç‚¹ï¼Œæ‰€ä»¥ $a[lst].ch[c]$ ä¸€å®šæ˜¯ä¸å­˜åœ¨çš„ï¼Œå› æ­¤ç»ä¸ä¼šå¯¼è‡´æ— æ•ˆèŠ‚ç‚¹çš„å»ºç«‹ï¼Œæ—¶é—´å¤æ‚åº¦è¯æ˜ä¸ä¼šï¼Œçœç•¥ã€‚</p>
<p>æ—¶é—´å¤æ‚åº¦æˆ‘å¹¶ä¸ä¼šè¯æ˜ emmmm.</p>
<h3 id="ABC241H"><a href="#ABC241H" class="headerlink" title="ABC241H"></a>ABC241H</h3><h4 id="æ€è€ƒï¼š-6"><a href="#æ€è€ƒï¼š-6" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>ç”Ÿæˆå‡½æ•°å¥—è·¯é¢˜ã€‚</p>
<h2 id="20220302"><a href="#20220302" class="headerlink" title="20220302"></a>20220302</h2><h3 id="ARC136E"><a href="#ARC136E" class="headerlink" title="ARC136E"></a>ARC136E</h3><h4 id="æ€è€ƒï¼š-7"><a href="#æ€è€ƒï¼š-7" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>æ˜¾ç„¶å¶æ•°é“¾æ˜¯å¾ˆå¥½èµ°çš„ï¼Œæ‰€ä»¥è€ƒè™‘ä»å¶æ•°è¾¹æ€ä¹ˆåˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ˜¾ç„¶å¶æ•°åªèƒ½é€‰ä¸€ä¸ªï¼Œæˆ‘ä»¬å…ˆè€ƒè™‘ä¸é€‰å¶æ•°çš„æƒ…å†µã€‚</p>
<p>å®šä¹‰ $f[x]$ ä¸º $x$ çš„æœ€å°è´¨å› æ•°ï¼Œ$x$ èƒ½èµ°åˆ° $y$ çš„å……è¦æ¡ä»¶æ˜¯ $y&gt;x,x+f[x]\leq y-f[y]$ï¼Œå¦‚æœ $(x,y) &#x3D; 1$ï¼Œé‚£ä¹ˆæ˜¾ç„¶ï¼Œå› ä¸º $x$ ç¬¬ä¸€æ­¥è‡³å°‘èµ° $f[x]$ï¼Œåˆ° $y$ çš„æœ€åä¸€æ­¥è‡³å°‘èµ° $f[y]$ã€‚å¦‚æœ $(x,y) \neq 1$ï¼Œè®¾ $x &#x3D; p \times f[x]$ï¼Œåˆ™ $y$ è‡³å°‘ä¸º $(p+2)\times f[x]$ï¼Œæ•…ç»“è®ºä»ç„¶æˆç«‹ã€‚</p>
<p>ç”±æ­¤å¯ä»¥ $x$ èµ°ä¸åˆ° $y(y&gt;x)$ çš„å……è¦æ¡ä»¶ä¸º $x+f[x]&gt;y-f[y]$ï¼Œå°†æ¯ä¸ªç‚¹è§†ä¸º $(x-f[x],x+f[x]])$ ï¼Œé¢˜ç›®å°±æ˜¯è¦æ±‚å‡ºä¸€äº›åŒºé—´çš„é›†åˆï¼Œä½¿å¾—æ‰€æœ‰åŒºé—´æœ‰å…¬å…±ç‚¹ï¼Œè¦æ±‚æƒå€¼æœ€å¤§ï¼Œä¸å¦¨æšä¸¾å…¬å…±ç‚¹ï¼Œç„¶åå·®åˆ†è®¡ç®—å³å¯ã€‚</p>
<p>è€ƒè™‘ä¸‹å¶æ•°ï¼Œå®é™…ä¸Šåšæ³•ç±»ä¼¼ã€‚</p>
<h2 id="20220303"><a href="#20220303" class="headerlink" title="20220303"></a>20220303</h2><h3 id="AGC027E-amp-amp-haltoj119"><a href="#AGC027E-amp-amp-haltoj119" class="headerlink" title="AGC027E&amp;&amp;haltoj119"></a>AGC027E&amp;&amp;haltoj119</h3><h4 id="æ€è€ƒï¼š-8"><a href="#æ€è€ƒï¼š-8" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è§‚å¯Ÿä¸å˜é‡æ˜¯è¿™ç§å˜æ¢é¢˜çš„æ€è€ƒæ–¹å‘ä¹‹ä¸€ï¼Œæˆ‘ä»¬è®¾ $a$ çš„æƒå€¼ä¸º $1$ ï¼Œ$b$ çš„æƒå€¼ä¸º $2$ï¼Œæ€»èƒ½å‘ç°æƒå€¼å’Œå¯¹ $3$ å–æ¨¡çš„ç»“æœä¸å˜ã€‚</p>
<p>å…ˆè€ƒè™‘ä¸€ä¸ªå­—ç¬¦ä¸²åœ¨ä»€ä¹ˆæƒ…å†µä¸‹å¯ä»¥å˜æˆå¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæƒå€¼ç›¸åŒæ˜¾ç„¶æ˜¯å¿…è¦æ¡ä»¶ï¼Œå…¶æ¬¡ï¼Œæºä¸² $s$ ä¸èƒ½æ˜¯äº¤æ›¿ä¸² $abababa$ è¿™ç±»ï¼Œè¿™æœ‰ç‚¹å›°éš¾ï¼Œä¸å¦¨å…ˆè€ƒè™‘å˜æˆä¸€ä¸ªå­—æ¯çš„æƒ…å†µã€‚</p>
<p>å……è¦æ¡ä»¶ä¸ºæƒå€¼ç›¸åŒä¸”ä¸äº¤æ›¿ï¼Œè¯æ˜è€ƒè™‘å½’çº³æ³•ã€‚</p>
<p>ç°åœ¨è€ƒè™‘ç›®æ ‡ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²çš„æƒ…å†µã€‚æˆ‘ä»¬å…ˆè´ªå¿ƒçš„åŒ¹é…ï¼Œç”¨æœ€å°‘çš„å­—æ¯æ„é€ å‡ºç›®æ ‡ä¸²ï¼Œç„¶åè€ƒè™‘è°ƒæ•´å‰©ä¸‹çš„éƒ¨åˆ†ä½¿å¾—å®ƒæ»¡è¶³æ¡ä»¶ã€‚å¦‚æœç‰¹åˆ¤æ‰äº¤æ›¿ä¸²ï¼Œæˆ‘ä»¬å‘ç°åªè¦æƒå€¼ç›¸åŒä¸”æºä¸²çš„ä¸€ä¸ªå‰ç¼€èƒ½å’Œç›®æ ‡ä¸²è´ªå¿ƒåŒ¹é…ä¸Šï¼Œé‚£ä¹ˆä¸€å®šå¯ä»¥å˜æˆç›®æ ‡ä¸²ï¼Œäºæ˜¯è€ƒè™‘ $dp[i]$ è¡¨ç¤ºè€ƒè™‘åˆ°å‰ $i$ çš„æºä¸²å­—æ¯ï¼Œèƒ½è´ªå¿ƒçš„å¯¹åº”ä¸Šå¤šå°‘ä¸åŒä¸²ï¼Œæ˜¾ç„¶è¿™æ ·çš„è´ªå¿ƒå¯¹åº”æ˜¯ä¸é‡ä¸æ¼çš„ï¼Œè½¬ç§»åˆ†ä¸ºåŒ¹é… $i+1$  å’Œä¸åŒ¹é… $i+1$ ä¸¤ç§ï¼Œé¢„å¤„ç†ä¸€ä¸ªç±»ä¼¼ $nxt$ çš„ä¸œè¥¿å¯ä»¥åšåˆ°çº¿æ€§ã€‚</p>
<h2 id="20220304"><a href="#20220304" class="headerlink" title="20220304"></a>20220304</h2><h3 id="CF917D-amp-amp-haltoj122-åˆæ¢äºŒé¡¹å¼åæ¼”"><a href="#CF917D-amp-amp-haltoj122-åˆæ¢äºŒé¡¹å¼åæ¼”" class="headerlink" title="CF917D&amp;&amp;haltoj122(åˆæ¢äºŒé¡¹å¼åæ¼”)"></a>CF917D&amp;&amp;haltoj122(åˆæ¢äºŒé¡¹å¼åæ¼”)</h3><h4 id="æ€è€ƒï¼š-9"><a href="#æ€è€ƒï¼š-9" class="headerlink" title="æ€è€ƒï¼š"></a>æ€è€ƒï¼š</h4><p>è€ƒåœºä¸Šå·²ç»è§‚å¯Ÿå‡ºåŸé¢˜éœ€è¦æ±‚ä¸€å¼ å®Œå…¨å›¾æœ‰å¤šå°‘æ£µæœ€å°ç”Ÿæˆæ ‘ä¸ç»™å®šæ ‘è‡³å°‘æœ‰ $n-k-1$ æ¡è¾¹ç›¸åŒã€‚$prufer$ åºåˆ—æœ‰ä¸€ä¸ªç»“è®ºï¼Œ$n$ ä¸ªç‚¹ $k$ ä¸ªè¿é€šå—çš„å›¾æ„æˆæœ‰æ ‡å·æ— æ ¹æ ‘çš„æ–¹æ¡ˆæ€»æ•°ä¸º<br>$$<br>n^{k-2}\times\prod_{i&#x3D;1}^{k} sz[i]<br>$$<br>æ˜¾ç„¶æˆ‘ä¸ä¼šè¯æ˜ã€‚åœºä¸Šçœ‹åˆ° $n$ ä»…ä¸º $50$ å°±æƒ³ä¹±æï¼Œè¯¯æ‰“è¯¯æ’å¼„äº†ä¸€ä¸ªå®¹æ–¥ $dp$ å‡ºæ¥ï¼Œå®é™…ä¸Šæ­£è§£å·®ä¸å¤šå°±æ˜¯è¿™ä¸ªã€‚æˆ‘ä»¬è€ƒè™‘é’¦å®šé€‰äº† $k$ æ¡è¾¹ä¸€å®šå­˜åœ¨çš„æ–¹æ¡ˆæ€»æ•° $f(k)$ï¼Œç”±äºŒé¡¹å¼åæ¼”çš„å¥—è·¯å¯ä»¥å¾—çŸ¥æ°å¥½ $k$ æ¡è¾¹å­˜åœ¨çš„æ–¹æ¡ˆæ•° $g(k)$ æ»¡è¶³<br>$$<br>g(k) &#x3D; \sum_{i&#x3D;k}^{n-1}(-1)^{i-k}\times C(i,k) \times f(i)<br>$$<br>å…¶ä¸­ $C(i,j)$ è¡¨ç¤ºç»„åˆæ•°ã€‚</p>
<p>æ˜¾ç„¶æˆ‘ä»ç„¶ä¸ä¼šè¯æ˜ï¼Œä½†æ˜¯å¯ä»¥æ„Ÿæ€§ç†è§£ä¸‹ï¼Œé¦–å…ˆ $f(k)$ æ»¡è¶³ä»¥ä¸‹å¼å­<br>$$<br>f(k) &#x3D; \sum_{i&#x3D;k}^{n-1}C(i,k) \times g(i)<br>$$<br>è¿™ä¸ªå¾ˆå¥½ç†è§£ï¼Œæšä¸¾å®é™…ä¸Šé€‰äº†å¤šå°‘æ¡è¾¹ï¼Œé’¦å®š $k$ æ¡è¾¹çš„æ–¹æ¡ˆæ•°å°±æ˜¯ä»å®é™…é€‰çš„è¾¹ä¸­é’¦å®šä¸€äº›å‡ºæ¥ã€‚æ³¨æ„è¿™ä¸ªé’¦å®šå’Œè‡³å°‘æœ‰åŒºåˆ«ï¼Œä¸æ˜¯ç®€å•çš„åç¼€å’Œï¼Œå› ä¸ºå®é™…é€‰ä¸€æ¡è¾¹çš„æ–¹æ¡ˆå¯ä»¥è¢«å¤šç§é’¦å®šçš„æƒ…å†µåŒ…å«ã€‚</p>
<p>æˆ‘ä¸ä¼šè¯æ˜äºŒé¡¹å¼åæ¼”çš„å¼å­ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»å®¹æ–¥çš„è§’åº¦æ¥è€ƒè™‘ $g(k)$ï¼Œç¬¬ä¸€é¡¹ä¸ºé’¦å®š $k$ æ¡è¾¹ï¼Œç„¶åå‡å»è¢«å¤šè€ƒè™‘äº†çš„å­˜åœ¨ $k+1$ æ¡è¾¹çš„æƒ…å†µï¼Œä¾æ­¤ç±»æ¨ã€‚ç»„åˆæ•°çš„å­˜åœ¨åˆ™æ˜¯å› ä¸º $f(i)$ ä¼šè¢«é¢å¤–è€ƒè™‘ $C(i,k)$ æ¬¡ã€‚</p>
<p>$f$ è‚¯å®šæ¯” $g$ å¥½ç®—ï¼Œæˆ‘ä»¬ç°åœ¨éœ€è¦è®¡ç®—çš„æ˜¯é€‰ $k$ æ¡è¾¹ï¼Œç„¶åå¾—åˆ°çš„è”é€šå—ç»„æˆä¸åŒæœ‰æ ‡å·æ— æ ¹ç”Ÿæˆæ ‘çš„æ–¹æ¡ˆæ•°ã€‚æ³¨æ„åˆ°ç”Ÿæˆæ ‘è®¡æ•°å…¬å¼ä¸­ $n^{k-2}$ ä¸æ€ä¹ˆé€‰è¾¹å®Œå…¨æ— å…³ï¼Œæ‰€ä»¥åªéœ€è¦è®°å½•ä¸€ä¸‹ $\prod sz_i$ï¼Œè¿™ä¸ªå°±å¯ä»¥ $dp[i][j][k]$ è¡¨ç¤ºè€ƒè™‘ä»¥ $i$ ä¸ºæ ¹çš„å­æ ‘ï¼Œé€‰äº† $j$ æ¡è¾¹ï¼Œ$i$ æ‰€åœ¨è¿é€šå—å¤§å°ä¸º $k$ çš„æ–¹æ¡ˆæ•°ã€‚ä¼˜åŒ–çš„è¯ï¼Œå¯ä»¥è€ƒè™‘ $\prod sz_i$ çš„ç»„åˆæ„ä¹‰ã€‚äºæ˜¯å°±æ˜¯éœ€è¦åœ¨æ¯ä¸ªè¿é€šå—å†…é€‰ä¸€ä¸ªä»£è¡¨å…ƒï¼Œäºæ˜¯çŠ¶æ€ç¬¬ä¸‰ç»´ç®€åŒ–ä¸ºæ˜¯å¦é€‰äº†ä»£è¡¨å…ƒï¼Œå¤æ‚åº¦ $O(n^2)$ã€‚</p>
]]></content>
      <categories>
        <category>é¢˜è§£</category>
        <category>è®­ç»ƒé¢˜ç›®</category>
      </categories>
      <tags>
        <tag>é¢˜è§£</tag>
      </tags>
  </entry>
</search>
